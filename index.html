<html><body><h1>How apps work</h1>

<p>Devvit apps are designed to interact with Reddit communities.</p>

<h2>App accounts</h2>

<p>When you upload an app, an app account is automatically created. An app account is a separate user account that your app uses to interact with a subreddit.</p>

<p>Once a mod or admin installs your app, the app account appears as a user in the mod list. When the app is executed, the action comes from the app’s user account. This is helpful for tracking posts and comments.</p>

<p>The app account has the same permissions that are granted to your app.</p>

<h2>App permissions</h2>

<p>App permissions help users understand how your app will interact with a subreddit and users.</p>

<p>If your app accesses user data or interacts with the UI, that information is listed in the <a href="https://developers.reddit.com">Apps</a> directory and in the CLI on installation. Permissions fall into one of three categories.</p>

<p>| <strong>Category</strong>                         | <strong>Description</strong>                                                                                              | <strong>Capabilities involved</strong>                                                                                                                                                             |
| ------------------------------------ | ------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <strong>UI</strong>                               | Permissions your app needs for the UI elements it uses.                                                      | Menu actions, custom posts, or asset use all require UI permissions.                                                                                                                  |
| <strong>User data handling</strong>               | Permissions your app needs for the way it manages user data.                                                 | The specific permissions your app requires will depend on the capabilities you’ve used: app settings, key value store, HTTP fetch, media, Redis, Reddit API, scheduler, and triggers. |
| <strong>Moderator permissions</strong> (required) | Permission your app needs to create a mod account with <em>everything</em> permissions on the installing subreddit. | This permission is required for every app.                                                                                                                                            |</p>

<p>Here’s an example of the permissions displayed on the app detail page in the Developer Portal.</p>

<p><img src="./assets/app_permissions.png" alt="app permissions" /></p>

<h2>App versions</h2>

<p>When you update your app, every subreddit that has installed your app has to be <strong>manually updated</strong> to the new version (don’t worry, this won’t last forever). To update your subreddit app installation:</p>

<ol>
<li>Go to <a href="https://developers.reddit.com/my/communities">My Communities</a> from the profile dropdown in the Developer Portal.</li>
<li>Click the community you want to view.</li>
<li>When a new version of an app is available for a given subreddit, you will see a blue <strong>Update</strong> button next to the app tile. Click the button and follow the prompts to upgrade each community.</li>
</ol>

<p><img src="./assets/app-update.png" alt="app update" /></p>

<h2>Understanding client-side apps</h2>

<p>Client-side apps run on the user’s device instead of a remote server. This increases the speed and responsiveness of the app and provides a better user experience. Devvit apps operate like most client-side apps (browser extensions, html5 games, etc). When a user visits an <a href="interactive_posts.md">interactive post</a> that has a running Devvit app, the bundled source code is transmitted to the user. The app runs in the user’s client for optimal app performance, which exposes app details to clients during runtime.</p>

<p>What is available to the client:</p>

<ul>
<li>App source code</li>
<li>Anything stored in state (e.g. useState)</li>
</ul>

<p>What is not available to the client:</p>

<ul>
<li>Any server side plugins (outside of state), like data from Redis, secrets, and settings</li>
<li>Fetch calls to external services from within an app</li>
</ul>

<p>:::note
We are working on mechanisms to split your code into server portions (hidden) and client portions (exposed).
:::</p>

<h2>Development stages</h2>

<p>Devvit apps go through three stages during development. This lets you build and iterate on your app until you're ready to share it with the rest of Reddit.</p>

<p>| Stage    | Description                                                                                                                                                                                                                                                                                                      |
| -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Private  | When you are building and testing your app, it’s only visible to you, and it can only be installed by you in small subreddits with fewer than 200 subscribers.                                                                                                                                                   |
| Unlisted | After you publish your app, it is still only visible to you in the Apps directory, but you can install it on larger subreddits.                                                                                                                                                                                  |
| Public   | Once you submit your <a href="https://docs.google.com/forms/d/e/1FAIpQLSdEyE5vrqOBlojue_mkrV25RiiHv_sxe-xqtcdzCMBTWmoROA/viewform">app review form</a> and it's been approved by the Developer Platform team, your app is visible to all users in the Apps directory and can be installed by mods and admins across Reddit. |</p>
<h2>Add your app to a subreddit</h2>

<p>To add an app to your subreddit, find it on developers.reddit.com. Click on the app info card to get to the app details page, and click "Install".</p>

<p><img src="./assets/install-app-button.png" alt="Post" /></p>

<p>This will give you a list of subreddits that will allow you to add the app. Generally, you can only add an app to subreddits that you moderate.</p>

<p>Select a subreddit to install the app.</p>

<p><img src="./assets/communities-install-list.png" alt="Post" /></p>
<h1>Adding images</h1>

<p>Add images to your interactive post.</p>

<p>You can add things like a logo for the community, a special artistic expression, or new characters to unlock in your game.</p>

<p>:::note
The <a href="https://www.redditinc.com/policies/content-policy">Reddit Content Policy</a> applies to images in your app. All project assets are subject to an app review and screened by automated Reddit systems at upload. Images that violate the content policy will be removed.
:::</p>

<h2>What’s supported?</h2>

<ul>
<li>File types: JPG/JPEG, PNG, or GIF</li>
<li>Image size: 20MB for JPG/PNG; 40MB for GIF</li>
<li>Folder size: 1GB per app version</li>
</ul>

<p>The image file name does not have any constraints, but needs to reside in the “assets” folder. The file type is determined by inspecting its contents.</p>

<h2>How it works</h2>

<p>Add an image to your app’s <code>assets</code> folder. The image is uploaded to Reddit and accessible in your app source code when you upload your app. New projects should have an <code>assets</code> folder in the root directory. If you’re updating an existing project, you’ll need to add the <code>assets</code> folder.</p>

<p>Once the images are uploaded to Reddit, you can show the image in one of two ways:</p>

<ol>
<li>Use the Blocks UI component to embed your image in a post (to learn more about how to style images, check out our <a href="https://www.reddit.com/r/Devvit/post-viewer/1545cls/custom_post_block_kit_gallery/">blocks gallery</a>).</li>
</ol>

<p>:::note
The imageWidth and imageHeight attributes are in device independent pixels (DIPs).
:::</p>

<p><code>tsx
&lt;image url="imageName.jpg" imageWidth={100} imageHeight={100} /&gt;
</code></p>

<ol start="2">
<li>Use the URL string to get the image’s public URL from the code.</li>
</ol>

<p><code>ts
context.assets.getURL('imageName.jpg');
</code></p>

<p>:::note
The image name is case-sensitive. Additionally, you can use nested folders to organize your assets. For example,
<code>assets/images/imageName.jpg</code> will be uploaded to Reddit as <code>images/imageName.jpg</code>.
:::</p>

<h2>Use an image in a post</h2>

<ol>
<li>Locate the <code>assets</code> folder at the root of your project directory (or create one if it’s not there).</li>
<li>Create your image and add it to the <code>assets</code> folder.</li>
<li>Update your code to import the new asset. Here’s an example:</li>
</ol>

<p>```tsx
Devvit.configure({
  redditAPI: true,
});</p>

<p>const render: Devvit.CustomPostComponent = () =&gt; {
  return (
    <vstack padding="medium" gap="medium" cornerRadius="medium">
      <text style="heading" size="xxlarge">
        Hello!
      </text>
      <image url="hello.png" imageWidth={128} imageHeight={128} />
    </vstack>
  );
};</p>

<p>Devvit.addCustomPostType({
  name: 'My custom post',
  description: 'Test custom post for showing a custom asset!',
  render,
});</p>

<p>Devvit.addMenuItem({
  location: 'subreddit',
  label: 'Make custom post with image asset',
  onPress: async (event, context) =&gt; {
    const subreddit = await context.reddit.getSubredditById(context.subredditId);</p>

<pre><code>await context.reddit.submitPost({
  subredditName: subreddit.name,
  title: 'Custom post!',
  preview: render(context),
});
</code></pre>

<p>},
});
```</p>

<ol start="4">
<li>Run <code>devvit upload</code>.</li>
<li>Install or update your app on your subreddit.</li>
<li>From the subreddit menu, click "Make custom post with image asset". This will create a new post with the image embedded in it.</li>
</ol>

<p><img src="./assets/docs-app-image-assets-1.png" alt="image_in_a_post" /></p>

<h2>Show an image URL in a toast</h2>

<ol>
<li>Locate the <code>assets</code> folder at the root of your project directory (or create one if it’s not there).</li>
<li>Create your image and add it to the <code>assets</code> folder.</li>
<li>Update your code to import the new asset. Here’s an example:</li>
</ol>

<p><code>ts
Devvit.addMenuItem({
  location: 'subreddit',
  label: 'Get image URL',
  onPress: async (event, context) =&gt; {
    const url = await context.assets.getURL('hello.png');
    context.ui.showToast(url); // should show 'https://i.redd.it/&lt;id&gt;.png'
    // and if you go to the URL it showed, it should be your art
    // Note, it doesn't display the image this way, just the URL as text!
  },
});
</code></p>

<p><img src="./assets/docs-app-image-assets-2.png" alt="image_in_a_post" /></p>
<h2>Remove your published app from the directory</h2>

<p>If your app is published, you can remove it from the Developer Portal. This will not remove the code from the directory, and it will not remove the app from subreddits that have installed previous versions. Once an app is published and installed, that version will continue to exist until a moderator explicitly removes it.</p>

<p><strong>Hide using the directory UI</strong><br />
Go to the <a href="https://developers.reddit.com/my/apps">Developer Portal</a> and find your app. From the "App Details" page, scroll to "Developer Settings" and toggle the "Available" option off. Note that you will not see this option for apps that have only been uploaded but not published</p>
<h1>Manage</h1>

<h2>Remove an app from your subreddit</h2>

<p><strong>Uninstall from the Developer Portal</strong></p>

<ul>
<li>Find your app on <a href="https://developers.reddit.com/">developers.reddit.com</a>.</li>
<li>Click on the app info card to get to the app details page (e.g. <code>developers.reddit.com/apps/your-app-name</code>)</li>
<li>Under the <strong>Communities</strong> section, you will see a list of all subreddits your app is installed on</li>
<li>If you have permissions to uninstall the app, you can click the trash can icon to the right of a community name to uninstall the app from that community.</li>
</ul>

<p><img src="assets/manage_uninstall.png" alt="Uninstall" /></p>

<p><strong>Uninstall using the CLI</strong><br />
To find a list of installations, run <code>$ devvit list installs</code>.</p>

<p>```
$ devvit list installs
loading...... done</p>

<p>App Name          Installed Subreddits
 ───────────────── ────────────────────
 test-app-one    r/testsub1 (v0.0.1)</p>

<p>test-app-two    r/testsub2 (v0.0.3)</p>

<p>$ devvit uninstall test-app-one --subreddit r/testsub1
```</p>

<p>To uninstall an app, run <code>$ devvit uninstall [app-name] --subreddit [subreddit-name]</code>.</p>

<h2>Remove your published app from the directory</h2>

<p>If your app is published, you can remove it from the Developer Portal. This will not remove the code from the directory, and it will not remove the app from subreddits that have installed previous versions. Once an app is published and installed, that version will continue to exist until a moderator explicitly removes it.</p>

<p><strong>Hide using the directory UI</strong><br />
Go to <a href="https://developers.reddit.com">developers.reddit.com</a> and find your app. From the "App Details" page, scroll to the "Developer Settings" and toggle the "Available" option off. Note that you will not see this option for apps that have only been uploaded, but not published</p>

<h2>Manage your communities</h2>

<p>To view the subreddits you moderate, select “My communities” from the profile dropdown menu. This will list app installations across all communities where you have moderator permissions.</p>

<p><img src="./assets/mod_community_settings.png" alt="mod view" /></p>

<p>Click the subreddit name to install or remove apps from your community.</p>

<p><em>Note: only moderators with app management permissions will be able to modify community app installations. Permissions are <a href="https://mods.reddithelp.com/hc/en-us/articles/360009381491-User-Management-moderators-and-permissions">managed in mod settings</a>.</em></p>
<h2>Update your subreddit app version</h2>

<p>Currently, apps on a subreddit need to be manually updated when a new version is published.</p>

<ol>
<li>Go to your "app details" page in developers.reddit.com and locate the subreddit you want to update.</li>
<li>If a new version of the app is available, an "Upgrade" button will be visible. Click this to update your app.</li>
</ol>
<h1>Ask AI</h1>

<p>You can use Ask AI to find answers to your questions, explore documentation, and troubleshoot common issues. The Ask AI chatbot is trained on Reddit’s developer documentation and code examples and uses information from the source to give you accurate, relevant guidance.</p>

<p>To use Ask AI, just click the icon in the bottom right corner of the page and ask a question.</p>

<p>:::note
You can also use Ask AI from the support section of our <a href="https://discord.com/invite/R7yu2wh9Qz">Discord</a> server. Simply create a new post in the #ask-ai channel and our bot will answer your question.
:::</p>

<h2>Ways to use Ask AI</h2>

<h3>Get help starting your project</h3>

<p>If you are just starting out, Ask AI can guide you through the basics, like creating a
chessboard using Reddit's developer tools and APIs. You’ll get a step-by-step explanation
and links to the relevant documentation to get your project off the ground.</p>

<p><img src="./assets/ask_ai_start_project.png" alt="start a project" /></p>

<h3>Troubleshoot your app</h3>

<p>Ask AI can help identify the cause of common issues, such as HTTP Fetch request
errors. You’ll be guided through potential fixes, like checking your logs or reviewing your setup.</p>

<p><img src="./assets/ask_ai_troubleshoot.png" alt="troubleshoot a project" /></p>

<h2>Ask AI tips</h2>

<p>Ask AI is designed to help you navigate the Developer Platform, but it isn’t going to write your code for you. To make the most of Ask AI:</p>

<ul>
<li>Be specific. Instead of asking “How do I create a bot?”, try asking “How do I use Reddit’s API to create a comment bot?”</li>
<li>Use follow-up questions to continue the conversation and refine the answer.</li>
</ul>

<p>:::note
Ask AI is configured to answer questions based on Reddit’s documentation and code examples. It’s not a general LLM and can’t answer questions about your specific system, other platforms, or the meaning of life.
:::</p>
<h1>Authentication</h1>

<p>To publish, install, and manage applications, you must be logged in with a Reddit account. Once you log in, your access token is stored locally at <code>~/.devvit/token</code>. Whenever you interact with the CLI, the authentication token is loaded and used for interacting with Devvit’s backend. These tokens are automatically refreshed.</p>

<p>Once your app is published, when the app is invoked in the Reddit backend, an access token is automatically issued for the user and is used to interact with the Reddit public API.</p>

<h2>Logging in</h2>

<ol>
<li>Open up a terminal to log in via the CLI.</li>
<li>Type <code>devvit login</code> and press enter.</li>
<li><p>In the browser window, enter your username and password. If you have two-factor authentication (2FA) enabled, you’ll be prompted to enter your 2FA code.
<img src="./assets/oauth-login.png" alt="Reddit login dialogue" /></p></li>
<li><p>Press the Allow button on the authorization screen.
<img src="./assets/oauth-perms.png" alt="OAuth permissions" /></p></li>
<li><p>Once you see the success screen, you can close the browser.
<img src="./assets/oauth-success.png" alt="Succesful OAuth" /></p></li>
<li><p>If the login was successful, you'll see <code>Logged in as &lt;username&gt;</code> in your terminal window.</p></li>
<li><p>To confirm your CLI is authenticated, run <code>devvit whoami</code> and confirm that your username is returned.</p></li>
</ol>

<h2>Logging out</h2>

<p>To logout of your Devvit CLI, run <code>devvit logout</code>. This logs out your local system and revokes the issued access token.</p>

<p>To remove OAuth access to the devvit CLI entirely, go to your <a href="https://www.reddit.com/prefs/apps">app
preferences</a> and click <strong>revoke access</strong>.
<img src="./assets/oauth-revoke.png" alt="Revoke Oauth Permissions" /></p>
<h1>Create a custom post</h1>

<h2>Start a project</h2>

<p>To create a custom post app, use the <code>custom-post</code> template to start a new project.</p>

<ol>
<li>From the terminal, navigate to a directory where you'll store your project.</li>
<li>Enter the following command to create a project folder on your local machine.</li>
</ol>

<p><code>bash
devvit new &lt;replace-with-your-app-name&gt; --template=custom-post
</code></p>

<h3>Install dependencies</h3>

<ol start="3">
<li>To have your package manager install the dependencies, run the following command in the root of your project:</li>
</ol>

<p><code>bash
npm install
</code></p>

<p>-OR-</p>

<p><code>bash
yarn install
</code></p>

<h3>Check out your post!</h3>

<ol start="4">
<li>Open your app in your test subreddit. Run the following command in the root of your project:</li>
</ol>

<p><code>bash
devvit playtest &lt;replace with your test subreddit name&gt;
</code></p>

<p>You'll see a "Hello" post that looks like this:</p>

<p><img src="./assets/hello_blocks_v2.png" alt="hello_blocks" /></p>

<h3>Next steps</h3>

<p>Now that you've created a basic custom post, check out one of our tutorials to learn how to <a href="custom_post_form.md">build a form</a> in a custom post.</p>
<p>A <code>string</code> for defining the text alignment within the text block, both vertically and horizontally. Can be 1 or 2 values, separated by a space. e.g. <code>top</code> or <code>top start</code>.</p>

<p><img src="../../assets/blocks/docs-blocks-stacks-alignment.png" alt="Showing all the alignment options" /></p>

<h4>Vertical alignment</h4>

<ul>
<li><code>top</code>: The default if the attribute is not used.</li>
<li><code>middle</code></li>
<li><code>bottom</code></li>
</ul>

<p>Note: If vertical alignment is not used in a <code>hstack</code>, then the content will stretch vertically.</p>

<h4>Horizontal alignment</h4>

<ul>
<li><code>start</code>: The default if the attribute is not used.</li>
<li><code>center</code></li>
<li><code>end</code></li>
</ul>

<p>Note: If horizontal alignment is not used in a <code>vstack</code>, then the content will stretch horizontally.</p>
<p>A <code>string</code> for setting the color to any <a href="./colors">Blocks-compatible color value</a>. Possible values:</p>

<ul>
<li>HTML color names: <code>red</code></li>
<li>HEX: <code>#ff4500</code></li>
<li>RGB: <code>rgb(255, 69, 0)</code></li>
<li>RGBA: <code>rgba(255, 69, 0, 0.5)</code></li>
<li>RPL Token: <code>neutral-content</code></li>
</ul>
<p>A <code>boolean</code> that allows the block to expand to fill all available space along the axis of its parent container if set to true. Possible values:</p>

<ul>
<li><code>true</code></li>
<li><code>false</code>: The default if the attribute is not used.</li>
</ul>

<p>Has no effect inside a <code>&lt;zstack&gt;</code>.</p>
<p>Prevents the used value of <code>height</code> from becoming larger than the maximum height if set.</p>
<p>Prevents the used value of <code>width</code> from becoming larger than the maximum width if set.</p>
<p>Prevents the used value of <code>height</code> from becoming smaller than the minimum height if set.</p>
<p>Prevents the used value of <code>width</code> from becoming smaller than the minimum width if set.</p>
<p>Attaches an event handler for press events on the block.</p>
<h1>Build</h1>

<p>Building apps for your subreddit lets you customize your community and automate mod functions. Once you’ve installed devvit and registered as a Reddit developer, you’ll be ready to create an app.</p>

<h2>Install or update your CLI</h2>

<p>First, make sure you are running the latest version of the <code>devvit</code> CLI. The <code>npm install -g</code> command will either install or update your package. Run:</p>

<p><code>bash
npm install -g @devvit/cli
</code></p>

<p>:::note</p>

<p>If you are running into errors, check out our guide for how to set up your <a href="./dev_guide.mdx#environmentsetup">development environment</a>.</p>

<p>:::</p>

<h2>Create an app</h2>

<p>Creating an app is easy. You can create your own app from scratch or use an <a href="./templates.mdx">app template</a> to start with complete, functioning code examples.</p>

<p>To create a new app, navigate to your selected app folder and run the create command.</p>

<p><code>
$ devvit new &lt;app-name&gt;
</code></p>

<p>:::note</p>

<p>Project names must be six or more characters, all lowercase, can't start with numerals and include only a-z, 0-9 or '-'. We recommend "kebob-case" names.</p>

<p>:::</p>

<p>To create an app based on a template, use the -t flag to create a new project. The following example creates an app based on the Remind Me template.</p>

<p><code>bash
devvit new -t remind-me my-first-app
</code></p>
<h1>App configurations</h1>

<p>Include configuration settings in your app.</p>

<p><img src="../assets/capabilities/app-configurations/app-configurations-all-types.png" alt="An example form with all field types" /></p>

<p>Configuration settings let users change the functionality and behavior of an app. Use the following steps to add settings at the global app-scope.</p>

<ol>
<li>Use <code>Devvit.addSettings</code> to define the fields with scope as <code>SettingsScope.App</code></li>
</ol>

<p>```tsx
import { Devvit, SettingScope } from '@devvit/public-api';</p>

<p>Devvit.addSettings([
  {
    type: 'string',
    name: 'my-feature-flag',
    label: 'Feature Flag to rollout a new change',
    scope: SettingScope.App, // this can be a string literal 'app' as well
  },
]);
```</p>

<ol start="2">
<li>Store the app setting value via CLI. Keep in mind this operation modifies the value across all installations.</li>
</ol>

<p><code>bash
devvit settings set my-feature-flag
</code></p>

<ol start="3">
<li>Access the global setting inside your app. Example menu item to show a toast with the setting value:</li>
</ol>

<p><code>tsx
Devvit.addMenuItem({
  label: 'Test App Settings',
  location: 'subreddit',
  onPress: async (_event, { ui, settings }) =&gt; {
    // retrieve the global setting
    const featureFlag = await settings.get('my-feature-flag');
    ui.showToast(`Retrieved the setting featureFlag as ${featureFlag}`);
  },
});
</code></p>

<p>Once the app is installed, the configuration settings are available on the Install Settings page. Moderators add the required input and save the changes to configure the app. Note that these configurations are limited to the subreddit where the app is installed, so your app can be uniquely configured to each subreddit’s specific needs.</p>

<h2>Input types</h2>

<p>There are currently five supported types of input:</p>

<ul>
<li>String or <code>'string'</code></li>
<li>Boolean or <code>'boolean'</code></li>
<li>Number or <code>'number'</code></li>
<li>Dropdown selection or <code>'select'</code></li>
<li>Paragraph or <code>'paragraph'</code></li>
</ul>

<p>See the <a href="./forms.md">Forms page</a> for more detail.</p>

<h2>Configuring settings within your app</h2>

<p>You can use the following code snippets as a guide to adding configuration settings to your app:</p>

<ol>
<li>First, make sure this import is at the top of your file.</li>
</ol>

<p><code>tsx
import { Devvit } from '@devvit/public-api';
</code></p>

<ol start="2">
<li>Use <code>Devvit.addSettings</code> to define any input fields you want to add to your settings form. Each field needs to be assigned a type, name, and label. You can provide the dropdown options for selection fields, as well as determine if the user can select more than one option within the dropdown. The label is the only text that will be visible on the form, so use this to communicate what the moderator should enter in each input field.</li>
</ol>

<p><code>tsx
Devvit.addSettings([
  {
    type: 'string',
    name: 'text-input',
    label: 'Enter your text input:',
    onValidate: async ({ value }) =&gt; {
      if (value !== 'bird') {
        return 'Word must be "bird"';
      }
    },
  },
  {
    type: 'boolean',
    name: 'bool-input',
    label: 'Use the switch to determine if some setting should be enabled:',
  },
  {
    type: 'select',
    name: 'select-input',
    label: 'Select one of the options:',
    options: [
      {
        label: 'Option 1',
        value: 'Option 1',
      },
      {
        label: 'Option 2',
        value: 'Option 2',
      },
    ],
    multiSelect: false,
  },
  {
    type: 'select',
    name: 'multiselect-input',
    label: 'Select multiple options:',
    options: [
      {
        label: 'Option 1',
        value: 'Option 1',
      },
      {
        label: 'Option 2',
        value: 'Option 2',
      },
      {
        label: 'Option 3',
        value: 'Option 3',
      },
    ],
    multiSelect: true,
  },
  {
    type: 'number',
    name: 'number-input',
    label: 'Enter your number input:',
  },
  {
    type: 'group',
    label: 'This is a GROUP field',
    fields: [
      {
        type: 'string',
        name: 'group-text-input',
        label: 'Group: Enter your text input:',
      },
      {
        type: 'boolean',
        name: 'group-bool-input',
        label: 'Group: Use the switch to determine if some setting should be enabled:',
      },
    ],
  },
]);
</code></p>

<h3>Input validation</h3>

<p><img src="../assets/capabilities/app-configurations/app-configurations-validation.png" alt="Input validation" /></p>

<p>Devvit app configurations also support input validation. As the app developer, you can set restrictions on what kind of input must be entered in each field.</p>

<p>For example, setting a maximum number:</p>

<p><code>tsx
onValidate: (event) =&gt; {
  if (event.value! &gt; 10) {
    return 'Number too high!';
  }
};
</code></p>

<p>To use validation, add the <code>onValidate</code> handler to the settings field object, like this:</p>

<p><code>tsx
  {
    type: 'number',
    name: 'number-input',
    label: 'Enter your number input:',
    onValidate: (event) =&gt; {
      if (event.value! &gt; 10) { return 'Number too high! Must be lower than 10.' }
    }
  },
</code></p>

<h2>Retrieving settings within your app</h2>

<p>After you've written the configuration settings for your app, you can see the input that has been entered by the moderator by using <code>getSettings</code>.</p>

<ol>
<li>Add the following imports to the top of your file:</li>
</ol>

<p><code>tsx
import { Devvit } from '@devvit/public-api';
</code></p>

<ol start="2">
<li>Use <code>Devvit.addMenuItem</code> to create a menu item that will trigger a toast message containing the form input.</li>
</ol>

<p>```tsx
Devvit.addMenuItem({
  label: 'Test Action',
  location: Context.SUBREDDIT,
  onPress: (_, context) {
    // to get all settings
    const settings = await context.settings.getAll();
    // to get an individual setting
    const textFieldInput = await context.settings.get('text-input');</p>

<pre><code>ui.showToast(JSON.stringify(textFieldInput))
</code></pre>

<p>},
});
```</p>

<p><img src="../assets/capabilities/app-configurations/app-configurations-data-toast.png" alt="Settings retrieval" /></p>
<h1>Cache helper</h1>

<p>Cache helper lets you build a more performant app by reducing the number of server side calls for the same data. You can create a short-term cache that stores JSON objects in your Devvit app for a limited amount of time. This is valuable when you have many clients trying to get the same data for example with a stock ticker value or with a sports score.</p>

<p>Under the covers, it's Redis plus a local in-memory write-through cache. This provides a pattern for fetching data without involving a scheduler and allows granular, small TTLs (1 second~). Cache helper lets the app make one request for the data, save the response, and provide this response to all users requesting the same data.</p>

<p>:::warning
<strong>Do not cache sensitive information</strong>. Cache helper randomly selects one user to make the real request and saves the response to the cache for others to use. You should only use cache helper for non-personalized fetches, since the same response is available to all users.
:::</p>

<h2>Usage</h2>

<p>You need to enable <a href="./redis.md">Redis</a> in order to use Cache helper.</p>

<p><code>tsx
Devvit.configure({
  redis: true,
  // other capabilities
});
</code></p>

<h2>Parameters</h2>

<p>| <strong>Parameters</strong> | <strong>Description</strong>                                                                                                                                                                                                                                                                                                            |
| -------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <code>key</code>          | This is a string that identifies a cached response. Instead of making a real request, the app gets the cached response with the key you provide. Make sure to use different keys for different data. For example, if you’re saving post-specific data, add the postId to the cache key, like this: <code>post_data_${postId})</code>. |
| <code>ttl</code>          | Time to live is the number of milliseconds the cached response is expected to be relevant.                                                                                                                                                                                                                                 |</p>

<p>Once it expires, the cached response will be voided and a real request is made to populate the cache again. You can treat it as a threshold, where ttl of 30000 would mean that a request is done no more than once per 30 seconds. |</p>

<h2>Example</h2>

<p>Here’s a way to set up in-app caching instead of using scheduler or interval to fetch.</p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>Devvit.configure({
  redis: true,
  http: true, // to use <code>fetch()</code>
  // other capabilities
});</p>

<p>Devvit.addCustomPostType({
  name: 'Name',
  render: (context) =&gt; {
    const [data, setData] = useState({});</p>

<pre><code>async function getData() {
  const result = await context.cache(
    async () =&gt; {
      const response = await fetch('https://example.com');
      if (!response.ok) {
        throw Error(`HTTP error ${response.status}: ${response.statusText}`);
      }
      return await response.json();
    },
    {
      key: context.userId!,
      ttl: 10_000, // millis
    }
  );

  setData(result);
}

return (
  &lt;blocks&gt;
    &lt;button
      onPress={() =&gt; {
        getData();
      }}
    &gt;
      Load data
    &lt;/button&gt;

    &lt;text&gt;{data.something}&lt;/text&gt;
  &lt;/blocks&gt;
);
</code></pre>

<p>},
});</p>

<p>export default Devvit;
```</p>
<h1>Forms</h1>

<p>A form lets your app ask users to input and submit data. Forms can be defined with a simple <a href="#form-object">form object</a> that takes a <a href="#supported-fields-types">list of fields</a>, and an <a href="#on-submit-handler">onSubmit handler</a>.</p>

<p><img src="../assets/capabilities/forms/forms-dialog.png" alt="A form dialog" /></p>

<h2>Using forms</h2>

<p>There are several ways to add a form to your app, and the method you'll use depends on what you’re doing.</p>

<ul>
<li>For <a href="#interactive-posts">interactive posts</a>, use the <code>context.ui.useForm</code> hook.</li>
<li>For <a href="#menu-actions">menu actions</a>, use the <a href="/docs/api/public-api/classes/Devvit-1.md#createform"><code>devvit.createForm</code></a> method.</li>
<li>For <a href="#app-configurations">app configurations</a>, use the <a href="/docs/api/public-api/classes/Devvit-1.md#addsettings"><code>devvit.addSettings</code></a> method.</li>
</ul>

<h3>Interactive posts</h3>

<p>This example shows an interactive post with a text label and a button that triggers a form. When the form is submitted, the onSubmit handler takes the form input and manipulates state with <a href="/docs/working_with_usestate.md"><code>useState</code></a>. The state update triggers a rerender and the new data is displayed.</p>

<p>```tsx
import { Devvit, useState, useForm } from '@devvit/public-api';</p>

<p>Devvit.addCustomPostType({
  name: 'TemplateName',
  render: (context) =&gt; {
    const [name, setName] = useState('unknown');</p>

<pre><code>const myForm = useForm(
  {
    fields: [
      {
        type: 'string',
        name: 'name',
        label: 'Name',
      },
    ],
  },
  (values) =&gt; {
    // onSubmit handler
    setName(values.name);
  }
);

return (
  &lt;vstack gap="medium" height="100%" alignment="middle center"&gt;
    &lt;text&gt;Hello {name}!&lt;/text&gt;
    &lt;button
      onPress={() =&gt; {
        context.ui.showForm(myForm);
      }}
    &gt;
      Set name
    &lt;/button&gt;
  &lt;/vstack&gt;
);
</code></pre>

<p>},
});</p>

<p>export default Devvit;
```</p>

<p><a href="https://developers.reddit.com/play#pen/N4IgdghgtgpiBcIBiB7ATlABASzJgogB4AOMa2MYAxjJgAooDOALiADQiNpUIjZTF0zTMEwARGADdJ2YQF9MAMzQosAcgACAEykzmAemIBXAEYAbbFQC0EYtjUBuADpgXE6bIB0ELVoDCRiyqDCwAKgCepAAUwC6YmJCw8JhqoTACZhDMMABy0DBqbHGYaJQ6aMlRVChg2YTMAJSYALwAfCLF8dVgLJgA2okwbJiMMMx5sAC6LZjddcyegTAAysxZMFFqRmAA1mAoAO5gag3OrnjxszW9UOGoGDNzMPWLo-dQUZ2XsReXl4oUMxaRjJPpfP7xH4Q6GYZiRGDJNQschgADmhXBMMGiMGGN+MPimRMMDMiImBSK+OhckpBMmtIhNMxUUkEDMRhgjCabQ6VMuo3G+RZbI5jE8g1OmLkX0l5z+pWYRjQeE+fIAPJIWBAqDtMKjbM0nCBYFpsEYoEbMAALGDYVFW5iGkAARgADK6AKSWtl2sCwWpOqDYXxmWg0WpkI2tTHxNXzVoACRJZhQIkGcgAhGr9PGY5g1SYjMxmDU8-EanRSoxGM1gFFue0oQTLk8XkZsJ5GFbDu8ord3rLm5g5NK+fFo2PLssxgl8nns4XizUJ9Ds5q1jqV5dB8PKXJZS5noI0MIdIoIEYzMJ3HoHOwQJIyIxsDUEM65EA">Explore example in playground</a>.</p>

<h3>Menu actions</h3>

<p>This example defines a new form and a onSubmit handler called <code>myForm</code> using the <code>devvit.createForm</code> method. This form is shown via a <a href="./menu-actions.md">menu action</a> using <code>context.ui.showForm()</code>.</p>

<p>```ts
import { Devvit } from '@devvit/public-api';</p>

<p>const myForm = Devvit.createForm(
  {
    fields: [
      {
        type: 'string',
        name: 'food',
        label: 'What is your favorite food?',
      },
    ],
  },
  (event, context) =&gt; {
    // onSubmit handler
    context.ui.showToast({ text: event.values.food });
  }
);</p>

<p>Devvit.addMenuItem({
  label: 'Show a form',
  location: 'subreddit',
  onPress: async (_event, context) =&gt; {
    context.ui.showForm(myForm);
  },
});</p>

<p>export default Devvit;
```</p>

<h3>App configurations</h3>

<p>For more details see the <a href="./app-configurations.md">app configurations page</a>.</p>

<h2>Form object</h2>

<p>The form object enables you to customize the form container and the <a href="#supported-fields-types">list of form fields</a> included. The form object is passed along to <code>context.ui.useForm</code>, <a href="/docs/api/public-api/classes/Devvit-1.md#createform"><code>devvit.createForm</code></a>, or <a href="/docs/api/public-api/classes/Devvit-1.md#addsettings"><code>devvit.addSettings</code></a> to create the form.</p>

<h4>Usage</h4>

<p><code>tsx
const myForm = {
  title: 'My form',
  description: 'This is my form. There are many like it, but this one is mine.',
  fields: [
    {
      type: 'string',
      name: 'food',
      label: 'What is your favorite food?',
    },
    {
      type: 'string',
      name: 'drink',
      label: 'What is your favorite drink?',
    },
  ],
  acceptLabel: 'Submit',
  cancelLabel: 'Cancel',
};
</code></p>

<h4>Supported properties</h4>

<p>| Property      | Supported types      | Description                                   |
| :------------ | :------------------- | :-------------------------------------------- |
| <code>title</code>       | <code>string</code> <code>undefined</code> | An optional title for the form                |
| <code>description</code> | <code>string</code> <code>undefined</code> | An optional description for the form          |
| <code>fields</code>      | <code>FormField[]</code>        | The fields that will be displayed in the form |
| <code>acceptLabel</code> | <code>string</code> <code>undefined</code> | An optional label for the submit button       |
| <code>cancelLabel</code> | <code>string</code> <code>undefined</code> | An optional label for the cancel button       |</p>

<h2>onSubmit handler</h2>

<p>When creating a form, you also specify a callback function that is called when the form is submitted. It takes two parameters: <code>event</code> and <code>context</code>. The <code>event</code> parameter contains the results of the form submission, while the <code>context</code> parameter represents the current app context of the form submission event.</p>

<p>```ts
const onSubmitHandler = (event, context) =&gt; {
  context.ui.showToast({ text: event.values.food });
};</p>

<p>const myForm = Devvit.createForm(
  {
    fields: [
      {
        type: 'string',
        name: 'food',
        label: 'What is your favorite food?',
      },
    ],
  },
  onSubmitHandler
);
```</p>

<p>:::note
Note: The <code>context</code> object is not available in onSubmit handlers within the <code>useForm</code> hook. For interactive posts, you already have access to the context element via the outer function's scope.
:::</p>

<h2>Supported fields types</h2>

<p>The following field types are supported: <a href="#string">String</a>, <a href="#select">Select</a>, <a href="#paragraph">Paragraph</a>, <a href="#number">Number</a>, <a href="#boolean">Boolean</a>, and <a href="#group">Group</a>.</p>

<h3>String</h3>

<p>A single-line text input.</p>

<p><img src="../assets/capabilities/forms/forms-string.png" alt="String input" /></p>

<h4>Usage</h4>

<p><code>ts
const stringField = {
  type: 'string',
  name: 'title',
  label: 'Tournament title',
};
</code></p>

<h4>Properties</h4>

<p>| Property       | Supported types                                                                   | Description                                                                                                                                                      |
| :------------- | :-------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <code>type</code>         | <code>string</code>                                                                          | The desired field type.                                                                                                                                          |
| <code>name</code>         | <code>string</code>                                                                          | The name of the field. This will be used as the key in the <code>values</code> object when the form is submitted.                                                           |
| <code>label</code>        | <code>string</code>                                                                          | The label of the field. This will be displayed to the user.                                                                                                      |
| <code>helpText</code>     | <code>string</code> <code>undefined</code>                                                              | An optional help text that will be displayed below the field.                                                                                                    |
| <code>required</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be required and the user will not be able to submit the form without filling it in. Defaults to <code>false</code>.                                  |
| <code>disabled</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be disabled. Defaults to <code>false</code>.                                                                                                         |
| <code>defaultValue</code> | <code>ValueType</code> <code>undefined</code>                                                          | The default value of the field.                                                                                                                                  |
| <code>scope</code>        | <a href="/docs/api/public-api/README.md#settingscopetype"><code>SettingScopeType</code></a> <code>undefined</code> | This indicates whether the field (setting) is an app level or install level setting. App setting values can be used by any installation. <code>undefined</code> by default. |
| <code>placeholder</code>  | <code>string</code> <code>undefined</code>                                                              | Placeholder text for display before a value is present.                                                                                                          |
| <code>isSecret</code>     | <code>boolean</code> <code>undefined</code>                                                             | Makes the form field secret.                                                                                                                                     |</p>

<h3>Select</h3>

<p>A dropdown menu with predefined options.</p>

<p><img src="../assets/capabilities/forms/forms-select.png" alt="Select input" /></p>

<h4>Usage</h4>

<p><code>ts
const selectField = {
  type: 'select',
  name: 'interval',
  label: 'Update the leaderboard',
  options: [
    { label: 'Hourly', value: 'hourly' },
    { label: 'Daily', value: 'daily' },
    { label: 'Weekly', value: 'weekly' },
    { label: 'Monthly', value: 'monthly' },
    { label: 'Yearly', value: 'yearly' },
  ],
};
</code></p>

<h4>Properties</h4>

<p>| Property       | Supported types                                                                   | Description                                                                                                                                                      |
| :------------- | :-------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <code>type</code>         | <code>string</code>                                                                          | The desired field type.                                                                                                                                          |
| <code>name</code>         | <code>string</code>                                                                          | The name of the field. This will be used as the key in the <code>values</code> object when the form is submitted.                                                           |
| <code>label</code>        | <code>string</code>                                                                          | The label of the field. This will be displayed to the user.                                                                                                      |
| <code>options</code>      | <code>FieldConfig_Selection_Item[]</code>                                                    | The list of options available.                                                                                                                                   |
| <code>helpText</code>     | <code>string</code> <code>undefined</code>                                                              | An optional help text that will be displayed below the field.                                                                                                    |
| <code>required</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be required and the user will not be able to submit the form without filling it in. Defaults to <code>false</code>.                                  |
| <code>disabled</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be disabled. Defaults to <code>false</code>.                                                                                                         |
| <code>defaultValue</code> | <code>string[]</code> <code>undefined</code>                                                           | The default value of the field. Note that the default value is wrapped in an array to support multiple selected values.                                          |
| <code>scope</code>        | <a href="/docs/api/public-api/README.md#settingscopetype"><code>SettingScopeType</code></a> <code>undefined</code> | This indicates whether the field (setting) is an app level or install level setting. App setting values can be used by any installation. <code>undefined</code> by default. |
| <code>multiSelect</code>  | <code>boolean</code> <code>undefined</code>                                                             | Enables users to select more than 1 item from the set.                                                                                                           |</p>

<h3>Paragraph</h3>

<p>A multi-line text input for longer responses.</p>

<p><img src="../assets/capabilities/forms/forms-paragraph.png" alt="Paragraph input" /></p>

<h4>Usage</h4>

<p><code>ts
const paragraphField = {
  type: 'paragraph',
  name: 'description',
  label: 'Description',
};
</code></p>

<h4>Properties</h4>

<p>| Property       | Supported types                                                                   | Description                                                                                                                                                      |
| :------------- | :-------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <code>type</code>         | <code>string</code>                                                                          | The desired field type.                                                                                                                                          |
| <code>name</code>         | <code>string</code>                                                                          | The name of the field. This will be used as the key in the <code>values</code> object when the form is submitted.                                                           |
| <code>label</code>        | <code>string</code>                                                                          | The label of the field. This will be displayed to the user.                                                                                                      |
| <code>helpText</code>     | <code>string</code> <code>undefined</code>                                                              | An optional help text that will be displayed below the field.                                                                                                    |
| <code>required</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be required and the user will not be able to submit the form without filling it in. Defaults to <code>false</code>.                                  |
| <code>disabled</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be disabled. Defaults to <code>false</code>.                                                                                                         |
| <code>defaultValue</code> | <code>ValueType</code> <code>undefined</code>                                                          | The default value of the field.                                                                                                                                  |
| <code>scope</code>        | <a href="/docs/api/public-api/README.md#settingscopetype"><code>SettingScopeType</code></a> <code>undefined</code> | This indicates whether the field (setting) is an app level or install level setting. App setting values can be used by any installation. <code>undefined</code> by default. |
| <code>placeholder</code>  | <code>string</code> <code>undefined</code>                                                              | Placeholder text for display before a value is present.                                                                                                          |
| <code>lineHeight</code>   | <code>number</code> <code>undefined</code>                                                              | Sets the field height by number of lines.                                                                                                                        |</p>

<h3>Number</h3>

<p>An input for numerical values.</p>

<p><img src="../assets/capabilities/forms/forms-number.png" alt="Number input" /></p>

<h4>Usage</h4>

<p><code>ts
const numberField = {
  type: 'number',
  name: 'tokens',
  label: 'Token balance',
};
</code></p>

<h4>Properties</h4>

<p>| Property       | Supported types                                                                   | Description                                                                                                                                                      |
| :------------- | :-------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <code>type</code>         | <code>string</code>                                                                          | The desired field type.                                                                                                                                          |
| <code>name</code>         | <code>string</code>                                                                          | The name of the field. This will be used as the key in the <code>values</code> object when the form is submitted.                                                           |
| <code>label</code>        | <code>string</code>                                                                          | The label of the field. This will be displayed to the user.                                                                                                      |
| <code>helpText</code>     | <code>string</code> <code>undefined</code>                                                              | An optional help text that will be displayed below the field.                                                                                                    |
| <code>required</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be required and the user will not be able to submit the form without filling it in. Defaults to <code>false</code>.                                  |
| <code>disabled</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be disabled. Defaults to <code>false</code>.                                                                                                         |
| <code>defaultValue</code> | <code>ValueType</code> <code>undefined</code>                                                          | The default value of the field.                                                                                                                                  |
| <code>scope</code>        | <a href="/docs/api/public-api/README.md#settingscopetype"><code>SettingScopeType</code></a> <code>undefined</code> | This indicates whether the field (setting) is an app level or install level setting. App setting values can be used by any installation. <code>undefined</code> by default. |</p>

<h3>Boolean</h3>

<p>A yes/no or true/false type input.</p>

<p><img src="../assets/capabilities/forms/forms-boolean.png" alt="Boolean input" /></p>

<h4>Usage</h4>

<p><code>ts
const booleanField = {
  type: 'boolean',
  name: 'enable',
  label: 'Enable the event',
};
</code></p>

<h4>Properties</h4>

<p>| Property       | Supported types                                                                   | Description                                                                                                                                                      |
| :------------- | :-------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <code>type</code>         | <code>string</code>                                                                          | The desired field type.                                                                                                                                          |
| <code>name</code>         | <code>string</code>                                                                          | The name of the field. This will be used as the key in the <code>values</code> object when the form is submitted.                                                           |
| <code>label</code>        | <code>string</code>                                                                          | The label of the field. This will be displayed to the user.                                                                                                      |
| <code>helpText</code>     | <code>string</code> <code>undefined</code>                                                              | An optional help text that will be displayed below the field.                                                                                                    |
| <code>disabled</code>     | <code>boolean</code> <code>undefined</code>                                                             | If true the field will be disabled. Defaults to <code>false</code>.                                                                                                         |
| <code>defaultValue</code> | <code>ValueType</code> <code>undefined</code>                                                          | The default value of the field.                                                                                                                                  |
| <code>scope</code>        | <a href="/docs/api/public-api/README.md#settingscopetype"><code>SettingScopeType</code></a> <code>undefined</code> | This indicates whether the field (setting) is an app level or install level setting. App setting values can be used by any installation. <code>undefined</code> by default. |</p>

<h3>Image</h3>

<p>An image upload field.</p>

<p><img src="../assets/capabilities/forms/forms-image.png" alt="Image input" /></p>

<h4>Usage</h4>

<p><code>ts
const imageField = {
  type: 'image', // This tells the form to expect an image
  name: 'myImage',
  label: 'Image goes here',
  required: true,
};
</code></p>

<h4>Properties</h4>

<p>| Property      | Supported types                                                                | Description                                                                                                                                                      |
| :------------ | :----------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <code>type</code>        | <code>string</code>                                                                       | The desired field type.                                                                                                                                          |
| <code>name</code>        | <code>string</code>                                                                       | The name of the field. This will be used as the key in the <code>values</code> object when the form is submitted.                                                           |
| <code>label</code>       | <code>string</code>                                                                       | The label of the field. This will be displayed to the user.                                                                                                      |
| <code>helpText</code>    | <code>string</code> <code>undefined</code>                                                           | An optional help text that will be displayed below the field.                                                                                                    |
| <code>required</code>    | <code>boolean</code> <code>undefined</code>                                                          | If true the field will be required and the user will not be able to submit the form without filling it in. Defaults to <code>false</code>.                                  |
| <code>disabled</code>    | <code>boolean</code> <code>undefined</code>                                                          | If true the field will be disabled. Defaults to <code>false</code>.                                                                                                         |
| <code>scope</code>       | <a href="../api/public-api/README.md#settingscopetype"><code>SettingScopeType</code></a> <code>undefined</code> | This indicates whether the field (setting) is an app level or install level setting. App setting values can be used by any installation. <code>undefined</code> by default. |
| <code>placeholder</code> | <code>string</code> <code>undefined</code>                                                           | Placeholder text for display before a value is present.                                                                                                          |
| <code>isSecret</code>    | <code>boolean</code> <code>undefined</code>                                                          | Makes the form field secret.                                                                                                                                     |</p>

<h3>Group</h3>

<p>A collection of related fields that allows for better readability.</p>

<h4>Usage</h4>

<p><code>ts
const groupField = {
  type: 'group',
  label: 'This is a group of input fields',
  fields: [
    {
      type: 'paragraph',
      name: 'description',
      label: 'How would you describe what happened?',
    },
    {
      type: 'number',
      name: 'score',
      label: 'How would you rate your meal on a scale from 1 to 10?',
    },
  ],
};
</code></p>

<h4>Properties</h4>

<p>| Property   | Supported types      | Description                                                   |
| :--------- | :------------------- | :------------------------------------------------------------ |
| <code>type</code>     | <code>string</code>             | The desired field type.                                       |
| <code>label</code>    | <code>string</code>             | The label of the group that will be displayed to the user.    |
| <code>fields</code>   | <code>FormField[]</code>        | The fields that will be displayed in the group.               |
| <code>helpText</code> | <code>string</code> <code>undefined</code> | An optional help text that will be displayed below the group. |</p>

<h2>Examples</h2>

<p>Below is a collection of common use cases and patterns.</p>

<h3>Dynamic forms</h3>

<p>Instead of passing a static Form, you can create a function that returns a Form. This enables us to dynamically determine which fields to show and what default values to populate them with. We can also pass along any data via the <code>context.ui.showForm</code> method's optional 2nd argument.</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.configure({
  redditAPI: true,
});</p>

<p>const myForm = Devvit.createForm(
  (data) =&gt; {
    return {
      fields: [
        {
          type: 'string',
          name: 'username',
          label: 'Username',
          defaultValue: data.username,
        },
      ],
      // Adding <code>as const</code> helps you get accurate types in the onSubmit function below
      // This will only work if the function does not have any branching logic
    } as const;
  },
  (event, context) =&gt; {
    context.ui.showToast({
      text: <code>Hello ${event.values.username}</code>,
    });
  }
);</p>

<p>Devvit.addMenuItem({
  label: 'Show a dynamic form',
  location: 'subreddit',
  onPress: async (_event, context) =&gt; {
    const user = await context.reddit.getCurrentUser();
    const username = user?.username;
    context.ui.showForm(myForm, { username });
  },
});</p>

<p>export default Devvit;
```</p>

<h3>One of everything</h3>

<p>This example includes one of each of the <a href="#supported-fields-types">supported field types</a>.</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>const exampleForm = Devvit.createForm(
  {
    title: 'My favorites',
    description: 'Tell us about your favorite food!',
    fields: [
      {
        type: 'string',
        name: 'food',
        label: 'What is your favorite food?',
        helpText: 'Must be edible',
        required: true,
      },
      {
        label: 'About that food',
        type: 'group',
        fields: [
          {
            type: 'number',
            name: 'times',
            label: 'How many times a week do you eat it?',
            defaultValue: 1,
          },
          {
            type: 'paragraph',
            name: 'what',
            label: 'What makes it your favorite?',
          },
          {
            type: 'select',
            name: 'healthy',
            label: 'Is it healthy?',
            options: [
              { label: 'Yes', value: 'yes' },
              { label: 'No', value: 'no' },
              { label: 'Maybe', value: 'maybe' },
            ],
            defaultValue: ['maybe'],
          },
        ],
      },
      {
        type: 'boolean',
        name: 'again',
        label: 'Can we ask again?',
      },
    ],
    acceptLabel: 'Submit',
    cancelLabel: 'Cancel',
  },
  (event, context) =&gt; {
    console.log(event.values);
    context.ui.showToast('Thanks!');
  }
);</p>

<p>Devvit.addMenuItem({
  location: 'subreddit',
  label: 'One of everything form',
  onPress: (_event, context) =&gt; {
    context.ui.showForm(exampleForm);
  },
});</p>

<p>export default Devvit;
```</p>

<h3>Multi-step forms</h3>

<p>Add a multi-step dynamic form to an interactive post</p>

<p>```tsx
import { Devvit, useState, useForm } from '@devvit/public-api';</p>

<p>Devvit.configure({
  redditAPI: true,
});</p>

<p>Devvit.addCustomPostType({
  name: 'Multi-step Form',
  render: (context) =&gt; {
    const [name, setName] = useState('');
    const [food, setFood] = useState('');
    const [drink, setDrink] = useState('');</p>

<pre><code>const form3 = useForm(
  {
    fields: [
      {
        type: 'string',
        name: 'drink',
        label: "What's your favorite drink?",
        required: true,
      },
    ],
  },
  (values) =&gt; {
    setDrink(values.drink);
  }
);

const form2 = useForm(
  {
    fields: [
      {
        type: 'string',
        name: 'food',
        label: "What's your favorite food?",
        required: true,
      },
    ],
  },
  (values) =&gt; {
    setFood(values.food);
    context.ui.showForm(form3);
  }
);

const form1 = useForm(
  {
    fields: [
      {
        type: 'string',
        name: 'name',
        label: "What's your name?",
        required: true,
      },
    ],
  },
  (values) =&gt; {
    setName(values.name);
    context.ui.showForm(form2);
  }
);

function restart() {
  setName('');
  setFood('');
  setDrink('');
  context.ui.showForm(form1);
}

const isAnswered = name &amp;&amp; food &amp;&amp; drink;

return (
  &lt;vstack height="100%" alignment="center middle" gap="none"&gt;
    {isAnswered &amp;&amp; (
      &lt;&gt;
        &lt;text&gt;Name: {name}&lt;/text&gt;
        &lt;text&gt;Favorite food: {food}&lt;/text&gt;
        &lt;text&gt;Favorite drink: {drink}&lt;/text&gt;
        &lt;spacer size="large" /&gt;
        &lt;button onPress={restart}&gt;Restart&lt;/button&gt;
      &lt;/&gt;
    )}
    {!isAnswered &amp;&amp; &lt;button onPress={restart}&gt;Take questionnaire&lt;/button&gt;}
  &lt;/vstack&gt;
);
</code></pre>

<p>},
});</p>

<p>Devvit.addMenuItem({
  location: 'subreddit',
  label: 'Add post with multi-step form',
  onPress: async (_event, context) =&gt; {
    const currentSubreddit = await context.reddit.getCurrentSubreddit();
    await context.reddit.submitPost({
      title: 'Interactive post with multi-step form',
      subredditName: currentSubreddit.name,
      preview: (
        <vstack width="100%" height="100%" alignment="middle center">
          <text>Loading ...</text>
        </vstack>
      ),
    });
    context.ui.showToast('Submitted post!');
  },
});</p>

<p>export default Devvit;
```</p>

<p><a href="https://developers.reddit.com/play#pen/N4IgdghgtgpiBcICyBXANgFwJYFoDOGMADgAQBmA9gE5QlZgkwAeRMVWMYAxjCURQRAAaEHipcEILFH5UMJYCQAiMAG6qs8gL7kqFWgHIAAgBM1GjAHoiKAEZosXHBCJYDAbgA6YbyvWaAOi4KMDIsAHMUKhgACmBvEhJokxNNAEEABQBJeBIMKhQYIW8tAEovHzA-CwCIFIBhFAJ9DIEMABUAT1Y4hJJIWFyDVExcAmISADFqKANihiTOMypcmOCwQiYMUpIAXgA+BT7E9YISAG0BopI8GAwAOWgYAF09knXNjACmmABlDAghBiBgM5WO7xCZ3OlAoJiENzu01hr12EI2zC+P3+gNiILBCxOkPk5xM7DAAGt4bcMEoyeSUWjPt9btigXiKuDTvJKDQAMxvD4Y5kwaY0GLgxLxAmJGVhGBoEx4XLnCUyyWqtWJDDdGBDAhk8JzDWaq5DUn0clG6WamVoCC2eW5TwgADqAAtAQY8CROhQouQIKpqJpeOaKQB+Z3zG026IARxQWGSuXyhWjMcSWnTNue2ZlWdVMVUEDQhTwOwOR2tMuptItRZLZYCYfJ+JtWnB+M5RPIMwATAKQkyfqKoOLq1KM3KFUqLsb1dWbdrWHr8vRDXmM6aSAYYSYrRm1XaHWgna6PRgvT6-VQA0H2IRe7DI8J5zL44nk3kCkU3wXFyQuaqv+NoNqWMDlnshyTjG1JIiYYFNnubYxoKWzfFgAR4G6FAAO6jjEPJQLyKFqh20pdtKXK9jQACMg7ouhI4zOONowTa06Ksqb7sYey66ju+rrgeh6JNuBhXCJonHo6JDOu6nrer6-pXC+m4xh+SYwCYKY-upZH6YB6kgZqiEQRW0HGtSjywGZeABFcpGamhmKYdheEEURfZOZmnYctKZAoNw2AhIsBAQHIMQ7LxiTWU8wKghUNpwRQsIJT5CI0nS6VJc5Q5ComWE4fhLFEbRTnkd2YBnFgeBpNVuFsNpbxXCQABkbVPiY7WdS2-lqtEGBRAwrGagAPKo4VcOSJBujAERuhguzOrRAAMq0AKTOiQJYRGAsAbMtIA8Oit5QFgKRoDA23hC4R1gCE10gPsxrALV9V4I1yQ9SQo0ZmNL0AWqY2fPsNkCcAVxaGNlig2+iQgxi+yTIGwaPnuuTAHu0Ow0j8MkIjWzI6jD6hnSmMtjjcNAzKY14EQEA8LeeBYAAXjAR12lQ4RPSQliA6JCO2CgGAYKFIQZNEeB4LswBSwCchaPsABKEEKxgMPC6LIQC4eMO6zapTkRmwAAITvQ1TXdR1BNa2LDAS1LMty2rEUYEr7QQOSvAJmrWAhJAWmayL9v7Mb42WJNALTQbJAof+ZT+cwsjyGYZAQOg8jVJoFTCCAqhsCzIQILRWhAA">Explore example in a playground</a>.</p>

<h3>Image uploads</h3>

<p>Add an image upload input to a form.</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>const form = Devvit.createForm(
  {
    title: 'Upload an image!',
    fields: [
      {
        name: 'myImage',
        type: 'image', // This tells the form to expect an image
        label: 'Image goes here',
        required: true,
      },
    ],
  },
  (event, context) =&gt; {
    const imageUrl = event.values.myImage;
    // Use the mediaUrl to store in redis and display it in an <image> block, or send to external service to modify
  }
);
```</p>
<h1>HTTP fetch</h1>

<p>Make requests to allow-listed external domains.</p>

<p>Your Devvit app can make network requests to access allow-listed external domains using HTTP Fetch. This enables your app to leverage webhooks, personal servers, and other third-party integrations asynchronously across the network.</p>

<h2>Devvit configure</h2>

<p>```ts
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.configure({
  http: true,
  // other capabilities
});
```</p>

<h2>Limitations</h2>

<ul>
<li>Access is only allowed to https URIs.</li>
<li>Supported HTTP methods: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, <code>OPTIONS</code> and <code>PATCH</code>.</li>
<li>HTTP timeout limit is 30 seconds.</li>
</ul>

<p>To request a domain to the allow-list, <a href="https://www.reddit.com/message/compose/?to=r%2Fdevvit">please contact us via r/devvit modmail</a> or fill out <a href="https://forms.gle/Pn8Eq3RoPcmH1ZJJ7">this form</a>.</p>

<h2>Example</h2>

<p>```ts
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.configure({ http: true });</p>

<p>Devvit.addMenuItem({
  location: 'comment',
  label: 'Sample HTTP request',
  onPress: async (_, context) =&gt; {
    console.log(<code>Comment ID:  ${context.commentId}</code>);
    const response = await fetch('https://example.com', {
      method: 'post',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ content: context.commentId }),
    });
    context.ui.showToast(
      <code>Invoked HTTP request on comment: ${context.commentId}. Completed with status: ${response.status}</code>
    );
  },
});</p>

<p>export default Devvit;
```</p>

<h2>Troubleshooting</h2>

<p>If you see the following error, it means HTTP Fetch requests are hitting the internal timeout limits. To resolve this:</p>

<ul>
<li>Use a queue or kick off an async request in your back end. You can use <a href="/docs/capabilities/scheduler.md">Scheduler</a> to monitor the result.</li>
<li>Optimize the overall HTTP request latency if you have a self-hosted server.</li>
</ul>

<p><code>ts
HTTP request to domain: &lt;domain&gt; timed out with error: context deadline exceeded.
</code></p>

<h3>Terms and Conditions</h3>

<p>Any app that uses <code>fetch</code> must upload Terms and Conditions and a Privacy Policy. Links to each of these documents must be saved in the app details form.</p>

<p><img src="../assets/capabilities/http-fetch/http-fetch-legal-links.png" alt="App configuration form" /></p>
<h1>Image uploads</h1>

<p>Include images that are 20 MB or less in your app.</p>

<p>You can embed the image in a post or comment and use rich-text builder to format the text heading, paragraph, code block, and more. There are two ways to upload an image: using a template or starting from scratch.</p>

<h2>How to use image upoads</h2>

<p>:::note
You can copy this <a href="https://github.com/reddit/devvit/tree/main/packages/cli/src/templates/image-uploads">template</a> using image-upload.
:::</p>

<ol>
<li>From the terminal, navigate to a directory where you'd like to store your code.</li>
<li>Enter the following command to create the app.</li>
</ol>

<p><code>ts
devvit new &lt;your-app-name&gt;
</code></p>

<ol start="3">
<li>Configure <code>Devvit</code> to allow media</li>
</ol>

<p><code>ts
Devvit.configure({
  media: true,
  // other capabilities
});
</code></p>

<ol start="4">
<li>Use <code>context.media.upload()</code> to upload images/gifs to your app.</li>
</ol>

<p><code>ts
await context.media.upload({
  url: 'https://media2.giphy.com/media/xTiN0CNHgoRf1Ha7CM/giphy.gif',
  type: 'gif',
});
</code></p>

<p>You can use the code snippet below as a starting point:</p>

<p><details><summary>Code example</summary></p>

<p>```ts
import { Devvit, RichTextBuilder } from '@devvit/public-api';</p>

<p>Devvit.configure({ media: true, redditAPI: true });</p>

<p>Devvit.addMenuItem({
  location: 'comment',
  label: 'Reply with GIF',
  onPress: async (event, context) =&gt; {
    console.log(<code>Invoked action on comment ${event.targetId}</code>);
    try {
      const response = await context.media.upload({
        url: 'https://media2.giphy.com/media/xTiN0CNHgoRf1Ha7CM/giphy.gif',
        type: 'gif',
      });
      await context.reddit.submitComment({
        id: event.targetId, // where context menu action was invoked
        text: 'Hello World with Media',
        richtext: new RichTextBuilder()
          .image({ mediaId: response.mediaId })
          .codeBlock({}, (cb) =&gt; cb.rawText('This comment was created from a Devvit App')),
      });
    } catch (err) {
      throw new Error(<code>Error uploading media: ${err}</code>);
    }
  },
});</p>

<p>export default Devvit;
```</p>

<p></details></p>

<h2>Test your app</h2>

<p>Use <code>devvit upload</code> to check your app in a test subreddit.</p>
<h1>Menu actions</h1>

<p>Add an item to the three dot menu.</p>

<p>You can add custom menu actions to posts and comments using the <code>Devvit.addMenuItem()</code> function.</p>

<p>:::note
On new Reddit, comment menu actions in modqueue are only available in card view.
:::</p>

<p><img src="../assets/capabilities/menu-actions/menu-actions-subreddit.png" alt="Subreddit menu actions" /></p>

<h2>Supported Contexts</h2>

<p>You can decide where the menu action shows up by specifying the context property. For example, setting the location to ‘comment’ will only show the menu action on comments.</p>

<p>| Property               | Values                         | Description                                                                     |
| ---------------------- | ------------------------------ | ------------------------------------------------------------------------------- |
| location (required)    | <code>comment</code>, <code>post</code>, <code>subreddit</code> | Determines where the menu action appears in the custom post.                    |
| postFilter (optional)  | <code>currentApp</code>                   | Shows the action created by your app. The default is no filtering.              |
| forUserType (optional) | <code>moderator</code>                    | Specifies the user types that can see the menu action. The default is everyone. |</p>

<p>:::note
For moderator permission security, when opening a form from a menu action with <code>forUserType: moderator</code>, the user initiating the action must complete all actions within 10 minutes.
:::</p>

<h2>Limitations</h2>

<ul>
<li>A sort order of actions in the context menu can't be specified.</li>
<li>The context, name, and description fields do not support dynamic logic.</li>
</ul>

<h2>Example</h2>

<p>This example uses <code>Devvit.addMenuItem()</code> to create menu actions for comments, posts and subreddits.</p>

<p>```ts
import { Devvit } from '@devvit/public-api';</p>

<p>// Declare multiple actions to be added to the menu
Devvit.addMenuItem({
  label: 'Say Hello',
  location: 'post', // accepts 'post', 'comment', 'subreddit', or a combination as an array
  forUserType: 'moderator', // restricts this action to moderators, leave blank for any user
  onPress: (event, context) =&gt; {
    context.ui.showToast(<code>Hello from a ${event.location}!</code>);
  },
});
```</p>
<h1>Realtime</h1>

<p>Create live and event-driven interactive posts. Realtime provides a set of primitives that lets you build interactive posts that are:</p>

<ul>
<li><strong>Live</strong>. Users engaging with the same interactive post see each others’ changes without any observable lag.</li>
<li><strong>Event-driven</strong>. Posts render automatically in response to server events.</li>
<li><strong>Synced</strong>. Using realtime with <a href="/docs/capabilities/redis.md">Redis</a> lets you build persistent community experiences that are backed by high performance data synchronization.</li>
</ul>

<h2>Create a live interactive post</h2>

<h4>1. Configure realtime.</h4>

<p><code>tsx
Devvit.configure({
  realtime: true,
});
</code></p>

<h4>2. Create and subscribe to a channel.</h4>

<p><code>useChannel</code> hook allows interactive posts to subscribe and send to an event stream.</p>

<p>A new channel can be setup with function handlers containing custom logic to update state:</p>

<ul>
<li><code>onMessage</code> - called every time a message is received on a channel</li>
<li><code>onSubscribed</code> - optional hook to be informed when channel has connected</li>
<li><code>onUnsubscribed</code> - optional hook to be informed when channel has disconnected</li>
</ul>

<p>```tsx
import { Devvit, useChannel } from '@devvit/public-api';</p>

<p>// Defined within render function of an interactive post</p>

<p>// Choose a channel name that works for you</p>

<p>// You have the flexibility to define the message data shape to be published
// via channel.send - same shape will be received in the onMessage handler</p>

<p>const channel = useChannel({
  name: 'events',
  onMessage: (data) =&gt; {
    // modify local state
  },
  onSubscribed: () =&gt; {
    // handle connection setup
  },
  onUnsubscribed: () =&gt; {
    // handle network degradation with fallback scenarios
  },
});</p>

<p>// subscribe to the channel to receive messages
channel.subscribe();
```</p>

<h4>3. Send messages to a channel.</h4>

<p><code>channel.send</code> is recommended for peer-to-peer synchronization across clients. See <a href="#mini-place">Mini Place</a> and <a href="#snoo-club">Snoo Club</a></p>

<p><code>tsx
&lt;button
  icon="add-fill"
  width={50}
  onPress={async () =&gt; {
    const newProgress = Math.max(progress + 10, 0);
    const message: RealtimeMessage = {
      payload: { progress: newProgress },
      session: UUID,
    };
    setProgress(newProgress); // set local state
    await channel.send(message); // publish message to the channel
  }}
/&gt;
</code></p>

<p><code>realtime.send</code> is recommended for re-rendering interactive posts based on server events. This can be invoked on an event trigger, scheduled job, or after a HTTP fetch call. <a href="#server-push">Server-Push</a> example illustrates how to compose scheduler and realtime together.</p>

<p>```tsx
// During app installation, we create a scheduled job 'publish<em>to</em>channel' that runs
// every minute - it uses realtime plugin to publish events to an arbitrary channel</p>

<p>Devvit.addTrigger({
  event: 'AppInstall',
  onEvent: async (<em>, context) =&gt; {
    await context.scheduler.runJob({
      name: 'publish</em>to_channel',
      cron: '* * * * *',
    });
  },
});</p>

<p>// Interactive posts subscribed to the 'events' channel via useChannel hook will start
// receiving messages which can processed in the onMessage handler to update local state.
Devvit.addSchedulerJob({
  name: 'publish<em>to</em>channel',
  onRun: async (_, context) =&gt; {
    await context.realtime.send('events', {
      message: payload,
    });
  },
});
```</p>

<h2>Limits and Quotas</h2>

<ul>
<li>Messages/sec per installation: 100</li>
<li>Maximum message payload: 1 MB</li>
<li>Channels per app installation: 5</li>
</ul>

<h2>Examples</h2>

<p>:::note
Try the demos with multiple browser windows and see local changes sync across sessions without any lag.
:::</p>

<h3>Mini Place</h3>

<p><img src="../assets/realtime/mini_place_high.gif" alt="mini_place_high" /></p>

<p><strong><a href="https://sh.reddit.com/r/devvit_sandbox/comments/1bumd7e/mini_place/">Demo</a></strong>,
<strong><a href="https://github.com/reddit/devvit/tree/main/packages/apps/mini-place">Source Code</a></strong></p>

<h3>Snoo Club</h3>

<p><img src="../assets/realtime/snoo_club.gif" alt="snoo_club" /></p>

<p><strong><a href="https://sh.reddit.com/r/devvit_sandbox/comments/1bunpzv/interactive_snooclub/">Demo</a></strong>,
<strong><a href="https://github.com/reddit/devvit/tree/main/packages/apps/snooclub">Source Code</a></strong></p>

<h3>Synced Progress Bar</h3>

<p><img src="../assets/realtime/synced_progress_bar.gif" alt="synced_progress_bar" /></p>

<p><strong><a href="https://sh.reddit.com/r/devvit_sandbox/comments/1b3ccp9/synced_progress_bar/">Demo</a>,</strong>
<strong><a href="https://github.com/reddit/devvit/tree/main/packages/apps/synced-progress-bar">Source Code</a></strong></p>

<h3>Devvit Emoji Chat</h3>

<p><img src="../assets/realtime/devvit_emoji_chat.gif" alt="devvit_emoji_chat" /></p>

<p><strong><a href="https://sh.reddit.com/r/devvit_sandbox/comments/1bvf6if/emoji_chat/">Demo</a>,</strong>
<strong><a href="https://github.com/reddit/devvit/tree/main/packages/apps/devvit-emoji-chat">Source Code</a></strong></p>

<h3>Server Push</h3>

<p><img src="../assets/realtime/server_push.gif" alt="server_push" /></p>

<p><strong><a href="https://sh.reddit.com/r/devvit_sandbox/comments/1bnnc60/server_push/">Demo</a>,</strong>
<strong><a href="https://github.com/reddit/devvit/tree/main/packages/apps/server-push">Source Code</a></strong></p>
<h1>Redis</h1>

<p>You can add a database to your app to store and retrieve data. The Redis plugin is designed to be fast, scalable, and secure. It supports a subset of the full Redis API, including:</p>

<ul>
<li><a href="#transactions">Transactions</a> for things like counting votes atomically in polls</li>
<li><a href="#strings">String operations</a> for persisting information</li>
<li><a href="#numbers">Number operations</a> for incrementing numbers</li>
<li><a href="#sorted-set">Sorted sets</a> for creating leaderboards</li>
<li><a href="#hash">Hashes</a> for managing a collection of key-value pairs</li>
<li><a href="#bitfield">Bitfields</a> for efficient operation on sequences of bits</li>
</ul>

<p>Each app version installed on a subreddit is namespaced, which means Redis data is siloed from other subreddits. Keep in mind that there won’t be a single source of truth for all installations of your app, since each app installation can only access the data that it has stored in the Redis database.</p>

<h2>Limits and Quotas</h2>

<ul>
<li>Max commands per second: 1000</li>
<li>Max request size: 5 MB</li>
<li>Max storage: 500 MB</li>
</ul>

<p>All limits are applied at a per-installation granularity.</p>

<h2>Examples</h2>

<h3>Menu items</h3>

<p><code>tsx
Devvit.addMenuItem({
  location: 'subreddit',
  label: 'Test Redis',
  onPress: async (event, { redis }) =&gt; {
    const key = 'hello';
    await redis.set(key, 'world');
    const value = await redis.get(key);
    console.log(`${key}: ${value}`);
  },
});
</code></p>

<h3>Interactive posts</h3>

<p>You can copy this <a href="https://github.com/reddit/devvit/tree/main/packages/cli/src/templates/redis">template</a> to create an interactive post containing an interactive progress bar backed by Redis.</p>

<h2>Supported Redis commands</h2>

<p>:::note
Not all Redis features are supported. If you would like to request a specific Redis feature, please reach out to our team <a href="https://www.reddit.com/message/compose/?to=%2Fr%2FDevvit">via modmail</a> or Discord.
:::</p>

<h3>Simple read/write</h3>

<p>| <strong>Command</strong>                                | <strong>Action</strong>                                                            |
| ------------------------------------------ | --------------------------------------------------------------------- |
| <a href="https://redis.io/commands/get">get</a>       | Gets the value of key.                                                |
| <a href="https://redis.io/commands/set">set</a>       | Sets key to hold a string value.                                      |
| <a href="https://redis.io/commands/exists">exists</a> | Returns number of given keys that exist.                              |
| <a href="https://redis.io/commands/del">del</a>       | Removes the specified keys.                                           |
| <a href="https://redis.io/commands/type">type</a>     | Returns the string representation of the type of value stored at key. |
| <a href="https://redis.io/commands/rename">rename</a> | Renames a key.                                                        |</p>

<p><details><summary>Code Example</summary></p>

<p>```tsx
async function simpleReadWriteExample(context: Devvit.Context) {
  // Set a key
  await context.redis.set('color', 'red');</p>

<p>// Check if a key exists
  console.log('Key exists: ' + (await context.redis.exists('color')));</p>

<p>// Get a key
  console.log('Color: ' + (await context.redis.get('color')));</p>

<p>// Get the type of a key
  console.log('Type: ' + (await context.redis.type('color')));</p>

<p>// Delete a key
  await context.redis.del('color');
}
```</p>

<p><code>bash
Color: red
Type: string
</code></p>

<p></details></p>

<h3>Batch read/write</h3>

<p>| <strong>Command</strong>                            | <strong>Action</strong>                                      |
| -------------------------------------- | ----------------------------------------------- |
| <a href="https://redis.io/commands/mget">mGet</a> | Returns the values of all specified keys.       |
| <a href="https://redis.io/commands/mset">mSet</a> | Sets the given keys to their respective values. |</p>

<p><details><summary>Code Example</summary></p>

<p>```tsx
async function batchReadWriteExample(context: Devvit.Context) {
  // Set multiple keys at once
  await context.redis.mSet({
    name: 'Devvit',
    occupation: 'Developer',
    yearsOfExperience: '9000',
  });</p>

<p>// Get multiple keys
  console.log('Result: ' + (await context.redis.mGet(['name', 'occupation'])));
}
```</p>

<p><code>bash
Result: Devvit,Developer
</code></p>

<p></details></p>

<h3>Strings</h3>

<p>| <strong>Command</strong>                                    | <strong>Action</strong>                                                                                                             |
| ---------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| <a href="https://redis.io/commands/getrange">getRange</a> | Returns the substring of the string value stored at key, determined by the offsets start and end (both are inclusive). |
| <a href="https://redis.io/commands/setrange">setRange</a> | Overwrites part of the string stored at key, starting at the specified offset, for the entire length of value.         |
| <a href="https://redis.io/commands/strlen">strLen</a>     | Returns the length of the string value stored at key.                                                                  |</p>

<p><details><summary>Code Example</summary></p>

<p>```tsx
async function stringsExample(context: Devvit.Context) {
  // First, set 'word' to 'tacocat'
  await context.redis.set('word', 'tacocat');</p>

<p>// Use getRange() to get the letters in 'word' between index 0 to 3, inclusive
  console.log('Range from index 0 to 3: ' + (await context.redis.getRange('word', 0, 3)));</p>

<p>// Use setRange() to insert 'blue' at index 0
  await context.redis.setRange('word', 0, 'blue');</p>

<p>console.log('Word after using setRange(): ' + (await context.redis.get('word')));</p>

<p>// Use strLen() to verify the word length
  console.log('Word length: ' + (await context.redis.strLen('word')));
}
```</p>

<p><code>bash
Range from index 0 to 3: taco
Word after using setRange(): bluecat
Word length: 7
</code></p>

<p></details></p>

<h3>Hash</h3>

<p>Redis hashes can store up to ~ 4.2 billion key-value pairs. We recommend using hash for managing collections of key-value pairs whenever possible and iterating over it using a combination of <code>hscan</code>, <code>hkeys</code> and <code>hgetall</code>.</p>

<p>| <strong>Command</strong>                                   | <strong>Action</strong>                                                                        |
| --------------------------------------------- | --------------------------------------------------------------------------------- |
| <a href="https://redis.io/commands/hget">hGet</a>        | Returns the value associated with field in the hash stored at key.                |
| <a href="https://redis.io/commands/hmget">hMGet</a>      | Returns the value of all specified field in the hash stored at multiple keys.     |
| <a href="https://redis.io/commands/hset/">hSet</a>       | Sets the specified fields to their respective values in the hash stored at key.   |
| <a href="https://redis.io/commands/hsetnx/">hSetNX</a>   | Sets field in the hash stored at key to value, only if field does not yet exist.ƒ |
| <a href="https://redis.io/commands/hdel/">hDel</a>       | Removes the specified fields from the hash stored at key.                         |
| <a href="https://redis.io/commands/hgetall/">hGetAll</a> | Returns a map of fields and their values stored in the hash.                      |
| <a href="https://redis.io/commands/hkeys/">hKeys</a>     | Returns all field names in the hash stored at key.                                |
| <a href="https://redis.io/commands/hscan/">hScan</a>     | Iterates fields of Hash types and their associated values.                        |
| <a href="https://redis.io/commands/hincrby/">hIncrBy</a> | Increments the score of member in the sorted set stored at key by value.          |
| <a href="https://redis.io/commands/hlen/">hLen</a>       | Returns the number of fields contained in the hash stored at key.                 |</p>

<p><details><summary>Code Examples</summary></p>

<p><strong>Example 1</strong></p>

<p>```tsx
// Example using hGet(), hSet(), and hDel()
async function hashExample1(context: Devvit.Context) {
  // Set 'inventory' with multiple fields and values
  await context.redis.hSet('inventory', {
    sword: '1',
    potion: '4',
    shield: '2',
    stones: '8',
  });</p>

<p>// Get the value of 'shield' from 'inventory'
  console.log('Shield count: ' + await context.redis.hGet('inventory', 'shield'));</p>

<p>// Get the values of both of 'shield' and 'potion' from 'inventory'
  console.log('Shield and potion count: ' + await context.redis.hMGet('inventory', ['shield', 'potion']));</p>

<p>// Delete some fields from 'inventory'
  console.log(
    'Number of fields deleted: ' +
      await context.redis.hDel('inventory', ['sword', 'shield', 'stones']);
  );
}
```</p>

<p><code>bash
Shield count: 2
Shield and potion count: 2,4
Number of fields deleted: 3
</code></p>

<hr />

<p><strong>Example 2</strong></p>

<p>```tsx
// Example using hGetAll()
async function hashExample2(context: Devvit.Context) {
  // Set 'groceryList' to fields containing products with quantities
  await context.redis.hSet('groceryList', {
    eggs: '12',
    apples: '3',
    milk: '1',
  });</p>

<p>// Get the groceryList record
  const record = await context.redis.hGetAll('groceryList');</p>

<p>if (record != undefined) {
    console.log('Eggs: ' + record.eggs + ', Apples: ' + record.apples + ', Milk: ' + record.milk);
  }
}
```</p>

<p><code>bash
Eggs: 12, Apples: 3, Milk: 1
</code></p>

<hr />

<p><strong>Example 3</strong></p>

<p>```tsx
// Example using hKeys()
async function hashExample3(context: Devvit.Context) {
  await context.redis.hSet('prices', {
    chair: '48',
    desk: '95',
    whiteboard: '23',
  });</p>

<p>console.log('Keys: ' + (await context.redis.hKeys('prices')));
}
```</p>

<p><code>bash
Keys: chair,desk,whiteboard
</code></p>

<hr />

<p><strong>Example 4</strong></p>

<p>```tsx
// Example using hScan()
async function hashExample4(context: Devvit.Context) {
  await context.redis.hSet('userInfo', {
    name: 'Bob',
    startDate: '01-05-20',
    totalAwards: '12',
  });</p>

<p>// Scan and interate over all the fields within 'userInfo'
  const hScanResponse = await context.redis.hScan('userInfo', 0);</p>

<p>hScanResponse.fieldValues.forEach((x) =&gt; {
    console.log("Field: '" + x.field + "', Value: '" + x.value + "'");
  });
}
```</p>

<p><code>bash
Field: 'name', Value: 'Bob'
Field: 'totalAwards', Value: '12'
Field: 'startDate', Value: '01-05-20'
</code></p>

<hr />

<p><strong>Example 5</strong></p>

<p>```tsx
// Example using hIncrBy()
async function hashExample5(context: Devvit.Context) {
  // Set user123's karma to 100
  await context.redis.hSet('user123', { karma: '100' });</p>

<p>// Increase user123's karma by 5
  console.log('Updated karma: ' + (await context.redis.hIncrBy('user123', 'karma', 5)));
}
```</p>

<p><code>bash
Updated karma: 105
</code></p>

<hr />

<p><strong>Example 6</strong></p>

<p>```tsx
// Example using hLen()
async function hashExample6(context: Devvit.Context) {
  await context.redis.hSet('supplies', {
    paperclips: '25',
    pencils: '10',
    erasers: '5',
    pens: '7',
  });</p>

<p>console.log('Number of fields: ' + (await context.redis.hLen('supplies')));
}
```</p>

<p><code>bash
Number of fields: 4
</code></p>

<p></details></p>

<h3>Numbers</h3>

<p>| <strong>Command</strong>                                | <strong>Action</strong>                                        |
| ------------------------------------------ | ------------------------------------------------- |
| <a href="https://redis.io/commands/incrby">incrBy</a> | Increments the number stored at key by increment. |</p>

<p><details><summary>Code Example</summary></p>

<p>```tsx
async function numbersExample(context: Devvit.Context) {
  await context.redis.set('totalPoints', '53');</p>

<p>console.log('Updated points: ' + (await context.redis.incrBy('totalPoints', 100)));
}
```</p>

<p><code>bash
Updated points: 153
</code></p>

<p></details></p>

<h3>Key expiration</h3>

<p>| <strong>Command</strong>                                         | <strong>Action</strong>                                                        |
| --------------------------------------------------- | ----------------------------------------------------------------- |
| <a href="https://redis.io/commands/expire/">expire</a>         | Sets a timeout on key.                                            |
| <a href="https://redis.io/commands/expiretime/">expireTime</a> | Returns the remaining seconds at which the given key will expire. |</p>

<p><details><summary>Code Example</summary></p>

<p>```tsx
async function keyExpirationExample(context: Devvit.Context) {
  // Set a key 'product' with value 'milk'
  await context.redis.set('product', 'milk');</p>

<p>// Get the current expireTime for the product
  console.log('Expire time: ' + (await context.redis.expireTime('product')));</p>

<p>// Set the product to expire in 60 seconds
  await context.redis.expire('product', 60);</p>

<p>// Get the updated expireTime for the product
  console.log('Updated expire time: ' + (await context.redis.expireTime('product')));
}
```</p>

<p><code>bash
Expire time: 0
Updated expire time: 60
</code></p>

<p></details></p>

<h3><a href="https://redis.io/topics/transactions">Transactions</a></h3>

<p>Redis transactions allow a group of commands to be executed in a single isolated step. For example, to implement voting action in a polls app, these three actions need to happen together:</p>

<ul>
<li>Store the selected option for the user.</li>
<li>Increment the count for selected option.</li>
<li>Add the user to voted user list.</li>
</ul>

<p>The <code>watch</code> command provides an entrypoint for transactions. It returns a <a href="https://developers.reddit.com/docs/api/public-api/#-txclientlike">TxClientLike</a> which can be used to call <code>multi</code>, <code>exec</code>, <code>discard</code>, <code>unwatch</code>, and all other Redis commands to be executed within a transaction.</p>

<p>You can sequence all of the above steps in a single transaction using <code>multi</code> and <code>exec</code> to ensure that either all of the steps happen together or none at all.</p>

<p>If an error occurs inside a transaction before <code>exec</code> is called, Redis discards the transaction automatically. See the Redis docs: <a href="https://redis.io/docs/latest/develop/interact/transactions/#errors-inside-a-transaction">Errors inside a transaction</a> for more info.</p>

<p>| <strong>Command</strong>                                   | <strong>Action</strong>                                                                                                                                                                                                                                      |
| --------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <a href="https://redis.io/commands/multi/">multi</a>     | Marks the start of a transaction block.                                                                                                                                                                                                         |
| <a href="https://redis.io/commands/exec/">exec</a>       | Executes all previously queued commands in a transaction and restores the connection state to normal.                                                                                                                                           |
| <a href="https://redis.io/commands/discard/">discard</a> | Flushes all previously queued commands in a transaction and restores the connection state to normal.                                                                                                                                            |
| <a href="https://redis.io/commands/watch/">watch</a>     | Marks the given keys to be watched for conditional execution of a transaction. <code>watch</code> returns a <a href="https://developers.reddit.com/docs/api/public-api/#-txclientlike">TxClientLike</a> which should be used to call Redis commands in a transaction. |
| <a href="https://redis.io/commands/unwatch/">unwatch</a> | Flushes all the previously watched keys for a transaction.                                                                                                                                                                                      |</p>

<p><details><summary>Code Examples</summary></p>

<p><strong>Example 1</strong></p>

<p>```tsx
// Example using exec()
async function transactionsExample1(context: Devvit.Context) {
  await context.redis.mSet({ quantity: '5', karma: '32' });</p>

<p>const txn = await context.redis.watch('quantity');</p>

<p>await txn.multi(); // Begin a transaction
  await txn.incrBy('karma', 10);
  await txn.set('name', 'Devvit');
  await txn.exec(); // Execute the commands in the transaction</p>

<p>console.log(
    'Keys after completing transaction: ' +
      (await context.redis.mGet(['quantity', 'karma', 'name']))
  );
}
```</p>

<p><code>bash
Keys after completing transaction: 5,42,Devvit
</code></p>

<hr />

<p><strong>Example 2</strong></p>

<p>```tsx
// Example using discard()
async function transactionsExample2(context: Devvit.Context) {
  await context.redis.set('price', '25');</p>

<p>const txn = await context.redis.watch('price');</p>

<p>await txn.multi(); // Begin a transaction
  await txn.incrBy('price', 5);
  await txn.discard(); // Discard the commands in the transaction</p>

<p>console.log('Price value: ' + (await context.redis.get('price'))); // 'price' should still be '25'
}
```</p>

<p><code>bash
Price value: 25
</code></p>

<hr />

<p><strong>Example 3</strong></p>

<p>```tsx
// Example using unwatch()
async function transactionsExample3(context: Devvit.Context) {
  await context.redis.set('gold', '50');</p>

<p>const txn = await context.redis.watch('gold');</p>

<p>await txn.multi(); // Begin a transaction
  await txn.incrBy('gold', 30);
  await txn.unwatch(); // Unwatch "gold"</p>

<p>// Now that "gold" has been unwatched, we can increment its value
  // outside the transaction without canceling the transaction
  await context.redis.incrBy('gold', -20);</p>

<p>await txn.exec(); // Execute the commands in the transaction</p>

<p>console.log('Gold value: ' + (await context.redis.get('gold'))); // The value of 'gold' should be 50 + 30 - 20 = 60
}
```</p>

<p><code>bash
Gold value: 60
</code></p>

<p></details></p>

<h3>Sorted set</h3>

<p>| <strong>Command</strong>                                                     | <strong>Action</strong>                                                                                                                                                                                                                                                      |
| --------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <a href="https://redis.io/commands/zadd/">zAdd</a>                         | Adds all the specified members with the specified scores to the sorted set stored at key.                                                                                                                                                                       |
| <a href="https://redis.io/commands/zcard">zCard</a>                        | Returns the sorted set cardinality (number of elements) of the sorted set stored at key.                                                                                                                                                                        |
| <a href="https://redis.io/commands/zrange/">zRange</a>                     | Returns the specified range of elements in the sorted set stored at key. <br><br> When using <code>by: 'lex'</code>, the start and stop inputs will be prepended with <code>[</code> by default, unless they already begin with <code>[</code>, <code>(</code> or are one of the special values <code>+</code> or <code>-</code>. |
| <a href="https://redis.io/commands/zrem/">zRem</a>                         | Removes the specified members from the sorted set stored at key.                                                                                                                                                                                                |
| <a href="https://redis.io/commands/zscore/">zScore</a>                     | Returns the score of member in the sorted set at key.                                                                                                                                                                                                           |
| <a href="https://redis.io/commands/zrank/">zRank</a>                       | Returns the rank of member in the sorted set stored at key.                                                                                                                                                                                                     |
| <a href="https://redis.io/commands/zincrby/">zIncrBy</a>                   | Increments the score of member in the sorted set stored at key by value.                                                                                                                                                                                        |
| <a href="https://redis.io/commands/zscan/">zScan</a>                       | Iterates elements of sorted set types and their associated scores. Note that there is no guaranteed ordering of elements in the result.                                                                                                                         |
| <a href="https://redis.io/commands/zremrangebylex/">zRemRangeByLex</a>     | When all elements in a sorted set are inserted with the same score, this command removes the elements at key between the lexicographical range specified by min and max.                                                                                        |
| <a href="https://redis.io/commands/zremrangebyrank/">zRemRangeByRank</a>   | Removes all elements in the sorted set stored at key with rank between start and stop.                                                                                                                                                                          |
| <a href="https://redis.io/commands/zremrangebyscore/">zRemRangeByScore</a> | Removes all elements in the sorted set stored at key with a score between min and max (inclusive).                                                                                                                                                              |</p>

<p><details><summary>Code Examples</summary></p>

<p><strong>Example 1</strong></p>

<p>```tsx
// Example using zRange() with by 'score'
async function sortedSetExample1(context: Devvit.Context) {
  await context.redis.zAdd(
    'leaderboard',
    { member: 'louis', score: 37 },
    { member: 'fernando', score: 10 },
    { member: 'caesar', score: 20 },
    { member: 'alexander', score: 25 }
  );</p>

<p>// Cardinality should be '4' as there are 4 elements in the leaderboard set
  console.log('Cardinality: ' + (await context.redis.zCard('leaderboard')));</p>

<p>// View elements with scores between 0 and 30 inclusive, sorted by score
  let scores = await context.redis.zRange('leaderboard', 0, 30, { by: 'score' });
  console.log('Scores: ' + JSON.stringify(scores));</p>

<p>// Remove 'fernando' from the leaderboard
  await context.redis.zRem('leaderboard', ['fernando']);</p>

<p>// View the elements sorted by score again. This time 'fernando' should not appear in the output
  scores = await context.redis.zRange('leaderboard', 0, 30, { by: 'score' });
  console.log('Updated scores: ' + JSON.stringify(scores));</p>

<p>// View caesar's score
  console.log("Caesar's score: " + (await context.redis.zScore('leaderboard', 'caesar')));
}
```</p>

<p><code>bash
Cardinality: 4
Scores: [{"score":10,"member":"fernando"},{"score":20,"member":"caesar"},{"score":25,"member":"alexander"}]
Updated scores: [{"score":20,"member":"caesar"},{"score":25,"member":"alexander"}]
Caesar's score: 20
</code></p>

<hr />

<p><strong>Example 2</strong></p>

<p>```tsx
// Example using zRange() with by 'lex'
async function sortedSetExample2(context: Devvit.Context) {
  await context.redis.zAdd(
    'checkpoints',
    { member: 'delta', score: 0 },
    { member: 'omega', score: 0 },
    { member: 'alpha', score: 0 },
    { member: 'charlie', score: 0 }
  );</p>

<p>// View elements between the words 'alpha' and 'fox' inclusive, sorted lexicographically
  // Note that 'by: "lex"' only works if all elements have the same score
  const members = await context.redis.zRange('checkpoints', 'alpha', 'fox', { by: 'lex' });
  console.log('Members: ' + JSON.stringify(members));
}
```</p>

<p><code>bash
Members: [{"score":0,"member":"alpha"},{"score":0,"member":"charlie"},{"score":0,"member":"delta"}]
</code></p>

<hr />

<p><strong>Example 3</strong></p>

<p>```tsx
// Example using zRange() with by 'rank'
async function sortedSetExample3(context: Devvit.Context) {
  await context.redis.zAdd(
    'grades',
    { member: 'sam', score: 80 },
    { member: 'norma', score: 95 },
    { member: 'alex', score: 77 },
    { member: 'don', score: 84 },
    { member: 'zeek', score: 92 }
  );</p>

<p>// View elements with a rank between 2 and 4 inclusive. Note that ranks start at index 0.
  const members = await context.redis.zRange('grades', 2, 4, { by: 'rank' });
  console.log('Members: ' + JSON.stringify(members));
}
```</p>

<p><code>bash
Members: [{"score":84,"member":"don"},{"score":92,"member":"zeek"},{"score":95,"member":"norma"}]
</code></p>

<hr />

<p><strong>Example 4</strong></p>

<p>```tsx
// Example using zRank() and zIncrBy()
async function sortedSetExample4(context: Devvit.Context) {
  await context.redis.zAdd(
    'animals',
    { member: 'zebra', score: 92 },
    { member: 'cat', score: 100 },
    { member: 'dog', score: 95 },
    { member: 'elephant', score: 97 }
  );</p>

<p>// View the rank of 'dog' in the animals set
  // Rank should be '1' since 'dog' has the second lowest score. Note that ranks start at index 0.
  console.log("Dog's rank: " + (await context.redis.zRank('animals', 'dog')));</p>

<p>// View the rank of 'zebra'
  console.log("Zebra's rank: " + (await context.redis.zRank('animals', 'zebra')));</p>

<p>// Increase the score of 'dog' by 10
  await context.redis.zIncrBy('animals', 'dog', 10);</p>

<p>// View the rank of 'dog' again. This time it should be '3' because dog has the highest score.
  console.log(
    "Dog's rank after incrementing score: " + (await context.redis.zRank('animals', 'dog'))
  );
}
```</p>

<p><code>bash
Dog's rank: 1
Zebra's rank: 0
Dog's rank after incrementing score: 3
</code></p>

<hr />

<p><strong>Example 5</strong></p>

<p>```tsx
// Example using zRemRangeByLex()
async function sortedSetExample5(context: Devvit.Context) {
  await context.redis.zAdd(
    'fruits',
    { member: 'kiwi', score: 0 },
    { member: 'mango', score: 0 },
    { member: 'banana', score: 0 },
    { member: 'orange', score: 0 },
    { member: 'apple', score: 0 }
  );</p>

<p>// Remove fruits alphabetically ordered between 'kiwi' inclusive and 'orange' exclusive
  // Note: The symbols '[' and '(' indicate inclusive or exclusive, respectively. These must be included in the call to zRemRangeByLex().
  await context.redis.zRemRangeByLex('fruits', '[kiwi', '(orange');</p>

<p>// Only 'apple', 'banana', and 'orange' should remain in the set
  const zScanResponse = await context.redis.zScan('fruits', 0);
  console.log('zScanResponse: ' + JSON.stringify(zScanResponse));
}
```</p>

<p><code>bash
zScanResponse: {"cursor":0,"members":[{"score":0,"member":"apple"},{"score":0,"member":"banana"},{"score":0,"member":"orange"}]}
</code></p>

<hr />

<p><strong>Example 6</strong></p>

<p>```tsx
// Example using zRemRangeByRank()
async function sortedSetExample6(context: Devvit.Context) {
  await context.redis.zAdd(
    'fruits',
    { member: 'kiwi', score: 10 },
    { member: 'mango', score: 20 },
    { member: 'banana', score: 30 },
    { member: 'orange', score: 40 },
    { member: 'apple', score: 50 }
  );</p>

<p>// Remove fruits ranked 1 through 3 inclusive
  await context.redis.zRemRangeByRank('fruits', 1, 3);</p>

<p>// Only 'kiwi' and 'apple' should remain in the set
  const zScanResponse = await context.redis.zScan('fruits', 0);
  console.log('zScanResponse: ' + JSON.stringify(zScanResponse));
}
```</p>

<p><code>bash
zScanResponse: {"cursor":0,"members":[{"score":10,"member":"kiwi"},{"score":50,"member":"apple"}]}
</code></p>

<hr />

<p><strong>Example 7</strong></p>

<p>```tsx
// Example using zRemRangeByScore() example
async function sortedSetExample7(context: Devvit.Context) {
  await context.redis.zAdd(
    'fruits',
    { member: 'kiwi', score: 10 },
    { member: 'mango', score: 20 },
    { member: 'banana', score: 30 },
    { member: 'orange', score: 40 },
    { member: 'apple', score: 50 }
  );</p>

<p>// Remove fruits scored between 30 and 50 inclusive
  await context.redis.zRemRangeByScore('fruits', 30, 50);</p>

<p>// Only 'kiwi' and 'mango' should remain in the set
  const zScanResponse = await context.redis.zScan('fruits', 0);
  console.log('zScanResponse: ' + JSON.stringify(zScanResponse));
}
```</p>

<p><code>bash
zScanResponse: {"cursor":0,"members":[{"score":10,"member":"kiwi"},{"score":20,"member":"mango"}]}
</code></p>

<p></details></p>

<h3>Bitfield</h3>

<p>| <strong>Command</strong>                                                 | <strong>Action</strong>                                        |
| ----------------------------------------------------------- | ------------------------------------------------- |
| <a href="https://redis.io/docs/latest/commands/bitfield/">bitfield</a> | Performs a sequence of operations on a bit string |</p>

<p><details><summary>Code Example</summary></p>

<p>```tsx
async function bitfieldExample(context: Devvit.Context) {
  const setBits: number[] = await context.redis.bitfield('foo', 'set', 'i5', '#0', 11);
  console.log('Set result: ' + setBits); // [0]</p>

<p>const getBits: number[] = await context.redis.bitfield('foo', 'get', 'i5', '#0');
  console.log('Get result: ' + setBits); // [11]</p>

<p>const manyOperations: number[] = await context.redis.bitfield(
    'bar',
    'set',
    'u2',
    0,
    3,
    'get',
    'u2',
    0,
    'incrBy',
    'u2',
    0,
    1,
    'overflow',
    'sat',
    'get',
    'u2',
    0,
    'set',
    'u2',
    0,
    3,
    'incrBy',
    'u2',
    0,
    1
  );
  console.log('Results of many operations: ' + manyOperations); // [0, 3, 0, 0, 3, 3]
}
```</p>

<p><code>bash
fooResults: [1, 0]
barResults: [0, 3, 0, 0, 3, 3]
</code></p>

<p></details></p>
<h1>Scheduler</h1>

<p>Store and execute future actions.</p>

<p>Use the scheduler to do things like send a private message at a specified time, track upvotes, or schedule time-outs for user actions.</p>

<h2>Create a job</h2>

<p>Create a job definition using <code>Devvit.addSchedulerJob</code> method.</p>

<p><code>ts
Devvit.addSchedulerJob({
  name: 'thing-todo', // you can use an arbitrary name here
  onRun: async (event, context) =&gt; {
    // do stuff when the job is executed
  },
});
</code></p>

<h2>Schedule the job</h2>

<p>Use the <code>context.scheduler.runJob()</code> method to schedule the job you created. You can schedule the job to run once at at a particular time in the future or schedule it to be called repeatedly at a specific time.</p>

<ul>
<li>To schedule the job to run once, use the <code>runAt</code> parameter:</li>
</ul>

<p><code>ts
Devvit.addMenuItem({
  label: 'Remind me about this post',
  location: 'post',
  onPress: async (event, context) =&gt; {
    const jobId = await context.scheduler.runJob({
      name: 'thing-todo', // the name of the job that we specified in addSchedulerJob() above
      runAt: new Date('2099-01-01'),
    });
  },
});
</code></p>

<p>Optionally, you can save the <code>jobId</code> in <a href="./redis.md">Redis storage</a> to be able to <a href="#cancel-an-action">cancel the scheduled action</a> in the future.</p>

<p><code>ts
await context.redis.set('thing-todo:jobId', jobId);
</code></p>

<ul>
<li>To schedule a recurring action, use a <code>cron</code> parameter:</li>
</ul>

<p>:::note
<code>scheduler.runJob()</code> uses the same format that is used in UNIX <code>cron</code>, a command-line utility is a job scheduler on Unix-like operating systems https://en.wikipedia.org/wiki/Cron</p>

<p>```</p>

<h1>* * * * *</h1>

<h1>| | | | |</h1>

<h1>| | | | day of the week (0–6) Sunday to Saturday; 7 is also Sunday on some systems</h1>

<h1>| | | month (1–12)</h1>

<h1>| | day of the month (1–31)</h1>

<h1>| hour (0–23)</h1>

<h1>minute (0–59)</h1>

<p>```</p>

<p>:::</p>

<p><code>ts
Devvit.addMenuItem({
  label: 'Run every day',
  location: 'post',
  onPress: async (event, context) =&gt; {
    const jobId = await context.scheduler.runJob({
      name: 'thing-todo',
      cron: '0 12 * * *',
    });
  },
});
</code></p>

<p>:::note
We recommend using <a href="https://crontab.guru/">Cronitor</a> to build out strings.
:::</p>

<h2>Cancel an action</h2>

<p>Use the job ID to cancel a scheduled action and remove it from your app.</p>

<p>```ts
Devvit.addMenuItem({
  label: 'clear',
  location: 'post',
  forUserType: 'moderator',
  onPress: async (_, context) =&gt; {
    const jobId = (await context.redis.get('jobId')) || '0';
    await context.scheduler.cancelJob(jobId);
  },
});</p>

<p>export default Devvit;
```</p>

<h2>Examples</h2>

<h3>Schedule a one-off action</h3>

<p>You can schedule an action to run once at a specific time, like sending a private message in the <a href="/docs/showcase/tutorials/remind_me.md">Remind Me</a> tutorial.</p>

<p>```ts
import { Devvit } from '@devvit/public-api';</p>

<p>const REMIND<em>ME</em>ACTION_NAME = 'remindme';</p>

<p>Devvit.addSchedulerJob({
  name: REMIND<em>ME</em>ACTION_NAME,
  onRun: async (event, context) =&gt; {
    const { userId, postId, fromWhen } = event.data!;</p>

<pre><code>const user = await context.reddit.getUserById(userId);
const post = await context.reddit.getPostById(postId);

// Send a private message to the user
await context.reddit.sendPrivateMessage({
  to: user.username,
  subject: 'RemindMe',
  text: `Beep boop! You asked me to remind you about [${post.title}](${post.permalink}) at ${fromWhen}!`,
});
</code></pre>

<p>},
});</p>

<p>Devvit.addMenuItem({
  label: 'Remind me about this post',
  location: 'post',
  onPress: async (event, context) =&gt; {
    // Code below could also be run from another capability, like an event trigger or another scheduled job
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);</p>

<pre><code>await context.scheduler.runJob({
  name: REMIND_ME_ACTION_NAME,
  data: {
    userId: context.userId!,
    postId: `t3_${context.postId}`,
  },
  runAt: tomorrow,
});
</code></pre>

<p>},
});</p>

<p>export default Devvit;
```</p>

<h3>Schedule a recurring action</h3>

<p>You can schedule an action that repeats at a specific time. This sample code creates a recurring action to post a new daily thread every day at 12:00 UTC. In this example, the recurring action is initiated when the app is installed, but you can also schedule a recurring action from a menu action instead.</p>

<p>```ts
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.addSchedulerJob({
  name: 'daily<em>thread',
  onRun: async (</em>, context) =&gt; {
    console.log('daily_thread handler called');
    const subreddit = await context.reddit.getCurrentSubreddit();
    const resp = await context.reddit.submitPost({
      subredditName: subreddit.name,
      title: 'Daily Thread',
      text: 'This is a daily thread, comment here!',
    });
    console.log('posted resp', JSON.stringify(resp));
  },
});</p>

<p>Devvit.addTrigger({
  event: 'AppInstall',
  onEvent: async (<em>, context) =&gt; {
    try {
      const jobId = await context.scheduler.runJob({
        cron: '0 12 * * *',
        name: 'daily</em>thread',
        data: {},
      });
      await context.redis.set('jobId', jobId);
    } catch (e) {
      console.log('error was not able to schedule:', e);
      throw e;
    }
  },
});</p>

<p>export default Devvit;
```</p>

<p>:::note
We recommend using <a href="https://crontab.guru/">Cronitor</a> to build out strings.
:::</p>

<h2>Faster scheduler</h2>

<p>:::note
This feature is experimental, which means the design is not final but it's still available for you to use.
:::</p>

<p>Scheduled jobs currently perform one scheduled run per minute. To go faster, you can now run jobs every second by adding seconds granularity to your cron expression.</p>

<p><code>tsx
await scheduler.runJob({
  name: 'run_every_30_seconds',
  cron: '*/30 * * * * *',
});
</code></p>

<p>How frequent a scheduled job runs will depend on how long the job takes to complete and how many jobs are running in parallel. This means a job may take a bit longer than scheduled, but the overall resolution should be better than a minute.</p>

<h2>Limitations</h2>

<p><em>Limits are per installation of an app</em></p>

<ol>
<li><p>An installation can have up to 10 live recurring actions.</p></li>
<li><p>There are two rate limits enforced by the <code>runJob()</code> method when actions are created:</p>

<ul>
<li>Creation rate: up to 60 calls to <code>runJob()</code> per minute</li>
<li>Delivery rate: up to 60 deliveries per minute</li>
</ul></li>
</ol>
<h1>Secrets storage</h1>

<p>Store sensitive data in your app.</p>

<p>There are times when you’ll want to store information in your app that should not be visible to users. Secrets are variables that contain sensitive information like API keys, credentials and tokens. Devvit lets you store and access secrets in three steps:</p>

<ol>
<li>Define secrets in the app.</li>
<li>Provide secrets via Devvit CLI.</li>
<li>Retrieve secrets in the app.</li>
</ol>

<h2>Defining secrets</h2>

<p>You can use the existing <code>Devvit.addSettings</code> DX to define secrets.</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.addSettings([
  {
    // Name of the setting which is used to retrieve the setting value
    name: 'open-ai-api-key',
    // This label is used to provide more information in the CLI
    label: 'Open AI API key',
    // Type of the setting value
    type: 'string',
    // Marks a setting as sensitive info - all secrets are encrypted
    isSecret: true,
    // Defines the access scope
    // app-scope ensures only developers can create/replace secrets via CLI
    scope: 'app',
  },
]);
```</p>

<h2>Providing secrets</h2>

<p>You will be able to list app-scoped keys via the CLI. Use the <code>devvit settings</code> command in a Devvit project.</p>

<p>```bash
devvit settings list</p>

<p>Key               Label            Is this a secret?   Type
───────────────  ──────────────    ─────────────────   ──────
open-ai-api-key  Open AI API key    true            STRING
```</p>

<p>Once you access the keys, you can assign values to the secret keys. This operation can only be performed by app developers, not mods or installers.</p>

<p>```bash
devvit settings set open-ai-api-key</p>

<p>? Enter the value you would like to assign to the variable open-ai-api-key : <value></p>

<p>Updating app settings... ✅
Successfully added app settings for open-ai-api-key!
```</p>

<h2>Retrieving secrets</h2>

<p>Once you’ve stored the secrets via CLI, your app can access the secrets during invocations using <code>context.settings.get(secretName)</code> method.</p>

<p><details><summary>Code Example</summary></p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>Devvit.configure({
  http: true,
});</p>

<p>Devvit.addSettings([
  {
    name: 'open-ai-api-key',
    label: 'Open AI API key',
    type: 'string',
    isSecret: true,
    scope: 'app',
  },
]);</p>

<p>async function fetchResponse(context: Devvit.Context): Promise<string> {
  try {
    const apiKey = await context.settings.get('open-ai-api-key');</p>

<pre><code>const res = await fetch('https://api.openai.com/v1/chat/completions', {
  headers: {
    'Content-Type': 'application/json',
    Authorization: `Bearer ${apiKey}`,
  },
  method: 'POST',
  body: JSON.stringify({
    model: 'gpt-4-turbo',
    messages: [{ role: 'system', content: 'You are a helpful assistant.' }],
  }),
});

const json = await res.json();

return json?.choices?.length &gt; 0 ? json?.choices[0]?.message?.content : 'No response';
</code></pre>

<p>} catch (e: any) {
    console.log('Fetch error ', e);
    return e.toString();
  }
}</p>

<p>Devvit.addCustomPostType({
  name: 'Devvit - Ask GPT',
  render: (context) =&gt; {
    const [answer, setAnswer] = useState<string>('');</p>

<pre><code>async function onPress() {
  const response = await fetchResponse(context);
  setAnswer(response || 'No Response');
}

return (
  &lt;blocks height="tall"&gt;
    &lt;vstack alignment="center middle" height="100%" gap="large"&gt;
      &lt;button appearance="primary" onPress={onPress}&gt;
        {'Ask GPT'}
      &lt;/button&gt;
      &lt;text wrap&gt;{answer}&lt;/text&gt;
    &lt;/vstack&gt;
  &lt;/blocks&gt;
);
</code></pre>

<p>},
});</p>

<p>export default Devvit;
```</p>

<p></details></p>

<h2>Limitations</h2>

<ul>
<li>At least one app installation is required before you can store secrets via the CLI. You can use Devvit <a href="/docs/get-started/playtest.md">playtest</a> once with the latest <code>Devvit.addSettings</code> config to accomplish this.</li>
<li>App setting values are currently not surfaced in the CLI.</li>
</ul>
<h1>Server-side functions</h1>

<p>Devvit apps that create interactive posts generally run on the client side, which exposes code to users and clients for performance purposes. However, there are scenarios where you might want to keep certain parts of your codebase private—such as proprietary algorithms, sensitive data handling, or secure operations. Server-side functions allow you to store server-side code that remains hidden from clients.</p>

<h2>How it works</h2>

<p>To add server-side code to your app, structure your project in one of the following ways:</p>

<p>Create a server folder for server-side code in your project directory: <code>&lt;project-directory&gt;/server/yourCode.ts</code></p>

<p>Add .server. to your filename to indicate that it contains server-side code: <code>&lt;project-directory&gt;/yourModule.server.ts</code></p>

<p>Any functions or modules imported from these server-side files will be executed on the server and keep implementation details hidden from the client.</p>

<p>Example:</p>

<p>Project Structure:</p>

<ul>
<li>project-directory/
<ul>
<li>index.tsx</li>
<li>server/
<ul>
<li>randomNumber.ts</li>
</ul></li>
</ul></li>
</ul>

<p>Client-side Code (index.tsx):</p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';
import { getRandomNumber } from './server/randomNumber.js;</p>

<p>Devvit.configure({
  http: true,
});</p>

<p>Devvit.addCustomPostType({
  name: 'Random Number Generator',
  render: () =&gt; {
    const [number, setNumber] = useState<number | null>(null);</p>

<pre><code>async function fetchRandomNumber() {
  const result = await getRandomNumber();
  setNumber(result);
}

return (
  &lt;blocks&gt;
    &lt;vstack alignment="center middle" gap="medium"&gt;
      &lt;button appearance="primary" onPress={fetchRandomNumber}&gt;
        Generate Random Number
      &lt;/button&gt;
      {number !== null &amp;&amp; &lt;text&gt;Your number: {number}&lt;/text&gt;}
    &lt;/vstack&gt;
  &lt;/blocks&gt;
);
</code></pre>

<p>},
});</p>

<p>export default Devvit;
```</p>

<p>Server-side Code (server/randomNumber.ts):</p>

<p><code>tsx
export async function getRandomNumber(): Promise&lt;number&gt; {
  return Math.floor(Math.random() * 100) + 1;
}
</code></p>

<h2>Limitations</h2>

<p>Server-side functions may add performance overhead by introducing network latency. You’ll want to minimize unnecessary server interactions to keep your app responsive. For high-traffic apps, avoid making server calls during the first render unless necessary and leverage useAsync to perform server side calls without blocking the render process.</p>
<h1>Triggers</h1>

<p>Build automatic actions into your app.</p>

<p>A trigger is an action you can build into your app that will occur automatically when the trigger condition is met.</p>

<h2>Event triggers</h2>

<p>Event triggers let your app automatically respond to a user’s action. For example, if you set the PostSubmit trigger, the app will automatically respond when a new post is made in the community. These triggers types are supported:</p>

<ul>
<li><code>PostSubmit</code></li>
<li><code>PostCreate</code></li>
<li><code>PostUpdate</code></li>
<li><code>PostReport</code></li>
<li><code>PostDelete</code></li>
<li><code>PostFlairUpdate</code></li>
<li><code>CommentCreate</code></li>
<li><code>CommentDelete</code></li>
<li><code>CommentReport</code></li>
<li><code>CommentSubmit</code></li>
<li><code>CommentUpdate</code></li>
<li><a href="#nsfw-example"><code>PostNsfwUpdate</code></a></li>
<li><a href="#spoiler-example"><code>PostSpoilerUpdate</code></a></li>
<li><a href="#setup-triggers"><code>AppInstall</code></a></li>
<li><a href="#setup-triggers"><code>AppUpgrade</code></a></li>
<li><a href="#mod-actions"><code>ModActions</code></a></li>
<li><a href="#modmail-trigger"><code>ModMail</code></a></li>
<li><a href="#automoderator-triggers"><code>AutomoderatorFilterPost</code></a></li>
<li><a href="#automoderator-triggers"><code>AutomoderatorFilterComment</code></a></li>
</ul>

<p>This example adds event triggers that will automatically execute your app. Once a trigger is added, your app listens for the event and the event handler executes the action.</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>// Handling a PostSubmit event
Devvit.addTrigger({
  event: 'PostSubmit', // Event name from above
  onEvent: async (event) =&gt; {
    console.log(<code>Received OnPostSubmit event:\n${JSON.stringify(event)}</code>);
  },
});</p>

<p>// Handling multiple events: PostUpdate and PostReport
Devvit.addTrigger({
  events: ['PostUpdate', 'PostReport'], // An array of events
  onEvent: async (event) =&gt; {
    if (event.type == 'PostUpdate') {
      console.log(<code>Received OnPostUpdate event:\n${JSON.stringify(request)}</code>);
    } else if (event.type === 'PostReport') {
      console.log(<code>Received OnPostReport event:\n${JSON.stringify(request)}</code>);
    }
  },
});</p>

<p>export default Devvit;
```</p>

<p>:::note</p>

<p>Be careful when creating recursive triggers (like a comment trigger that creates a comment). This could cause your app to crash. To avoid this, check to see if the content creator is the app.</p>

<p>:::</p>

<h2>Setup triggers</h2>

<p>Setup triggers allow your app to automatically respond when a user is installing or configuring that app.
These triggers are supported:</p>

<ul>
<li><code>AppInstall</code></li>
<li><code>AppUpgrade</code></li>
</ul>

<h2>Mod triggers</h2>

<h3>Modmail trigger</h3>

<p><code>ts
event: 'ModMail',
</code></p>

<p>This alerts the mod when modmail is sent or received. This example enables the app to listen to modmail events and fetch the relevant message payload via the Reddit API wrapper.</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.configure({ redditAPI: true });</p>

<p>Devvit.addTrigger({
  event: 'ModMail',
  onEvent: async (event, context) =&gt; {
    // Apps receive this event when:
    // 1. A new modmail conversation thread is created
    // 2. A new modmail message is added to an existing conversation
    console.log(<code>Received modmail trigger event:\n${JSON.stringify(event)}</code>);</p>

<pre><code>// Example conversation ID: ModmailConversation_1mzkfh
// We are fetching the latest conversation state from Reddit API
const conversationId = event.conversationId;
const result = await context.reddit.modMail.getConversation({
  conversationId: conversationId,
  markRead: false,
});
console.log(`Received conversation with subject:   ${result.conversation?.subject}`);

// Looking up the incoming message from trigger event
// Example Message ID: ModmailMessage_2ch154
const messageId = event.messageId.split('_')[1];
const message = result.messages[messageId];
console.log(`Received modmail message: ${JSON.stringify(message)}`);
</code></pre>

<p>},
});</p>

<p>export default Devvit;
```</p>

<h3>NSFW and spoiler triggers</h3>

<p>These are triggered when a mod or automod marks a post as NSFW or a spoiler.</p>

<p>:::note
NSFW and spoiler triggers only work for user posts that a moderator flags. Moderators cannot trigger a label for their own posts.
:::</p>

<h4>NSFW example</h4>

<p><code>tsx
Devvit.addTrigger({
  event: 'PostNsfwUpdate',
  onEvent: async (event, context) =&gt; {
    // App received this event when:
    // 1. moderator changes a non-moderator post to nsfw
    // 2. automoderator changes post from nsfw to sfw
    console.log(`Received nsfw trigger event:\n${JSON.stringify(event)}`);
    if (event.isNsfw) {
      console.log(`This is event ${JSON.stringify(event)} changed to nsfw`);
    } else {
      console.log(`This is event ${JSON.stringify(event)} changed to non-nsfw`);
    }
  },
});
</code></p>

<h4>Spoiler example</h4>

<p>```tsx
Devvit.addTrigger({
  event: 'PostSpoilerUpdate',
  onEvent: async (event, context) =&gt; {
    // App received this event when:
    // 1. moderator changes a non-moderator post to spoiler
    // 2. moderator changes post from spoiler to non-spoiler</p>

<pre><code>console.log(`Received spoiler trigger event:\n${JSON.stringify(event)}`);
if (event.isSpoiler) {
  console.log(`This is event ${JSON.stringify(event)} changed to spoiler`);
} else {
  console.log(`This is event ${JSON.stringify(event)} changed to non-spoiler`);
}
</code></pre>

<p>},
});
```</p>

<h2>Mod actions</h2>

<p>Mod actions are another kind of trigger that are just for mods. These triggers show up in the mod log. Check out the list of available <a href="/docs/mod_actions.md">mod actions</a>, and if you don't see an action you want, let us know in <a href="https://reddit.com/message/compose/?to=/r/Devvit">r/devvit modmail</a>.</p>

<p><code>ts
Devvit.addTrigger({
  event: 'ModAction',
  async onEvent(event, context) {
    if (event.action === 'banuser') {
      console.log(`A new user ${event.targetUser?.name} was banned!`);
    }
  },
});
</code></p>

<h2>Automoderator triggers</h2>

<p>These triggers are invoked when automoderator filters a post or a comment into the mod queue. Along with the post or comment this object also includes <code>removedAt</code> and <code>reason</code> (if available) fields.</p>

<p>``<code>ts
Devvit.addTrigger({
  event: 'AutomoderatorFilterPost',
  onEvent: async (event) =&gt; {
    console.log(</code>Received AutomoderatorFilterPost event:\n${JSON.stringify(event)}`);
  },
});</p>

<p>Devvit.addTrigger({
  event: 'AutomoderatorFilterComment',
  onEvent: async (event) =&gt; {
    console.log(<code>Received AutomoderatorFilterComment event:\n${JSON.stringify(event)}</code>);
  },
});
```</p>
<h1>Changelog</h1>

<p>While we're always shipping fixes and improvements, our team bundles new features, breaking changes, and other user-facing updates into regular releases. This page logs the changes to each version of Devvit.</p>

<p>Before upgrading <code>@devvit/public-api</code> in your project, always update the CLI first by running <code>npm install -g devvit</code>.</p>

<h2>Devvit 0.11.11: Adding web view unmount</h2>

<p><strong>Release Date: Mar 24, 2025</strong></p>

<p>We've been working on making the web view experience better and more consistent across all platforms, and one new change we’re including is a <code>webview.unmount</code> function. This lets you unmount a <a href="./webviews.md#usewebview">web view</a> that's in focus mode programmatically.</p>

<p>:::note
Unmount is only available in v2025.12+ on iOS and v2025.11+ on Android.
:::</p>

<p><strong>Other Fixes</strong></p>

<ul>
<li>You can now omit metadata in in your product config.</li>
<li>We added a hook ID in logs to help debug invalid state errors.</li>
</ul>

<h2>Devvit 0.11.8: Minor Redis, Reddit API, and CLI improvements</h2>

<p><strong>Release Date: Mar 10, 2025</strong></p>

<p>This version of Devvit includes a few small quality-of-life updates for our developers. If you have any feedback, please let us know.</p>

<p><strong>New Features</strong></p>

<p>Additional Redis support, which includes:</p>

<ul>
<li><code>bitfield</code> support for Redis</li>
<li>Redis <code>rename</code>, <code>exist</code>, and <code>hSetNX</code> commands</li>
<li>a limit option to <code>zRange</code></li>
</ul>

<p>Reddit API Client changes:</p>

<ul>
<li>added <code>hasVerifiedEmail</code> field on the user object</li>
<li>added <code>setUserFlairBatch</code> to bulk update user flair</li>
</ul>

<p>CLI changes:</p>

<ul>
<li>Added a small (100ms) debounce to devvit playtest to prevent issues from file generation causing multiple uploads. To modify this, you can:
<ul>
<li>Set your own debounce with a flag (e.g. <code>devvit playtest --debounce=0</code>)</li>
<li>Configure a debounce time in your <code>package.json</code></li>
</ul></li>
</ul>

<p>```tsx
// in package.json</p>

<p>{
  "devvit": {
    "playtest": {
      "debounceConfigMs": 1000
    }
  }
}
```</p>

<p><strong>Fixes</strong></p>

<p>You can now create an image post that would previously error out.</p>

<h2>Devvit 0.11.7: The next step for web views</h2>

<p>We’re impressed by the adoption of web views and the powerful apps the developer community has built with it. It’s exciting to see so many devs embrace this experimental feature!</p>

<p>We think you’ll love the next step for web views: focus mode.</p>

<p><img src="./assets/webviews_snakepit_mobile_example.png" alt="Web views example" /></p>

<p>Focus mode enables web view apps that:</p>

<ul>
<li>Take full advantage of native webview gestures and advanced capabilities (e.g. scroll, zoom, sound, etc).</li>
<li>Are performant on all Reddit clients.</li>
<li>Provide a consistent experience for redditors.</li>
</ul>

<p><img src="./assets/webviews_snakepit_example.png" alt="Web views example" /></p>

<p>The <webview> component is being deprecated in favor of the new useWebView hook. Please follow the <a href="./webviews.md#migration-guide">migration guide</a> to migrate over your existing web view apps and check out the updated<a href="./webviews.md">web view docs</a>. Apps using the <webview> component are no longer publishable.</p>

<p>Once your web view app is migrated to useWebView and works on all platforms, publish your app!</p>

<p><strong>New Feature</strong></p>

<ul>
<li>We added support for <code>context.uiEnvironment.colorScheme</code> (e.g. “light” or “dark”).</li>
</ul>

<p><strong>Fix</strong></p>

<ul>
<li>The playtest lockfile feature was removed based on your feedback.</li>
</ul>

<h2>Special Devvit Announcement: Payments</h2>

<p>We’ve got a big update for our <a href="./payments/payments_overview.md">payments pilot</a> that makes <a href="./payments/payments_test.md">testing payments</a> in your apps even easier!</p>

<ul>
<li><p><strong>Instant Access to Sandbox Testing</strong> – Now, all developers can immediately test sandbox payment products in their apps without needing to request allowlist access first. This means you can start experimenting with in-app purchasing right away! (You'll still need to complete the <a href="./payments/payments_overview.md#prerequisites">verification process</a> before submitting your app for approval.)</p></li>
<li><p><strong>New Developer Showcase</strong> – We’re highlighting how fellow developers are using payments in their apps! First up: <a href="./showcase/payments_examples.md">Dark Dungeon</a>, a game with in-app purchasing thoughtfully integrated in. Check it out for inspiration on what’s possible!</p></li>
</ul>

<p>We can’t wait to see what you build! If you have questions or feedback, drop questions here or in the <a href="https://discord.com/channels/1050224141732687912/1295856497917431879">Payments Discord channel</a>.</p>

<p>Happy coding!</p>

<h2>Devvit 0.11.6: Performance updates and some small fixes</h2>

<p><strong>Release Date: Jan 28, 2025</strong></p>

<p><strong>New features</strong></p>

<p>Some apps at scale were running into performance bottlenecks, calling for the full subreddit or user object when the app only needed the current subreddit name or current username. Two new methods will speed this up and improve performance:</p>

<ul>
<li><code>reddit.getCurrentSubredditName()</code> returns only the name of the current subreddit, instead of an entire subreddit object.</li>
<li><code>reddit.getCurrentUsername()</code> fetches only the username of the current user instead of an entire user object.</li>
</ul>

<p><strong>Fixes</strong></p>

<ul>
<li><code>devvit new</code> now works on Windows devices on node v22.13+.</li>
<li><code>devvit update app</code> will also update typescript versions, if applicable.</li>
</ul>

<h2>Devvit 0.11.5: A security fix and some smaller updates</h2>

<p><strong>Release Date: Dec 17, 2024</strong></p>

<p>We've identified a security vulnerability with forms that use the <code>forUserType: 'moderator'</code>. Apps that have mod-only actions should update to the latest version of the public API by January 15, 2025. Once updated, we will help you upgrade installations across subreddits that use your app. To update your app, run:</p>

<p><code>
npm install -g devvit@latest // or package manager of choice
devvit update app
npm install
</code></p>

<p>:::note
You may notice additional logs about CSRF tokens. These will be removed in the next version of the public API.
:::</p>

<p><strong>New features</strong></p>

<ul>
<li>Added an <a href="./capabilities/redis.md#hash"><code>hMGet</code></a> method to Redis to get the value of multiple keys from a hash.</li>
<li>Redis is available to all apps now, so you don't have to define <code>redis: true</code> within the configuration object.</li>
</ul>

<p><strong>Fixes</strong></p>

<ul>
<li>Updated <code>reddit.getCurrentUserByUserName</code> to return undefined when a user is not found instead of throwing an error.</li>
<li>Fixed the hanging process when <code>devvit playtest</code> got stuck installing a playtest version.</li>
</ul>

<h2>Devvit 0.11.4: Payments (pilot) and more</h2>

<p><strong>Release Date: Dec 9, 2024</strong></p>

<p>Release 0.11.4 introduces <a href="./capabilities/payments.md">payments</a>! This pilot program lets you add products to your app and get paid for what you sell. The payments plugin enables the capability for users to purchase in-app products, like additional lives in a game or custom flair.</p>

<p>Since this is a pilot program, you'll need to submit an <a href="https://forms.gle/TuTV5jbUwFKTcerUA">enrollment form</a> before developing and playtesting payments in your app. Before you publish your app, you’ll need to complete additional steps outlined in the payments documentation.</p>

<p>We’ve also added a new <a href="https://developers.reddit.com/docs/capabilities/payments#add-payments-to-your-app">template</a> to help you set up payments functionality without needing to code a full app from scratch.</p>

<p><strong>New features</strong>
This release also includes:</p>

<ul>
<li>A <code>finally:</code> parameter for <a href="./working_with_useasync.md">useAsync</a> that lets your app setState when an async response is returned.</li>
<li>The ability to use runAs with <a href="https://developers.reddit.com/docs/api/redditapi/classes/models.Post#-setcustompostpreview">setCustomPostPreview</a>.</li>
<li>Experimental <a href="./webviews.md">web views</a> functionality on the latest iOS and Android clients.</li>
</ul>

<p><strong>Fixes</strong>
Release 0.11.4 corrected issues with duplicate logs and fixed the 502 error that was occurring during Redis transactions.</p>

<h2>Devvit 0.11.3: Web views (experimental), server-side functions, and other public API updates</h2>

<p><strong>Release Date: Nov 18, 2024</strong></p>

<p>0.11.3 adds a new way for developers to build UI with web views and server-side functions.</p>

<p><strong><a href="./webviews.md">Web views</a></strong> - is an experimental alternative to Devvit blocks, where you can build interactive posts and bring your own html/css/js into apps. This allows you to have access to standard web APIs and frameworks and access to animations and gestures not available in blocks. Note that this is an experimental feature that only works on web and is subject to significant changes over the next few months.</p>

<p><strong>Server-side functions</strong> - We heard that developers are concerned that their app code for interactive posts is exposed to clients (which is done for performance purposes). This release includes new <a href="./capabilities/server-side-functions.md">server-side functions</a> so that you can run functions from a <code>/*.server.ts</code> or <code>/server/*.ts</code> file to keep your codebase private. Those functions will run server-side and trigger a re-render.</p>

<p>We also made a few other changes to our public API in this release:</p>

<ul>
<li><a href="./api/redditapi/classes/models.Post.md#getenrichedthumbnail">post.getEnrichedThumbnail</a> allows developers to get a better thumbnail</li>
<li>Community fix: Allow <a href="./api/redditapi/classes/models.WikiPage.md">WikiPage revision author</a> to be undefined (Thanks PitchforkAssistant)</li>
<li>Community fix: Include conversations IDs sorted array from <a href="./api/redditapi/classes/models.ModMailService.md#getconversations">modMail.getConversations</a> (Thanks Pitchfork Assistant x2!)</li>
</ul>

<h2>Devvit 0.11.2: Text fallback and post API client changes</h2>

<p><strong>Release Date: Oct 31, 2024</strong></p>

<p>0.11.2 adds <a href="./text_fallback.md">textFallback</a> functionality to ensure that text in your app is accessible and functional on every surface. Old Reddit doesn't render interactive posts, and this ensures that your app can have a text fallback for those cases.</p>

<p>This release also includes a few API updates:</p>

<ul>
<li><a href="./api/redditapi/classes/models.Post.md#setcustompostpreview">setCustomPostPreview</a> lets you update and <a href="./interactive_posts.md#customize-the-post-preview">customize the post preview</a> with real content in the loading screen after the post has been created.</li>
<li><a href="./api/redditapi/classes/models.Post.md#setsuggestedcommentsort">setSuggestedCommentSort</a> provides options for sorting comments on a post.</li>
<li><code>forUserType: member’</code> has been removed from menu items. If you want a menu action to be visible to all users, omit the <code>forUserType</code> field.</li>
</ul>

<h2>Devvit 0.11.1: New automod filter trigger, playtest connect, and other improvements</h2>

<p><strong>Release Date: Oct 21, 2024</strong></p>

<p>0.11.1 includes <a href="capabilities/triggers.md">a new trigger</a> for when posts and comments are filtered by automod. We’ve also included some other improvements including:</p>

<ul>
<li>Playtest now defaults to using <code>--connect</code>, which sends client side logs that are in your browser into your CLI/terminal if you use the <code>?playtest</code> <a href="playtest.md">parameter</a>.</li>
<li>Public API changes:
<ul>
<li>Updated parameters to improve modmail conversation routing:
<ul>
<li>Added <code>createModInboxConversation()</code>, which sends a message from the app account to subreddit mods via Mod Inbox.</li>
<li>Added <code>createModDiscussionConversation()</code>, which does the same thing via Mod Discussions.</li>
<li>Deprecated <code>modMail.createConversation()</code>.</li>
</ul></li>
<li>Fixed <a href="api/redditapi/classes/models.ModMailService.md"><code>modMail.muteConversation</code></a> to take in proper values for numHours (defaults to 72).</li>
<li>Fixed context that was not being properly passed in <code>reddit.banUser</code> methods (thanks to fsv for the community contribution!).</li>
</ul></li>
</ul>

<h2>Devvit 0.11.0: Platform updates, breaking changes, and useAsync</h2>

<p><strong>Release Date: October 9, 2024</strong></p>

<p>One of the biggest issues for devs who are building experiences is that data fetching slows down the render of the app. Devvit 0.11.0 introduces a new platform architecture for improved performance and scalability. This release includes a new, experimental <a href="working_with_useasync.md">useAsync</a> feature that allows you to fetch data in a non-blocking way and a new hook architecture that lets you build composable hooks.</p>

<p>These platform upgrades create breaking changes for some apps. We’re releasing 0.11.0 on <a href="https://developers.reddit.com/docs/next/">@Next</a> (the experimental branch of Devvit), so current app functionality will still work as you migrate your apps over to the updated platform.</p>

<p>To get started on 0.11.0:</p>

<ol>
<li>Run <code>npm install -g devvit</code>.</li>
<li>Run <code>devvit update app</code> and <code>npm i</code> to update your app.</li>
</ol>

<p><strong>New Features</strong></p>

<ul>
<li><strong>Faster rendering</strong>. <code>useAsync</code> is a new hook that lets you fetch data without blocking the render. This is an experimental feature that we will be iterating on over time.</li>
<li><strong>Composable hooks</strong>. Now you can create hooks that can be shared across projects. While you could do this with the old hooks off context, rendering bugs prevented you from using them in various parts of your app. With this release you can abstract everything into hooks.</li>
</ul>

<p>```ts
import { Devvit, useState } from '@devvit/public-api';</p>

<p>const useCounter = (startingCount: number) =&gt; {
  const [counter, setCounter] = useState(startingCount);</p>

<p>return {
    counter,
    increment: () =&gt; setCounter((x) =&gt; x + 1),
    decrement: () =&gt; setCounter((x) =&gt; x - 1),
  };
};</p>

<p>const MyComponent = () =&gt; {
  const { counter, increment } = useCounter(5);</p>

<p>return (
    <vstack>
      <text>Count: {counter}</text>
      <button onPress={() =&gt; increment()}&gt;Increment</button>
    </vstack>
  );
};
```</p>

<ul>
<li>Hooks can be imported from the package instead of relying on <code>context</code>:</li>
</ul>

<p>```ts
// Old pattern
import { Devvit } from '@devvit/public-api';</p>

<p>const MyComponent = (context) =&gt; {
  const [count, setCount] = context.useState(0);</p>

<p>return <hstack></hstack>;
};</p>

<p>// New pattern
import { Devvit, useState } from '@devvit/public-api';</p>

<p>const MyComponent = () =&gt; {
  const [count, setCount] = useState(0);</p>

<p>return <hstack></hstack>;
};
```</p>

<p><strong>Breaking changes</strong></p>

<ul>
<li>Asynchronous components are no longer supported and will throw an error.</li>
</ul>

<p>```ts
// Old pattern
const MyComponent = async () =&gt; {
  const data = await redis.get('count');</p>

<p>return <hstack></hstack>;
};</p>

<p>import { useState } from '@devvit/public-api';</p>

<p>const MyComponent = () =&gt; {
  const [data] = useState(async () =&gt; redis.get('count'));</p>

<p>return <hstack></hstack>;
};</p>

<p>// New pattern: if you want this request to be non-blocking you can use useAsync
import { useAsync } from '@devvit/public-api';</p>

<p>const MyComponent = () =&gt; {
  const { data, loading } = useAsync(async () =&gt; await redis.get('count'));</p>

<p>return <hstack></hstack>;
};
```</p>

<ul>
<li>You can no longer use forms created with <code>Devvit.createForm</code> inside of render.</li>
</ul>

<p>```ts
// Old pattern
const myForm = Devvit.createForm(
  {
    fields: [
      {
        type: 'string',
        name: 'food',
        label: 'What is your favorite food?',
      },
    ],
  },
  (event, context) =&gt; {
    // onSubmit handler
    context.ui.showToast({ text: event.values.food });
  }
);</p>

<p>const MyComponent = (context) =&gt; {
  return (
    <hstack>
      <button onPress={() =&gt; context.ui.showForm(myForm)}&gt;Show form</button>
    </hstack>
  );
};</p>

<p>// New pattern
import { Devvit, useForm } from '@devvit/public-api';</p>

<p>const MyComponent = (context) =&gt; {
  const myForm = useForm(
    {
      fields: [
        {
          type: 'string',
          name: 'food',
          label: 'What is your favorite food?',
        },
      ],
    },
    (event, context) =&gt; {
      // onSubmit handler
      context.ui.showToast({ text: event.values.food });
    }
  );</p>

<p>return (
    <hstack>
      <button onPress={() =&gt; context.ui.showForm(myForm)}&gt;Show form</button>
    </hstack>
  );
};
```</p>

<p><strong>Deprecated Features</strong></p>

<ul>
<li>Using hooks (like useState) off <code>context</code> is deprecated and will be removed in a future release. This change improves the performance of your app and makes it easier to write shareable hooks.</li>
</ul>

<p>```ts
// Old pattern
import { Devvit } from '@devvit/public-api';</p>

<p>const MyComponent = (context) =&gt; {
  const [count, setCount] = context.useState(0);</p>

<p>return <hstack></hstack>;
};</p>

<p>// New pattern
import { Devvit, useState } from '@devvit/public-api';</p>

<p>const MyComponent = () =&gt; {
  const [count, setCount] = useState(0);</p>

<p>return <hstack></hstack>;
};
```</p>

<ul>
<li>API methods related to Reddit's Post Collections functionality have been removed, as the <a href="https://www.reddit.com/r/modnews/comments/1am4b0e/deprecating_post_collections_mark_as_oc_and/">feature was removed from Reddit several months ago</a>.</li>
</ul>

<p><strong>Improvements and updates</strong></p>

<p><strong>CLI</strong></p>

<ul>
<li>Improved error messaging
<ul>
<li>Pass 4xx errors up to developers</li>
<li>Ensure stack traces have the full path in message</li>
<li>New playtest error for app not yet existing</li>
<li>New error for apps blocked on upload due to asset folder sizes</li>
</ul></li>
<li>Improved image asset upload batching</li>
<li>Added retry calls from CLI to Portal that fail</li>
<li><code>devvit new --help</code> output fixed</li>
</ul>

<p><strong>Context</strong></p>

<ul>
<li>Set <code>appName</code> and <code>appVersion</code> on public Context</li>
<li>Added <code>subredditName</code> to Context</li>
<li>Added support for getting locale and timezone in uiEnvironment</li>
</ul>

<p><strong>Portal</strong></p>

<ul>
<li>Improved error messaging</li>
<li>Added an error for why an app is ineligible when installation fails</li>
</ul>

<p><strong>Reddit API</strong></p>

<ul>
<li>Added <code>getSubredditInfo</code> methods to Reddit API plugin</li>
<li>Made <code>redditId</code> and <code>label</code> optional on ModNotes</li>
<li>Correctly set <code>revisionDate</code> on WikiPage type</li>
<li>Now returns <code>contentHtml</code> on WikiPage</li>
<li>Updated subredditStyles type</li>
<li>Updated moderator permissions list to match API model</li>
<li>Fixed bugs with reddit.inviteModerator() API call</li>
<li>Added <code>ignoreReports()</code> to Comment model</li>
</ul>

<p><strong>Other fixes</strong></p>

<ul>
<li>Added realtime channel message type errors.</li>
<li>Reduced false alarms for hook errors. Previously, hook errors were firing in valid use cases. Hook rules still apply. If you see this error: <code>Error: Invalid hook call. Hooks can only be called at the top-level of a function component. Make sure that you are not calling hooks inside loops, conditions, or nested functions.</code>, it is most likely caused by an error inside of your code.</li>
</ul>
<h1>Building community games</h1>

<p>Reddit offers a unique platform for a new category of social games. This guide will help you create engaging community games that thrive in Reddit's ecosystem with lessons from some of the games we've seen so far.</p>

<h2>What are community games?</h2>

<p>Community games are asynchronous multiplayer experiences built specifically for Reddit's platform. They leverage Reddit's unique social dynamics and content mechanics to create engaging, bite-sized gaming experiences that scale from single players to thousands.</p>

<h2>Why build a community game?</h2>

<ul>
<li><em>Played by millions</em> - Successful apps will be distributed to millions of users in their home feed</li>
<li><em>Hosted services</em> - We provide hosting, storage (redis), and robust backend capabilities (realtime, scheduler, trigger) with every app</li>
<li><em>Build once, play everywhere</em> - if you build your apps once they will run on web, android, and iOS</li>
<li><em>Monetization opportunities</em> - We have reddit developer funds and payments to reward successful apps with a handful of new monetization opportunities coming soon.</li>
</ul>

<h2>Core design principles</h2>

<h3>1. Keep it bite-sized</h3>

<ul>
<li>Focus on quick, discrete gameplay loops</li>
<li>Reduce "time to fun" - players should be having fun within seconds</li>
<li>Small scope = faster development and easier maintenance</li>
<li>Example: <a href="https://reddit.com/r/chessquiz">r/ChessQuiz</a> offers daily chess puzzles rather than full matches</li>
</ul>

<h3>2. Design for the feed</h3>

<ul>
<li>Create an eye-catching first screen that stands out</li>
<li>Include a clear, immediate call to action</li>
<li>Remember: You're competing with cat videos and memes</li>
<li>Example: <a href="https://reddit.com/r/pixelary]">r/Pixelary</a> shows the drawing canvas right in the feed</li>
</ul>

<h3>3. Build content flywheels</h3>

<p>Reddit posts naturally decay after a few days. Your game needs a strategy to stay relevant:</p>

<p><strong>Option A: Scheduled content</strong></p>

<ul>
<li>Daily/weekly challenges</li>
<li>Automated post creation</li>
<li>Regular tournaments or events</li>
<li>Example: <a href="https://reddit.com/r/sections">r/Sections</a> posts a new puzzle every day</li>
</ul>

<p><strong>Option B: Player-generated content</strong></p>

<ul>
<li>Players create content through gameplay</li>
<li>Each play creates new posts/comments</li>
<li>Moderation systems for quality control</li>
<li>Example: <a href="https://reddit.com/r/captioncontest">r/CaptionContest</a> turns each submission into new content</li>
</ul>

<h3>4. Embrace asynchronous play</h3>

<p>Benefits:</p>

<ul>
<li>Players can participate anytime</li>
<li>Lower commitment (one move vs. entire game)</li>
<li>Larger player pool across time zones</li>
<li>Better scalability</li>
</ul>

<h3>5. Scale from one to many</h3>

<p>Your game should be fun at any player count:</p>

<ul>
<li>Single-player baseline experience</li>
<li>Scales smoothly as more players join</li>
<li>Uses leaderboards to create competition</li>
<li>Example: <a href="https://reddit.com/r/darkdungeongame">r/DarkDungeonGame</a> works solo but gets better with more players solving together</li>
</ul>

<h2>Successful examples</h2>

<h3>Pixelary (drawing and guessing game)</h3>

<ul>
<li><strong>Primary loop</strong>: Draw (hard) → Creates posts</li>
<li><strong>Secondary loop</strong>: Guess (easy) → Creates comments (optionally)</li>
<li><strong>Why it works</strong>:
<ul>
<li>Clear mental model</li>
<li>Two-tiered engagement</li>
<li>Natural content generation</li>
<li>Scales with community size</li>
</ul></li>
</ul>

<h3>ChezzQuiz (competitive chess puzzles)</h3>

<ul>
<li><strong>Core loop</strong>: Daily puzzles with competitive solving</li>
<li><strong>Why it works</strong>:
<ul>
<li>Consistent content schedule</li>
<li>Built-in competition</li>
<li>Leverages existing chess knowledge</li>
<li>Clear success metrics</li>
</ul></li>
</ul>

<h2>Best practices checklist</h2>

<ul>
<li>✅ Create your own subreddit</li>
<li>✅ Can be played in under 2 minutes</li>
<li>✅ Has a striking first impression</li>
<li>✅ Creates new content regularly</li>
<li>✅ Works for both 1 and 1000 players</li>
<li>✅ Has clear user actions</li>
<li>✅ Includes social elements</li>
<li>✅ Uses moderation tools</li>
</ul>

<h2>Common pitfalls to avoid</h2>

<ul>
<li>❌ Complex game rules</li>
<li>❌ Long time commitments</li>
<li>❌ Requiring specific player counts</li>
<li>❌ Dependency on real-time interactions</li>
<li>❌ Unclear first actions</li>
<li>❌ No content refresh strategy</li>
</ul>

<h2>Key takeaway</h2>

<p>The most successful Reddit community games create interesting content while being played, establishing a virtuous cycle of engagement and discovery. Focus on simplicity, scalability, and social interaction to make your game thrive.</p>
<h1>Create a custom post with a form</h1>

<h2>Prerequisites</h2>

<p>Read through our <a href="./basic_custom_post.md">custom post tutorial</a> to learn what a custom post is and how to create one. We'll use that custom post to make a simple form asking your users how they’re doing.</p>

<p>| Custom post                | Form                                   |
| -------------------------- | -------------------------------------- |
| <img src="./assets/form.png" alt="Form" /> | <img src="./assets/form_popup.png" alt="User input" /> |</p>

<h3>Start a project</h3>

<p>To create a form, use the <code>custom-post</code> template to start a new custom post project.</p>

<ol>
<li>From the terminal, navigate to a directory where you'll store your project.</li>
<li>Enter the following command to create a project folder on your local machine.</li>
</ol>

<p><code>bash
devvit new &lt;replace-with-your-app-name&gt; --template=custom-post
</code></p>

<h3>Install dependencies</h3>

<ol start="3">
<li>To have your package manager install the dependencies, run the following command in the root of your project:</li>
</ol>

<p><code>bash
npm i
</code></p>

<p>-OR-</p>

<p><code>bash
yarn install
</code></p>

<h3>Add imports</h3>

<ol start="4">
<li>Add the following code to the top of your file (you can replace the existing import statement).</li>
</ol>

<p><code>ts
import { Devvit } from '@devvit/public-api';
</code></p>

<ol start="5">
<li>Configure your app to use the Reddit API. Paste the following code under the import statement:</li>
</ol>

<p><code>ts
Devvit.configure({
  redditAPI: true,
});
</code></p>

<h2>Create a form</h2>

<p>Copy and paste the following code snippets into your <code>main.tsx</code> file below the import statements
(replace the code from the template with this).</p>

<ol start="6">
<li>Create a custom post component.</li>
</ol>

<p><code>jsx
Devvit.addCustomPostType({
  name: 'My Custom Post Type',
  render: () =&gt; {
    return (
      &lt;vstack&gt;
        &lt;text style="heading" size="xxlarge"&gt;
          Hello!
        &lt;/text&gt;
      &lt;/vstack&gt;
    );
  },
});
</code></p>

<ol start="7">
<li>Use the Reddit API to say hello to the user.</li>
</ol>

<p>```jsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>Devvit.addCustomPostType({
  name: 'My Custom Post Type',
  render: (context) =&gt; {
    const [currentUsername] = useState(async () =&gt; {
      const currentUser = await context.reddit.getCurrentUser();
      return currentUser.username;
    });</p>

<pre><code>return (
  &lt;vstack&gt;
    &lt;text style="heading" size="xxlarge"&gt;
      Hello! {currentUsername}
    &lt;/text&gt;
  &lt;/vstack&gt;
);
</code></pre>

<p>},
});
```</p>

<ol start="8">
<li>Create a form to collect user input.</li>
</ol>

<p>```tsx
import { Devvit, useState, useForm } from '@devvit/public-api';</p>

<p>Devvit.addCustomPostType({
  name: 'My Custom Post Type',
  render: (context) =&gt; {
    const [currentUsername] = useState(async () =&gt; {
      const currentUser = await context.reddit.getCurrentUser();
      return currentUser.username;
    });</p>

<pre><code>const [answer, setAnswer] = useState('');

const howAreYouForm = useForm(
  {
    fields: [
      {
        name: 'answer',
        label: 'How are you doing today?',
        type: 'string',
        required: true,
      },
    ],
  },
  async (data) =&gt; {
    context.ui.showToast({
      text: 'Thanks for answering!',
      appearance: 'success',
    });
    setAnswer(data.answer);
  }
);

return (
  &lt;vstack&gt;
    &lt;text style="heading" size="xxlarge"&gt;
      Hello {currentUsername}
    &lt;/text&gt;
    &lt;spacer /&gt;
    &lt;hstack gap="medium"&gt;
      &lt;text&gt;How are you doing today?&lt;/text&gt;
      {answer ? (
        &lt;text&gt;{answer}&lt;/text&gt;
      ) : (
        &lt;button
          onPress={() =&gt; {
            context.ui.showForm(howAreYouForm);
          }}
        &gt;
          Answer Question
        &lt;/button&gt;
      )}
    &lt;/hstack&gt;
  &lt;/vstack&gt;
);
</code></pre>

<p>},
});
```</p>

<ol start="9">
<li>Add a subreddit menu item to submit your custom post.</li>
</ol>

<p><code>jsx
Devvit.addMenuItem({
  location: 'subreddit',
  label: 'Submit custom post',
  onPress: async (_, context) =&gt; {
    const currentSubreddit = await context.reddit.getCurrentSubreddit();
    await context.reddit.submitPost({
      title: 'My custom post',
      subredditName: currentSubreddit.name,
      preview: (
        &lt;vstack&gt;
          &lt;text&gt;Loading...&lt;/text&gt;
        &lt;/vstack&gt;
      ),
    });
    context.ui.showToast(`Submitted custom post to ${currentSubreddit.name}`);
  },
});
</code></p>

<ol start="10">
<li>Paste this as the last line of your file:
All of the code above this line modified the core Devvit object. This line makes the updated Devvit object (which now implements the custom post) available to the Reddit Developer Platform.</li>
</ol>

<p><code>ts
export default Devvit;
</code></p>

<h2>Testing</h2>

<p>You can use <a href="./playtest.md">playtest</a> to test your custom post or install it on a test subreddit.</p>

<p>To install to a test subreddit:</p>

<ul>
<li>Add a custom subreddit menu action that creates a sample post to your code.</li>
<li>Install your app on a test subreddit.</li>
<li>Click on the subreddit menu and create a post.</li>
</ul>

<h3>Next steps</h3>

<p>Congratulations on building your interactive form! Next up: add <a href="./debug.md">logging</a> to your app to help you debug.</p>
<h1>Customize the post preview</h1>

<p>After your app has been created, you can use <code>setCustomPostPreview</code> to update your post preview and customize the loading screen with actual content.</p>

<p>For example, if your post has information about a future event, you could set the preview/loading screen to say how many days away the event is.</p>

<p><code>ts
// creation of the post
const daysAwayFromEvent = 3; // would actually be done by checking the date diff, but just hardcoding for this example
const post = await reddit.submitPost({
  title: 'A Countdown post',
  subredditName: subreddit.name,
  preview: (
    &lt;zstack height="100%" width="100%" alignment="center middle"&gt;
      &lt;text&gt;The event will start in {daysAwayFromEvent} days&lt;/text&gt;
    &lt;/zstack&gt;
  ),
});
</code></p>

<p>Then you'd create a <a href="./capabilities/scheduler.md">scheduler</a> to run when the days away count changes:</p>

<p>```ts
Devvit.addSchedulerJob({
  name: 'UpdatePostPreview',
  onRun: async (event, context) =&gt; {
    const { reddit } = context;
    const { postId } = event.data!;</p>

<pre><code>if (!postId) {
  console.error('No post ID provided');
  return;
}

const post = await reddit.getPostById(postId);
const daysAwayFromEvent = 2; // would actually be done by checking the date diff, but just hardcoding for this example
const newPreview = (
  &lt;vstack height="100%" width="100%" alignment="center middle"&gt;
    &lt;text&gt;The event will start in {daysAwayFromEvent} days&lt;/text&gt;
  &lt;/vstack&gt;
);

await post.setCustomPostPreview(() =&gt; newPreview);
</code></pre>

<p>},
});
```</p>

<p>How you customize your loading screen is up to you!</p>
<h1>Using custom posts</h1>

<p>Want to know more about custom posts? You’re in the right place. This page will help you understand the technical details that go into making a custom post, including:</p>

<ul>
<li>Definitions</li>
<li>Parameters</li>
<li>Post creation flow</li>
</ul>

<h2>Definitions</h2>

<p>Custom posts need a definition for the post type and the post loading state:</p>

<ul>
<li>The <code>addCustomPostType()</code> method defines the custom post type.</li>
<li>The <code>submitPost()</code> method instantiates the post and defines the loading state.</li>
</ul>

<p>The final post is auto-populated from the post template using <code>submitPost()</code>.</p>

<h2>Parameters</h2>

<p>The <code>.addCustomPostType(customPostType: CustomPostType)</code> function has these parameters:</p>

<ul>
<li>name of the post type</li>
<li>description, which is optional</li>
<li>render to return the UI for the custom post.</li>
</ul>

<p>:::note
The UI is wrapped in <code>&lt;blocks&gt;</code>. If you don’t include them, <code>&lt;blocks&gt;</code> will be automatically added.
:::</p>

<p><strong>Example</strong></p>

<p><code>tsx
Devvit.addCustomPostType({
  name: 'My Custom Post Type',
  description: 'A big hello text.',
  render: () =&gt; {
    return (
      &lt;blocks height="regular"&gt;
        &lt;vstack&gt;
          &lt;text style="heading" size="xxlarge"&gt;
            Hello!
          &lt;/text&gt;
          &lt;button icon="heart" appearance="primary" /&gt;
        &lt;/vstack&gt;
      &lt;/blocks&gt;
    );
  },
});
</code></p>

<p>:::note
Check out our extensive <a href="blocks/icon">Icon Library</a>! These can be used in <code>&lt;button&gt;</code>s or on their own as <code>&lt;icon&gt;</code>s.
:::</p>

<p>The <code>submitPost(options: SubmitPostOptions)</code> function has these parameters:</p>

<ul>
<li>title for the name of the custom post</li>
<li>subredditName to show where the post will be instantiated</li>
<li>preview to provide a lightweight UI that shows while the post renders.</li>
</ul>

<p><strong>Example</strong></p>

<p><code>tsx
await reddit.submitPost({
  title: 'My custom post',
  subredditName: currentSubreddit.name,
  preview: (
    &lt;vstack&gt;
      &lt;text&gt;Loading...&lt;/text&gt;
    &lt;/vstack&gt;
  ),
});
</code></p>

<h2>Post creation flow</h2>

<p>Once the post can be submitted and instantiated, the post needs a place for users to call it for creation. This example uses the subreddit menu.</p>

<p>The <code>.addMenuItem(menuItem: MenuItem)</code> function has these parameters:</p>

<ul>
<li>label for the text users will see</li>
<li>location to indicate where the menu item will be</li>
<li>onPress handler, which specifies what happens when the menu item is pressed</li>
</ul>

<p><strong>Example</strong></p>

<p><code>tsx
Devvit.addMenuItem({
  location: 'subreddit',
  label: 'Add a poll',
  onPress: async (_, context) =&gt; {
    const currentSubreddit = await context.reddit.getCurrentSubreddit();
    await context.reddit.submitPost({
      title: 'My custom post',
      subredditName: currentSubreddit.name,
      preview: (
        &lt;vstack&gt;
          &lt;text&gt;Loading...&lt;/text&gt;
        &lt;/vstack&gt;
      ),
    });
    context.ui.showToast(`Submitted custom post to ${currentSubreddit.name}`);
  },
});
</code></p>
<h1>Logging</h1>

<p>Stream log events from your installed app to your command line to enable troubleshooting your app.</p>

<h2>Create logs</h2>

<p>Any logs sent to <code>console</code> will be available via <code>devvit logs</code> for installed apps. For example, <code>console.log()</code>, <code>console.info()</code> and <code>console.error()</code> will produce logs with timestamps as expected.</p>

<p>The following example creates a basic app that simply creates a single log.</p>

<p>```typescript title="main.tsx"
import { Context, Devvit } from '@devvit/public-api';</p>

<p>Devvit.addMenuItem({
  location: 'post',
  label: 'Create a log!',
  onPress: (event, context) =&gt; {
    console.log('Action called!');
    context.ui.showToast(<code>Successfully logged!</code>);
  },
});</p>

<p>export default Devvit;
```</p>

<h2>Stream logs</h2>

<p>To stream logs for an installed app, open a terminal and navigate to your project directory and run:</p>

<p><code>bash
$ devvit logs &lt;my-subreddit&gt;
</code></p>

<p>You can also specify the app name to stream logs for from another folder.</p>

<p><code>bash
$ devvit logs &lt;my-subreddit&gt; &lt;app-name&gt;
</code></p>

<p>You should now see logs streaming onto your console:</p>

<p><code>bash
=============================== streaming logs for my-app on my-subreddit ================================
[DEBUG] Dec 8 15:55:23 Action called!
[DEBUG] Dec 8 15:55:50 Action called!
[DEBUG] Dec 8 15:57:29 Action called!
[DEBUG] Dec 8 15:57:32 Action called!
</code></p>

<p>To exit the streaming logger, enter <code>CTRL + c</code>.</p>

<p>Currently, <code>console.log</code> calls will only stream when they are run from the server (not the client).</p>

<p>:::note</p>

<p>Custom post apps use a client-side runtime to speed up execution, so <code>console.log</code> calls won't always show up in Devvit logs or Devvit playtest commands. However, these calls will show up in other dev tools (like Chrome) when viewing the app during a playtest.</p>

<p>:::</p>

<h2>Historical logs</h2>

<p>You can view historical logs by using the <code>--since=XX</code> flag. You can use the following shorthand:</p>

<ul>
<li><code>Xs</code>: show logs in the past X seconds</li>
<li><code>Xm</code>: show logs in the past X minutes</li>
<li><code>Xh</code>: show logs in the past X hours</li>
<li><code>Xd</code>: show logs in the past X days</li>
<li><code>Xw</code>: show logs in the past X weeks</li>
</ul>

<p>The following example will show logs from <code>my-app</code> on <code>my-subreddit</code> in the past day.</p>

<p><code>bash
$ devvit logs &lt;my-subreddit&gt; --since=1d
</code></p>

<p>You will now see historical logs created by your app on this subreddit:</p>

<p><code>bash
=============================== streaming logs for my-app on my-subreddit ================================
[DEBUG] Dec 8 15:55:23 Action called!
[DEBUG] Dec 8 15:55:50 Action called!
[DEBUG] Dec 8 15:57:29 Action called!
[DEBUG] Dec 8 15:57:32 Action called!
</code></p>

<p>To exit the streaming logger, enter <code>CTRL + c</code>.</p>

<h2>Playtest</h2>

<p>While you are running <a href="./playtest.md"><code>playtest</code></a> in a subreddit, you will also be <a href="#create-logs">streaming logs</a> from that community in your command line.</p>
<h1>@devvit/kit</h1>

<p>Devvit Kit is a helper library that makes it easier to build Devvit apps. Kit includes both UI components and general backend patterns that simplify common tasks and enable developers to build apps faster.</p>

<p>You can find instructions on how to install and use @devvit/kit <a href="https://github.com/reddit/devvit-kit">here</a>.</p>

<h2>Available helpers</h2>

<p>| Name                                                                                             | Description                                                                                  |
| ------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------- |
| <a href="https://github.com/reddit/devvit-kit/blob/main/src/columns/readme.md">Columns</a>                  | Provides a simple column layout and optionally lets you specify gap sizing between elements. |
| <a href="https://github.com/reddit/devvit-kit/blob/main/src/pixel-padding/readme.md">Pixel padding</a>      | A component that lets you set padding from any side using pixel values.                      |
| <a href="https://github.com/reddit/devvit-kit/blob/main/src/item-pagination/readme.md">Items pagination</a> | Enables pagination of data, including a UI for navigating through the elements.              |
| <a href="https://github.com/reddit/devvit-kit/blob/main/src/dev-toolbar/readme.md">Dev toolbar</a>          | Adds a toolbar of actions only visible to developers.                                        |</p>

<h2>Example</h2>

<p>Once @devvit/kit is installed, you can use the components in your app. This example uses the <code>Columns</code> component.</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';
import { Columns } from '@devvit/kit';</p>

<p>Devvit.addCustomPostType({
  name: 'Columns static content',
  render: () =&gt; {
    return (
      <vstack padding="medium">
        <Columns columnCount={2} gapX="5px" gapY="10px" order="column">
          <hstack backgroundColor="grey">
            <text>Birds</text>
          </hstack>
          <hstack>
            <text>Raven</text>
          </hstack>
          <hstack>
            <text>Parrot</text>
          </hstack></p>

<pre><code>      &lt;hstack backgroundColor="grey"&gt;
        &lt;text&gt;Dogs&lt;/text&gt;
      &lt;/hstack&gt;
      &lt;hstack&gt;
        &lt;text&gt;Bulldog&lt;/text&gt;
      &lt;/hstack&gt;
      &lt;hstack&gt;
        &lt;text&gt;Poodle&lt;/text&gt;
      &lt;/hstack&gt;
    &lt;/Columns&gt;
  &lt;/vstack&gt;
);
</code></pre>

<p>},
});
```</p>

<p>You can also <a href="https://developers.reddit.com/play#pen/N4IgdghgtgpiBcIQBoQGcBOBjBICWUADgPYYAuABMACIwBudeZAvhQGYbFQUDkAAgBN6jMgHpCAVwBGAGzxYAtBEJ4eAHTAaNtBkwB0EAQIDCEtGS4AFYuYAqAT0IwAFMA0UKkWPF7HiMiSgwNApzCDJ5CixiMDIYWJ5kdwoMeKEMH2cASgoAXgA+KmSPVLIJDDAKZ2KPCgAeOjCsAGsKQkMBPDAAc1y1EFhOwP78mtr6vwCgkOipsD8JWNzgACZWbuUADT6QAFZCAA9+ig3CAE0dgEYABkPj0nSd2cDNEFHK8c+xz7qACybWlIIC1upxFiZ-KQdqCYPYRt9PvU4gcyPkAEJ4DACNB1UTI1EI2q4-5kYHNd6I8Z-AEUylU-H5ABKEDo8VxDMJHmJNM59RJZNpdK5DMsEAwnDI7JgKMFlO5pJa7151IVgLJoOI4MmUP6MLhb15wulqOoxG6OLxxtliPlAuV-MVhqRVrREhkMgEZqlMuVogd5PtPI+QudMusxAEMhg3oJwblfqDIcJuMmLzQ1vqokaqtlWQA3BpmFktJpSyXy2XKyW2IssBEYicYGQAMqEORkCI9ABitfrYGcDxgGQojLSQ663QA8lih1kfK3253uj2wHW8A23B88GwqoOMHlcrleM8gjwcpvxqVypU0G2mABJOJQNAFj7MZLb3cz-eHo88E9gAobB4O6Z5FHGV4VKEd5kI+MDPqmQRdiBMivh475bjuA7fgeR79JwADu-TnjUkE3jBcHPoyxAEWhFAYR4oiiCkY77jEMBRP4LwUBAIQQBQQhsBAbqUFIMC-Cy67lMkZFVEw8FoDkBQUAA2ipegafJz4ALraa+GEaNKJDkJxwSUIhwR5FUhCcIQaA+DoIh6GiMjEC0fhEOxsSWLZOIWWgPnEHZ+RzhQABSzabHoACiUawLEeSFBeFCfs4ACENlBWgehYL8IECKklQAD5FRQaUAILihA9h6HgaCVRg1XOJldk5XlHqFVkJEQU2171PkwAtdluX5YVzC4vkdEMaZ5gUHuVlDXo80lceXGnnR0RmZxcwLAlR6LQBu2UIU1wUAA-G0vk5Wt8yaglPiXBtMSzVAEAHNRBEhPtV2ve9NEhAAZADl1ZXov0fSEJ3nSDrXg-9FA+PeYDAWATD2E9W2nJshwLVdWPQwAcoEYkYM1eNbHot7ts4PCHGeKnXNpOQ+NcGOzVj854AAXjAlh4AcMAyF9JxbDjQMi4Q2MHBQUMXQABgAJMAWOHMwhxywjvC3AcPBs5QpxnDj32gwbhPE0OZMm8oZyUzBNN01kDNM5rrPJJt7PW5zPN8wLQtWQbYvAwH0uyxQivK9bqvq5rPDa7rbvPZQVNMEuK5rg2R7dE2C4pxOad9th6T5gnW0AcLycdnnvbrv2B3tQV8TINtLxHU3cOfcXHzu-4MB6K53TOGXnclL1UHVHGKpkhQBF4AIZC-MsNzXMwGbAGXYPKM4g83U3AFI0IBxKUlhKyePIZ1BmiJrzd+-SjLFCneLk8tNPs-z8sWMr7airTef2ZTzPOeC9gBLwoMxQ6d0WAnEIpfSk185gb0IFvLSTdCK30PolcCIZESnydDaWB2CqBoLAAfe+j9gbP1aL8GAeBui-DIB-a2X8Ew5l-oQz4wAtJsPYZmAhlJh7sKLNw+M-9HRxhtKIWBAjxhCJqN-AMHxO7MFfIZA4xlKA1lXH2aC7ZKI4lsPkZwXRJBkB8LYFS2ld43Xsp4c2GA25vQhj4MAdjQrmO0hYrBM1KC-T0dQOqbZqowAEFZAAsuEX4YMuhn1qO3L6h4KBIxRmjaGxiJBkD7vEbo89NZlwoAAKgoHEpIcY0kZKjD0eeyQBHu0oFpNAthiD+PMBgPAUh0kcSPGUymcgsAuGuA4g4fiAkyCCQIGpicTgSDFBAWIMBgl6KRhZMJES9BsFcqQIxT4GlNLqmQVp7S4iZMqb8MBzdpgCKjJQToLS2kdIhIsSgR5XZd0makNAIkzEWM8UeBqTUh41DWShZwLj3TFjjIgreR9VJMzomwUgVQrkpSsqzZFdRznBDzClAA1Ni7q4xamhFJOQdBVkbn7LuXEB5sQ6IeEJfUgAMjANgZAjpWXqY05pFLDm9wqdk05CgBJ7IOfco6tLvEYrQEyllVk8mCrwOK+l2zGnlSMHkb4jLmWssgRQAApJK6VlALrdGmY1OZCztlLJuhQbFFBLiaxNTM81AhFm3TmOK95IkVJ4G0uy5Vuzbk8p6fIFwYQSUkOlE3MNsEI3S1tRy4gqrxnivJSKqlbLsVdP9UmqaMlR6VE9TIMg+kSxGVIBo6uDYK56Isshd0dQDFGLACYr5ljJXOLsYMpxtioAkzcd831yVCW+O2c0wJ9hgkrPnlE-sNQ4m4UScjLoKSLrdL5TknweTCnFJqGurJVTFF6xYh8otrafkUD+fYbecxFKAuAu6EFboZDgvGJC7ImCLGXKbFEcohVtVzBRXRJFWBf3xDIB9QDyR4X7mcEivAgG0VFLesMqmYysV4Fxfi2oqUQPijAxB-IR44lYYJaB2IEHnnirpWR-93FM12vFWwwtZAVK4b-RZbSehJBoF+E2kx3rYU1DY-hmiNqjyPWSNNWSzGS2ljLSZTR6dyK6O2R9BthiymtqsTejtvahxdv+rpvtZ7B0lxesh0dIyxlTsiVAaJc7HHw1-Iu5JZB7CpObek45-LcnWIKUhv6n0SnjD3Sc6pR7mMmaspe69aYX21CBQ+0Fz7AWvSQe+5Sn6gPfuE7EZZlGoMItg9++DlHEMjoUmO0ZE6BDocw14jwOGaPLMI5KkjtRcu0aCJBuMTGYAnpY51jjXGzC8bKQJ6RP68N5etfRiTb481lCgjJwsFZ5OUDc04CgzZua835oLYW4cXF6YwGrA4csVFgHWxQTbHFRwRtaT0ac6QrL9AAscUqb2bpARQh9ig+EaL9Eu9d27FB-KBTslZIdN0jpGaHHROJZ04cYDonuJHI5WITme-D5IWN0c7e9vtoWdEDb492z7A7+lgdqPLTdxwHEc6V27JWyoR51N8fSVp9tPaSYGc+sj6F7iLFrZpyZQSwki0UEckwFAIBWQYDQDXBAlxmBAA">try out this example</a> in the playground.</p>

<p>For more detailed instructions, visit <a href="https://github.com/reddit/devvit-kit">@devvit/kit</a>.</p>
<h1>Devvit CLI</h1>

<p>The Devvit CLI enables you to create, upload, and manage your apps. It's the bridge between your codebase and Reddit.</p>

<p>:::note
We collect usage metrics when you use the Devvit CLI. For more information, see <a href="https://www.redditinc.com/policies/developer-terms">Reddit’s Developer Terms</a> and the <a href="https://www.reddit.com/policies/privacy-policy">Reddit Privacy Policy</a>. You can opt out at any time by using the <code>devvit metrics off</code> command.
:::</p>

<h2>devvit create icons</h2>

<p>Bundles all <code>SVG</code> files in the <code>/assets</code> folder into a new file (<code>src/icons.ts</code> by default). Enabling you to import local SVG assets in your app code.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit create icons [output-file]
</code></p>

<h4>Optional Argument</h4>

<ul>
<li><p><code>output-file</code></p>

<p>Path to the output file. Defaults to <code>src/icons.ts</code>.</p></li>
</ul>

<h4>Generating the SVG bundle file</h4>

<p>```bash
$ devvit create icons</p>

<p>$ devvit create icons "src/my-icons.ts"
```</p>

<h4>Using the SVG files in app code</h4>

<p>```tsx
import { Devvit } from '@devvit/public-api';
import Icons from './my-icons.ts';</p>

<p>Devvit.addCustomPostType({
  name: 'my-custom-post',
  render: (_context) =&gt; {
    return (
      <blocks>
        <image url={Icons['my-image.svg']} imageHeight="32px" imageWidth="32px" />
      </blocks>
    );
  },
});</p>

<p>export default Devvit;
```</p>

<h2>devvit help</h2>

<p>Display help for devvit</p>

<h4>Usage</h4>

<p><code>bash
$ devvit help
</code></p>

<h2>devvit install</h2>

<p>Install an app from the Apps directory to a subreddit that you moderate. You can specify a version to install or default to @latest (the latest version).</p>

<h4>Usage</h4>

<p><code>bash
$ devvit install &lt;subreddit&gt; [app-name]@[version]
</code></p>

<h4>Required Arguments</h4>

<ul>
<li><p><code>subreddit</code></p>

<p>Name of the installation subreddit. The "r/" prefix is optional.</p></li>
</ul>

<h4>Optional Arguments</h4>

<ul>
<li><p><code>app-name</code></p>

<p>Name of the app to install (defaults to current project).</p></li>
<li><p><code>version</code></p>

<p>Specify the desired version (defaults to latest).</p></li>
</ul>

<h4>Examples</h4>

<p>```bash
$ devvit install r/mySubreddit</p>

<p>$ devvit install mySubreddit my-app</p>

<p>$ devvit install r/mySubreddit my-app@1.2.3</p>

<p>$ devvit install r/mySubreddit @1.2.3
```</p>

<h2>devvit list apps</h2>

<p>To see a list of apps you've published</p>

<h4>Usage</h4>

<p><code>bash
$ devvit list apps
</code></p>

<h2>devvit list installs</h2>

<p>To see a list of all apps currently installed on a specified subreddit.</p>

<p>If no subreddit is specified, you'll get a list of all apps installed by you.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit list installs [subreddit]
</code></p>

<h4>Optional argument</h4>

<ul>
<li><p><code>subreddit</code></p>

<p>Name of the subreddit to look up installations for. The "r/" prefix is optional.</p></li>
</ul>

<h4>Examples</h4>

<p>```bash
$ devvit list installs</p>

<p>$ devvit list installs mySubreddit</p>

<p>$ devvit list installs r/mySubreddit
```</p>

<h2>devvit login</h2>

<p>Login to Devvit with your Reddit account in the browser.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit login [--copy-paste]
</code></p>

<h4>Optional argument</h4>

<ul>
<li><p><code>--copy-paste</code></p>

<p>If present, user will copy-paste code from the browser instead of the localhost.</p></li>
</ul>

<h2>devvit logout</h2>

<p>Logs the current user out of Devvit.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit logout
</code></p>

<h2>devvit logs</h2>

<p>Stream logs for an installation within a specified subreddit.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit logs &lt;subreddit&gt; [app-name] [-d &lt;value&gt;] [-j] [-s &lt;value&gt;] [--verbose]
</code></p>

<h4>Required arguments</h4>

<ul>
<li><p><code>subreddit</code></p>

<p>The subreddit name. The "r/" prefix is optional.</p></li>
<li><p><code>app-name</code></p>

<p>The app name (defaults to working directory app).</p></li>
</ul>

<h4>Optional arguments</h4>

<ul>
<li><p><code>-d &lt;value&gt;, --dateformat &lt;value&gt;</code></p>

<p>Specify the format for rendering dates. Defaults to <code>MMM d HH:mm:ss</code> (Jan 15 18:30:03). See more about format options <a href="https://date-fns.org/v2.29.3/docs/format">here</a>.</p></li>
<li><p><code>-j, --json</code></p>

<p>Output JSON for each log line</p></li>
<li><p><code>-s &lt;value&gt;, --since &lt;value&gt;</code></p>

<p>Specify how far back you want the log streaming to start. Defaults to a <code>0m</code> (now) if omitted.</p>

<p>Supported format:</p>

<ul>
<li><code>s</code> seconds</li>
<li><code>m</code> minutes</li>
<li><code>h</code> hours</li>
<li><code>d</code> days</li>
<li><code>w</code> weeks</li>
</ul>

<p>For example <code>15s</code>, <code>2w1d</code>, or <code>30m</code>.</p></li>
<li><p><code>--verbose</code></p>

<p>Displays the log levels and timestamps when the logs were created.</p></li>
</ul>

<h4>Examples</h4>

<p>```bash
$ devvit logs r/mySubreddit</p>

<p>$ devvit logs mySubreddit my-app</p>

<p>$ devvit logs mySubreddit my-app --since 15s</p>

<p>$ devvit logs mySubreddit my-app --verbose
```</p>

<h2>devvit new</h2>

<p>Create a new app.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit new [directory-name] [-t &lt;value&gt;] [--here]
</code></p>

<h4>Optional arguments</h4>

<ul>
<li><p><code>directory-name</code></p>

<p>Directory name for your new app project. This creates a new directory for your app code. If no name is entered, you will be prompted to choose one.</p></li>
<li><p><code>--template &lt;value&gt;</code></p>

<p>Template name or pen URL. If no template is entered, you will be prompted to choose one.</p></li>
<li><p><code>--here</code></p>

<p>Generate the project here and not in a subdirectory.</p></li>
</ul>

<h4>Examples</h4>

<p>```bash
$ devvit new</p>

<p>$ devvit new tic-tac-toe</p>

<p>$ devvit new tic-tac-toe --template blocks-post</p>

<p>$ devvit new --here
```</p>

<h2>devvit playtest</h2>

<p>Installs your app to your test subreddit and starts a playtest session where a new version is installed whenever you save changes to your app code, and logs are continuously streamed. Press <code>ctrl+c</code> to end the playtest session. Once ended, the latest installed version will remain unless you revert to a previous version using <a href="#devvit-install"><code>devvit install</code></a>. For more information, see the <a href="playtest.md">playtest page</a>.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit playtest &lt;subreddit&gt; [--verbose]
</code></p>

<h4>Required argument</h4>

<ul>
<li><p><code>subreddit</code></p>

<p>Name of a test subreddit with less than 200 subscribers that you moderate. The "r/" prefix is optional.</p></li>
</ul>

<h4>Optional argument</h4>

<ul>
<li><code>--verbose</code></li>
</ul>

<h2>devvit settings list</h2>

<p>List settings for your app. These settings exist at the global app-scope and are available to all instances of your app.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit settings list
</code></p>

<h2>devvit settings set</h2>

<p>Create and update settings for your app. These settings will be added at the global app-scope.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit settings set &lt;my-setting&gt;
</code></p>

<h4>Example</h4>

<p><code>bash
$ devvit settings set my-feature-flag
</code></p>

<h2>devvit uninstall</h2>

<p>Uninstall an app from a specified subreddit.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit uninstall &lt;subreddit&gt; [app-name]
</code></p>

<h4>Required argument</h4>

<ul>
<li><p><code>subreddit</code></p>

<p>Name of the subreddit. The "r/" prefix is optional. Requires moderator permissions in the subreddit.</p></li>
<li><p><code>app-name</code></p>

<p>Name of the app (defaults to the working directory app).</p></li>
</ul>

<h4>Examples</h4>

<p>```bash
$ devvit uninstall r/mySubreddit</p>

<p>$ devvit uninstall mySubreddit</p>

<p>$ devvit uninstall mySubreddit my-app
```</p>

<h2>devvit update app</h2>

<p>Update @devvit project dependencies to the currently installed CLI's version</p>

<h4>Usage</h4>

<p><code>bash
$ devvit update app
</code></p>

<h2>devvit upload</h2>

<p>Upload an app to the App directory. By default the app is private and visible only to you.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit upload [--bump major|minor|patch|prerelease] [--copyPaste]
</code></p>

<h4>Optional arguments</h4>

<ul>
<li><p><code>--bump &lt;option&gt;</code></p>

<p>Type of version bump (major|minor|patch|prerelease)</p></li>
<li><p><code>--copyPaste</code></p>

<p>Copy-paste the auth code instead of opening a browser</p></li>
</ul>

<h2>devvit version</h2>

<p>Get the version of the locally installed Devvit CLI.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit version
</code></p>

<h2>devvit whoami</h2>

<p>Display the currently logged in Reddit user.</p>

<h4>Usage</h4>

<p><code>bash
$ devvit whoami
</code></p>
<h1>Devvit for Pythonistas</h1>

<p>Hey there, Python folks! If you're new to Typescript and React-like concepts, this guide is here to show you important Devvit concepts and explain things in terms of the Python you know and love.</p>

<h2>1. Your first Devvit app: a playground adventure</h2>

<p>Let's start with a simple "Hello World" app using the Devvit playground, which is a handy online code editor.</p>

<ol>
<li><p><strong>Open the playground.</strong> Go to <a href="https://developers.reddit.com/play">developers.reddit.com/play</a>.</p></li>
<li><p><strong>You'll see a code editor and a live preview.</strong> The code editor is where you'll write your app's code, and the live preview will show you what your app looks like in realtime.</p></li>
<li><p><strong>Add the following code.</strong></p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>Devvit.addCustomPostType({
  name: 'Say Hello',
  render: (context) =&gt; {
    const [counter, setCounter] = useState(0);
    return (
      <vstack alignment="center middle" height="100%" gap="large">
        <text size="xxlarge" weight="bold">
          Hello Pythonistas! 👋
        </text>
        <button appearance="primary" onPress={() =&gt; setCounter((counter) =&gt; counter + 1)}&gt;
          Click me!
        </button>
        {counter ? <text>{<code>You clicked ${counter} time(s)!</code>}</text> : <text>&nbsp;</text>}
      </vstack>
    );
  },
});</p>

<p>export default Devvit;
```</p></li>
<li><p><strong>See your app come to life.</strong> The live preview will update automatically as you type, showing you your "Hello, Pythonistas!" message and a clickable button. Each click will increment a counter and display the number of clicks.</p></li>
</ol>

<h2>2. Typescript’s scariest syntax</h2>

<p>Typescript might seem intimidating, but it's just a superset of Javascript. Typescript adds some extra features to make your code more robust and easier to manage. Here's a quick comparison:</p>

<h3>Objects</h3>

<p>Objects in Typescript are basically Python dictionaries.</p>

<p><strong>Python dictionary</strong></p>

<p><code>python
person = { "name": "Alice", "age": 30, "city": "New York" }
</code></p>

<p><strong>Typescript object</strong></p>

<p><code>typescript
const person = {
  name: 'Alice',
  age: 30,
  city: 'New York',
};
</code></p>

<h3>Functions</h3>

<p><strong>Python</strong></p>

<p>```python
def greet(name):
  print(f"Hello, {name}!")</p>

<p>greet("Alice")
```</p>

<p><strong>Typescript</strong></p>

<p>``<code>typescript
function greet(name: string): void {
  console.log(</code>Hello, ${name}!`);
}</p>

<p>greet('Alice');
```</p>

<p>See? Pretty similar! Typescript just adds type annotations (like <code>: string</code> and <code>: void</code>) to define types to help catch errors early.</p>

<h3>Syntactic shortcuts</h3>

<p>Devvit examples use some Typescript shortcuts that might look unfamiliar. Here's a breakdown:</p>

<ul>
<li><p><strong>Object destructuring</strong> lets you extract values from objects and arrays in less code.</p>

<p><code>typescript
const user = { name: 'Bob', age: 30 };
const { name, age } = user; // Now you have variables 'name' and 'age'
</code></p></li>
<li><p><strong>Array destructuring</strong> lets you extract values from an array.</p>

<p><code>typescript
const [user1, user2]  = [“Anne Plank”, “Joe Smith” ]
console.log(user1); // “Anne Plank”
console.log(user2); // “Joe Smith”
</code></p></li>
<li><p><strong>Arrow functions</strong> are a concise way to write functions.</p>

<p>```typescript
// Traditional function
function add(a, b) {
  return a + b;
}</p>

<p>// Arrow function
const add = (a, b) =&gt; a + b;
```</p></li>
</ul>

<h2>3. Typescript: Python's cousin</h2>

<p>Let's break down the code you just wrote. Think of Typescript as Python's cousin who speaks a slightly different dialect, where being grammatically correct and is as important as having the right amount of whitespace. Here's a line-by-line explanation.</p>

<h3>Imports</h3>

<ul>
<li><strong><code>import {Devvit} from '@devvit/public-api'</code>:</strong> This line imports the Devvit library, just like you'd import modules in Python using <code>import</code>. You mainly need this line for simple apps, but you can save a lot of time by importing and using public packages just like you can with pip.</li>
</ul>

<h3>Creating an interactive post</h3>

<ul>
<li><p><strong><code>Devvit.addCustomPostType({...})</code>:</strong> This tells Devvit you're creating a new type of post on Reddit.</p></li>
<li><p><strong><code>name: 'Say Hello'</code>:</strong> This gives your post type a name.</p></li>
<li><p><strong><code>render: context =&gt; { ... }</code>:</strong> This is where the magic happens. The <code>render</code> function defines what your post looks like and how it behaves. It receives a <code>context</code> object that gives you access to Devvit's features.</p></li>
</ul>

<h3>Hooks (the hardest part)</h3>

<ul>
<li><p><strong><code>const [counter, setCounter] = useState(0)</code>:</strong> This line uses a “hook” (in this case, <code>useState</code>). <code>useState</code> creates a special variable that Devvit can track and update automatically. <strong>Unlike a regular variable, when a hook's value changes, Devvit knows to re-render your app that use that value when it changes.</strong></p>

<ul>
<li><code>useState</code> returns two values: the variable itself and a function for setting that variable. (The syntactic trick of object destructuring is used to assign both variables at once here.) Again, every time <code>setCounter</code> is called, the value for counter updates and Devvit is told to re-render the post. This is what makes your app interactive.</li>
<li><code>useState</code> variables are not like plain variables. Plain variables will reset every re-render, and they don’t tell the app to re-render. Hooks solve this problem. In this case, <code>useState(0)</code> creates a variable called <code>counter</code> with an initial value of <code>0</code>. It also gives you a function called <code>setCounter</code> that you can use to update the counter's value.</li>
</ul></li>
</ul>

<p>:::note
Hooks are a concept borrowed from React, and the reason we need hooks is because of the way Devvit renders things. It's is complex, but basically when Devvit renders a view, it does so in several passes. For more info, check out <a href="https://www.reddit.com/r/learnprogramming/comments/8yi54n/please_explain_what_react_is_like_im_5/">what is react</a> and <a href="https://www.reddit.com/r/react/comments/11ftu0p/what_are_hooks/">what are hooks</a>.
:::</p>

<ul>
<li><p><strong><code>return ( ... )</code>:</strong> The <code>render</code> function returns JSX code, which defines the structure of your post's user interface. JSX looks a lot like HTML, but it's actually Javascript/Typescript code that Devvit understands.</p></li>
<li><p><strong><code>&lt;vstack alignment='center middle' height='100%' gap='large'&gt;</code>:</strong> This creates a vertical stack layout. Think of it as a container that arranges its children vertically. The <code>alignment</code>, <code>height</code>, and <code>gap</code> attributes control how the children are positioned within the stack.</p></li>
<li><p><strong><code>&lt;text size='xxlarge' weight='bold'&gt;Hello Pythonistas! 👋&lt;/text&gt;</code>:</strong> This displays the text "Hello Pythonistas! 👋". The <code>size</code> and <code>weight</code> attributes control the text's appearance.</p></li>
<li><p><strong><code>&lt;button appearance='primary' onPress={() =&gt; setCounter(counter =&gt; counter + 1)}&gt;Click me!&lt;/button&gt;</code>:</strong> This creates a button labeled "Click me!". The <code>appearance</code> attribute controls the button's style, and the <code>onPress</code> attribute defines what happens when the button is clicked.</p>

<p>In this case, clicking the button calls the <code>setCounter</code> function, which updates the <code>counter</code> variable by adding 1 to its current value.</p></li>
<li><p><strong><code>{counter ? (&lt;text&gt;{</code>You clicked ${counter} time(s)!<code>}&lt;/text&gt;) : (&lt;text&gt;&amp;nbsp;&lt;/text&gt;)}</code>:</strong> This part uses a ternary operator to conditionally render text based on the value of <code>counter</code>. The ternary operator works like a compact <code>if-else</code> statement.</p>

<p><em>Ternary Operator Breakdown:</em></p>

<ul>
<li><code>condition ? expression1 : expression2</code></li>
<li>If <code>condition</code> is true, <code>expression1</code> is evaluated.</li>
<li>If <code>condition</code> is false, <code>expression2</code> is evaluated.</li>
</ul>

<p><em>Truthiness in Typescript:</em></p>

<ul>
<li>In Typescript (and Javascript), values like <code>0</code>, <code>null</code>, <code>undefined</code>, and <code>''</code> (empty string) are considered "falsy".</li>
<li>All other values are considered "truthy".</li>
</ul>

<p>In this case, the condition is <code>counter</code>. Since <code>counter</code> starts at 0 (which is falsy), the second expression (<code>&lt;text&gt;&amp;nbsp;&lt;/text&gt;</code>) is evaluated, displaying a non-breaking space. After the button is clicked, <code>counter</code> becomes truthy, so the first expression is evaluated, displaying the click count.</p></li>
<li><p><strong><code>export default Devvit;</code>:</strong> This line exports the Devvit object, making your app available to Reddit.</p></li>
</ul>

<h2>3. Node, npm, and npx: Devvit's power tools</h2>

<p>To run Devvit code outside the Playground tool, you'll need a few extra tools:</p>

<ul>
<li><p><strong>Node.js:</strong> Node.js is like a special Python interpreter for Javascript/Typescript. It lets you run this code on your computer, not just in a web browser.</p>

<p><strong>Python analogy:</strong> Node.js is to Javascript/Typescript what the Python interpreter is to Python code.</p></li>
<li><p><strong>npm:</strong> npm is like <code>pip</code> for Javascript/Typescript. It's a package manager that lets you install and manage libraries (like Devvit).</p>

<p><strong>Python analogy:</strong> npm is to Javascript/Typescript what <code>pip</code> is to Python packages.</p></li>
<li><p><strong>npx:</strong> npx is a handy tool that comes with npm. It lets you run commands from packages you've installed without having to add them to your system's PATH.</p>

<p><strong>Python analogy:</strong> Imagine you could run a command from a Python package directly without having to install it globally. That's what npx does for Javascript/Typescript packages.</p></li>
</ul>

<h2>4. Installing the power tools</h2>

<ol>
<li><p><strong>Install Node.js.</strong> Download and install Node.js from <a href="https://nodejs.org/">https://nodejs.org/</a>.</p></li>
<li><p><strong>You get npm for free.</strong> npm is included with Node.js, so you don't need to install it separately.</p></li>
<li><p><strong>Install Devvit.</strong> Open your terminal and run <code>npm install -g devvit</code>.</p></li>
</ol>

<h2>5. Exporting your app from play</h2>

<p>Now let's bring your "Hello World" app from the Playground tool to your computer:</p>

<ol>
<li><p><strong>Click the "Export" button in the Play tool.</strong> This will copy a command to your clipboard.</p></li>
<li><p><strong>Open your terminal and paste the command.</strong> The command will look something like this:</p>

<p><code>bash
npx devvit new my-hello-world-app --template=&lt;your-playground-url&gt;
</code></p></li>
<li><p><strong>Run the command.</strong> This will create a new folder on your computer containing your "Hello World" app.</p></li>
</ol>

<h2>6. Embrace the Devvit playground</h2>

<p>The Devvit playground is a Pythonista's best friend. It lets you test your code in real-time, so you can experiment and iterate quickly. Don't be afraid to break things and try new ideas.</p>

<h2>7. Keep Learning and Exploring</h2>

<p>This is just the beginning. Devvit has a ton of features and capabilities, and you can join the Devvit community for help and inspiration. You'll be building amazing Reddit apps in no time!</p>
<h1>@devvit/kit</h1>

<p>Devvit Kit is a helper library that makes it easier to build Devvit apps. Kit includes both UI components and general backend patterns that simplify common tasks and enable developers to build apps faster.</p>

<p>You can find instructions on how to install and use @devvit/kit <a href="https://github.com/reddit/devvit-kit">here</a>.</p>

<h2>Available helpers</h2>

<p>| Name                                                                                             | Description                                                                                  |
| ------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------- |
| <a href="https://github.com/reddit/devvit-kit/blob/main/src/columns/readme.md">Columns</a>                  | Provides a simple column layout and optionally lets you specify gap sizing between elements. |
| <a href="https://github.com/reddit/devvit-kit/blob/main/src/item-pagination/readme.md">Items pagination</a> | Enables pagination of data, including a UI for navigating through the elements.              |
| <a href="https://github.com/reddit/devvit-kit/blob/main/src/dev-toolbar/readme.md">Dev toolbar</a>          | Adds a toolbar of actions only visible to developers.                                        |</p>

<h2>Example</h2>

<p>Once @devvit/kit is installed, you can use the components in your app. This example uses the <code>Columns</code> component.</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';
import { Columns } from '@devvit/kit';</p>

<p>Devvit.addCustomPostType({
  name: 'Columns static content',
  render: () =&gt; {
    return (
      <vstack padding="medium">
        <Columns columnCount={2} gapX="5px" gapY="10px" order="column">
          <hstack backgroundColor="grey">
            <text>Birds</text>
          </hstack>
          <hstack>
            <text>Raven</text>
          </hstack>
          <hstack>
            <text>Parrot</text>
          </hstack></p>

<pre><code>      &lt;hstack backgroundColor="grey"&gt;
        &lt;text&gt;Dogs&lt;/text&gt;
      &lt;/hstack&gt;
      &lt;hstack&gt;
        &lt;text&gt;Bulldog&lt;/text&gt;
      &lt;/hstack&gt;
      &lt;hstack&gt;
        &lt;text&gt;Poodle&lt;/text&gt;
      &lt;/hstack&gt;
    &lt;/Columns&gt;
  &lt;/vstack&gt;
);
</code></pre>

<p>},
});
```</p>

<p>You can also <a href="https://developers.reddit.com/play#pen/N4IgdghgtgpiBcIQBoQGcBOBjBICWUADgPYYAuABMACIwBudeZAvhQGYbFQUDkAAgBN6jMgHpCAVwBGAGzxYAtBEJ4eAHTAaNtBkwB0EAQIDCEtGS4AFYuYAqAT0IwAFMA0UKkWPF7HiMiSgwNApzCDJ5CixiMDIYWJ5kdwoMeKEMH2cASgoAXgA+KmSPVLIJDDAKZ2KPCgAeOjCsAGsKQkMBPDAAc1y1EFhOwP78mtr6vwCgkOipsD8JWNzgACZWbuUADT6QAFZCAA9+ig3CAE0dgEYABkPj0nSd2cDNEFHK8c+xz7qACybWlIIC1upxFiZ-KQdqCYPYRt9PvU4gcyPkAEJ4DACNB1UTI1EI2q4-5kYHNd6I8Z-AEUylU-H5ABKEDo8VxDMJHmJNM59RJZNpdK5DMsEAwnDI7JgKMFlO5pJa7151IVgLJoOI4MmUP6MLhb15wulqOoxG6OLxxtliPlAuV-MVhqRVrREhkMgEZqlMuVogd5PtPI+QudMusxAEMhg3oJwblfqDIcJuMmLzQ1vqokaqtlWQA3BpmFktJpSyXy2XKyW2IssBEYicYGQAMqEORkCI9ABitfrYGcDxgGQojLSQ663QA8lih1kfK3253uj2wHW8A23B88GwqoOMHlcrleM8gjwcpvxqVypU0G2mABJOJQNAFj7MZLb3cz-eHo88E9gAobB4O6Z5FHGV4VKEd5kI+MDPqmQRdiBMivh475bjuA7fgeR79JwADu-TnjUkE3jBcHPoyxAEWhFAYR4oiiCkY77jEMBRP4LwUBAIQQBQQhsBAbqUFIMC-Cy67lMkZFVEw8FoDkBQUAA2ipegafJz4ALraa+GEaNKJDkJxwSUIhwR5FUhCcIQaA+DoIh6GiMjEC0fhEOxsSWLZOIWWgPnEHZ+RzhQABSzabHoACiUawLEeSFBeFCfs4ACENlBWgehYL8IECKklQAD5FRQaUAILihA9h6HgaCVRg1XOJldk5XlHqFVkJEQU2171PkwAtdluX5YVzC4vkdEMaZ5gUHuVlDXo80lceXGnnR0RmZxcwLAlR6LQBu2UIU1wUAA-G0vk5Wt8yaglPiXBtMSzVAEAHNRBEhPtV2ve9NEhAAZADl1ZXov0fSEJ3nSDrXg-9FA+PeYDAWATD2E9W2nJshwLVdWPQwAcoEYkYM1eNbHot7ts4PCHGeKnXNpOQ+NcGOzVj854AAXjAlh4AcMAyF9JxbDjQMi4Q2MHBQUMXQABgAJMAWOHMwhxywjvC3AcPBs5QpxnDj32gwbhPE0OZMm8oZyUzBNN01kDNM5rrPJJt7PW5zPN8wLQtWQbYvAwH0uyxQivK9bqvq5rPDa7rbvPZQVNMEuK5rg2R7dE2C4pxOad9th6T5gnW0AcLycdnnvbrv2B3tQV8TINtLxHU3cOfcXHzu-4MB6K53TOGXnclL1UHVHGKpkhQBF4AIZC-MsNzXMwGbAGXYPKM4g83U3AFI0IBxKUlhKyePIZ1BmiJrzd+-SjLFCneLk8tNPs-z8sWMr7airTef2ZTzPOeC9gBLwoMxQ6d0WAnEIpfSk185gb0IFvLSTdCK30PolcCIZESnydDaWB2CqBoLAAfe+j9gbP1aL8GAeBui-DIB-a2X8Ew5l-oQz4wAtJsPYZmAhlJh7sKLNw+M-9HRxhtKIWBAjxhCJqN-AMHxO7MFfIZA4xlKA1lXH2aC7ZKI4lsPkZwXRJBkB8LYFS2ld43Xsp4c2GA25vQhj4MAdjQrmO0hYrBM1KC-T0dQOqbZqowAEFZAAsuEX4YMuhn1qO3L6h4KBIxRmjaGxiJBkD7vEbo89NZlwoAAKgoHEpIcY0kZKjD0eeyQBHu0oFpNAthiD+PMBgPAUh0kcSPGUymcgsAuGuA4g4fiAkyCCQIGpicTgSDFBAWIMBgl6KRhZMJES9BsFcqQIxT4GlNLqmQVp7S4iZMqb8MBzdpgCKjJQToLS2kdIhIsSgR5XZd0makNAIkzEWM8UeBqTUh41DWShZwLj3TFjjIgreR9VJMzomwUgVQrkpSsqzZFdRznBDzClAA1Ni7q4xamhFJOQdBVkbn7LuXEB5sQ6IeEJfUgAMjANgZAjpWXqY05pFLDm9wqdk05CgBJ7IOfco6tLvEYrQEyllVk8mCrwOK+l2zGnlSMHkb4jLmWssgRQAApJK6VlALrdGmY1OZCztlLJuhQbFFBLiaxNTM81AhFm3TmOK95IkVJ4G0uy5Vuzbk8p6fIFwYQSUkOlE3MNsEI3S1tRy4gqrxnivJSKqlbLsVdP9UmqaMlR6VE9TIMg+kSxGVIBo6uDYK56Isshd0dQDFGLACYr5ljJXOLsYMpxtioAkzcd831yVCW+O2c0wJ9hgkrPnlE-sNQ4m4UScjLoKSLrdL5TknweTCnFJqGurJVTFF6xYh8otrafkUD+fYbecxFKAuAu6EFboZDgvGJC7ImCLGXKbFEcohVtVzBRXRJFWBf3xDIB9QDyR4X7mcEivAgG0VFLesMqmYysV4Fxfi2oqUQPijAxB-IR44lYYJaB2IEHnnirpWR-93FM12vFWwwtZAVK4b-RZbSehJBoF+E2kx3rYU1DY-hmiNqjyPWSNNWSzGS2ljLSZTR6dyK6O2R9BthiymtqsTejtvahxdv+rpvtZ7B0lxesh0dIyxlTsiVAaJc7HHw1-Iu5JZB7CpObek45-LcnWIKUhv6n0SnjD3Sc6pR7mMmaspe69aYX21CBQ+0Fz7AWvSQe+5Sn6gPfuE7EZZlGoMItg9++DlHEMjoUmO0ZE6BDocw14jwOGaPLMI5KkjtRcu0aCJBuMTGYAnpY51jjXGzC8bKQJ6RP68N5etfRiTb481lCgjJwsFZ5OUDc04CgzZua835oLYW4cXF6YwGrA4csVFgHWxQTbHFRwRtaT0ac6QrL9AAscUqb2bpARQh9ig+EaL9Eu9d27FB-KBTslZIdN0jpGaHHROJZ04cYDonuJHI5WITme-D5IWN0c7e9vtoWdEDb492z7A7+lgdqPLTdxwHEc6V27JWyoR51N8fSVp9tPaSYGc+sj6F7iLFrZpyZQSwki0UEckwFAIBWQYDQDXBAlxmBAA">try out this example</a> in the playground.</p>

<p>For more detailed instructions, visit <a href="https://github.com/reddit/devvit-kit">@devvit/kit</a>.</p>
<h1>Dimensions</h1>

<p>Create responsive interactive posts.</p>

<p>Dimensions provides a way for you to create responsive interactive posts by giving you the dimensions of the root node as part of the context object. This lets you write responsive interfaces based on the space available within the context object.</p>

<p>Dimensions are dynamic and update in real time if the device or viewport changes. You can also resize your screen as you develop to see how your posts respond in real time. This is the same post displayed on a phone (left) and a tablet (right):</p>

<p><img src="./assets/custom-posts/custom-posts-dimensions.png" alt="A post that is aware of its size" /></p>

<p>You can use dimensions to:</p>

<ul>
<li>Show a different experience on mobile compared to desktop (e.g., one column on mobile and two columns on desktop)</li>
<li>Use pixel-based calculations for precision where percentages won’t work.</li>
</ul>

<h2>Getting dimensions</h2>

<p>Dimension information is specified in density-independent pixels. These pixel units are located on the context object.</p>

<p>| Dimension | Description                                                                                                                                                                |
| --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Height    | The pixel unit height of the interactive post. This is a fixed value that will not change based on the height property provided on <code>Devvit.addCustomPostType</code>.             |
| Width     | The pixel width of the containing box for your interactive post.                                                                                                           |
| Scale     | The <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio">pixel scale</a> that determines the resolution for how your custom post renders on the device. |</p>

<h2>Example</h2>

<p>This example shows a custom post that specifies dimensions.</p>

<p><code>tsx
Devvit.addCustomPostType({
  name: 'Dimensions app',
  render: (context) =&gt; {
    return context.dimensions?.width &lt; 300 ? &lt;SmallApp /&gt; : &lt;BigApp /&gt;;
  },
});
</code></p>

<p>This example shows that dimensions always references the root element, even if it’s in a child element. Although <code>MyHeader</code> is a component within the root element, this does not change the custom post dimensions provided in the context object.</p>

<p>```tsx
export const MyHeader: Devvit.BlockComponent = (props, context) =&gt; {
  // Dimensions reflect the custom post, not the Header component
  const dimensions = context.dimensions;
  return (
    <vstack
      width={dimensions?.width &lt; 500 ? '300px' : '500px'}
      height="20px"
      backgroundColor="blue"
    &gt;
      <text>Header</text>
    </vstack>
  );
};</p>

<p>Devvit.addCustomPostType({
  name: 'Name',
  render: (_context) =&gt; {
    return <MyHeader />;
  },
});
```</p>

<h2>Limitations</h2>

<ul>
<li>Dimensions are only for the custom post box.</li>
<li>Dimensions for specific elements within the custom post box are not supported.</li>
<li>Dimensions for specific device screen sizes (phone, tablet, desktop) are not supported.</li>
</ul>
<h1>Get discovered</h1>

<p>As a developer, you have the power to create a Reddit community around your app. Whether it’s a game or just a place where you want feedback on your newest creation, the subreddit is yours.</p>

<h2>Learn to mod</h2>

<p>To get started, check out the ultimate guide to <a href="https://redditforcommunity.com/ultimate-guide-to-building-a-community-reddit">building a new community</a> on Reddit. You can learn best practices for things like how to gain community members, how to set up community rules, add icons and banners, use flairs, and more.</p>

<p>Or if you don’t feel like reading a novel, we’ve got a bite-sized <a href="https://redditforcommunity.com/video-lab-making-your-new-subreddit-100">video series</a> that will help you get started and learn best practices along the way.</p>

<h2>Get support</h2>

<p>If you’re not already a member, come join our developer subreddit <a href="https://www.reddit.com/r/Devvit/">r/devvit</a> and our <a href="https://discord.com/invite/R7yu2wh9Qz">Discord server</a>. You can chat with other devs and ask questions about growing your community.</p>

<h2>SEO optimization</h2>

<p>Tips coming soon!</p>
<h1>A - Z</h1>

<p>| <strong>Word</strong>           | <strong>Definition</strong>                                                                                                                                                                                                                                                                                                                                 |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <em>Apps</em>             | Apps are Devvit projects that customize the Reddit experience. They are: <ul><li>made up of one or more <em>actors</em></li><li>versioned</li><li>publishable to the Devvit marketplace</li><li>installable into subreddits (and eventually user accounts)</li><li>at the end of the day, just code that is suitable to be stored in a repo</li></ul> |
| <em>CLI</em>              | A command line interface (CLI) is a text-based user interface (UI) used to run programs, manage computer files, and interact with the computer.                                                                                                                                                                                                |
| <em>Devvit ecosystem</em> | The Devvit ecosystem consists of a CLI tool to aid in app lifecycle (creation through publication), a Developer Portal to distribute apps, and a platform that allows apps to be run at scale on Reddit hardware.                                                                                                                              |
| <em>IDE</em>              | An integrated development environment (IDE) is a software application that helps programmers develop software code efficiently.                                                                                                                                                                                                                |
| <em>Moderator</em>        | A moderator, or a mod for short, is a redditor who volunteers their time to help guide and create Reddit's many communities.                                                                                                                                                                                                                   |
| <em>Node.js</em>          | Node.js is an open-source, cross-platform, back-end JavaScript runtime environment that lets developers use JavaScript to write command line tools and for server-side scripting.                                                                                                                                                              |
| <em>Plugins</em>          | Plugins are <em>actors</em> internal to Devvit. They are included in the runtime, meaning they're available to any actor in any app. They provide useful functions such as making RedditAPI calls, accessing a Devvit-provided Key Value Store, scheduling other actors, and more.                                                                    |
| <em>Protobuf</em>         | Protocol Buffers (Protobuf) is a free and open-source cross-platform data format used to serialize structured data. It provides a language-neutral, platform-neutral, extensible mechanism for serializing structured data in a forward-compatible and backward-compatible way.                                                                |
| <em>Version control</em>  | Version control, also known as source control, is the practice of tracking and managing changes to software code.                                                                                                                                                                                                                              |
| <em>yarn/npm</em>         | Package managers for Node.js                                                                                                                                                                                                                                                                                                                   |</p>
<h1>Guidelines</h1>

<p>Your app must comply with all applicable Reddit policies, which include the Reddit <a href="https://www.redditinc.com/policies/developer-terms">Developer Terms</a> and <a href="https://www.redditinc.com/policies/data-api-terms">Data API Terms</a>, as well as our <a href="https://www.redditinc.com/policies/">User Agreement</a>, <a href="https://www.reddit.com/policies/privacy-policy">Privacy Policy</a>, <a href="https://www.redditinc.com/policies/content-policy">Content Policy</a> and <a href="https://redditinc.force.com/helpcenter/s/article/Reddit-Advertising-Policy-Restricted-Advertisements">Advertising Policy</a> (“Reddit Terms &amp; Policies”). Based on these policies, Reddit may review your app prior to hosting it, and/or take enforcement actions ranging from temporary suspension to permanent removal of your app, blocking your access to Reddit's Developer Platform, or suspending your developer account.</p>

<h2>Copycats</h2>

<p>We want apps built on Reddit’s Developer Platform to be unique and solve real use cases for communities and their users.</p>

<p>Apps should:</p>

<ul>
<li><strong>Be original and innovative.</strong> We know you have great ideas and can’t wait to see how you introduce new features or improve existing ones in a meaningful way.</li>
<li><strong>Respect intellectual property.</strong> Be fair to others. Don’t copy code, UI, images, or logos from other apps without permission and respect existing trademarks.</li>
<li><strong>Not cause confusion.</strong> Apps that impersonate another app, developer, or service are prohibited. This includes cloning apps or suggesting that an app is another app that already exists.</li>
</ul>

<p>Copycat apps that violate any of these guidelines are subject to removal from the portal at any time, and developers who egregiously violate these policies may be removed from the program.</p>

<p>:::note
If you believe an app is in violation of any of the guidelines above, please report it to the Developer Platform team.
:::</p>

<h2>User-generated content</h2>

<p>Apps that accept and display user-generated content (UGC) need to follow Reddit’s broader guidelines around UGC. When an app accepts UGC, it should create a new post or comment with the UGC author clearly identified as the author of the submitted content.</p>

<p>:::note
New content will be posted as the app account until the app has been approved by the Developer Platform team. After that, submitPost will post on behalf of the UGC author.
:::</p>

<h3>Live posts</h3>

<p>If an app allows users to create UGC by interacting with a live post (for example, a form submission that modifies live content), the app should limit the forms of expression available to prevent potential abuse. Appropriate examples of limited expression include:</p>

<ul>
<li>Emojis</li>
<li>Predefined dictionaries (like stock ticker symbols or a safe dictionary)</li>
</ul>

<p>Avoid allowing free-form text input for user interactions with UGC to minimize the risk of abuse.</p>

<h3>Deleting user content</h3>

<p>Apps should adhere to the <a href="#content-deletion-policy">content deletion policy</a>, ensure that users have the ability to remove their own content when desired, and that the app complies with any legal requirements related to content removal.</p>

<p>Being able to safely accept UGC is a key criteria during app review. If there are apps that you feel require exceptions to these guidelines please reach out.</p>

<h2>Content deletion policy</h2>

<p>You are required to remove any user content that has been deleted from Reddit from your Devvit app. We provide access to post and comment delete events via <a href="https://developers.reddit.com/docs/event_triggers">triggers</a> to help facilitate this.</p>

<p>On <code>PostDelete</code> and <code>CommentDelete</code> event triggers, you must delete all content related to the post and/or comment (for example, title, body, embedded URLs, etc.) from your app. This includes data that is in the Redis/KVstore and data sent to an external service. Metadata required for contextualizing related content (for example, post or comment ID, createdAt, etc.) may be retained.</p>

<p>When a user account is deleted, the related user ID (t2_*) must be completely removed from your hosted datastores (e.g. Redis) and any external systems. You must also delete all references to the author-identifying information (i.e. the author ID, name, profile URL, avatar image URL, user flair, etc.) from posts and comments created by that account. You may continue to keep posts and comments created by deleted accounts, provided that the posts and comments have not been explicitly deleted.</p>

<p>To best comply with this policy, we recommend deleting any stored user data within 30 days. For any data you are storing in Redis, you can use the <a href="./capabilities/redis.md#key-expiration">expire function</a> to ensure data gets deleted automatically.</p>

<p>:::note
Retention of content and data that has been deleted, even if disassociated, de-identified or anonymized, is a violation of our terms and policies.
:::</p>

<h2>Using external sites or services in Devvit Apps</h2>

<p>If your app links to any third-party site that may collect redditor personal data or that facilitates financial transactions, you are solely responsible for verifying the legitimacy and security of the third-party site(s) and should ensure that they are in compliance with all applicable laws. For example, you should ensure that:</p>

<ul>
<li>a charitable organization collecting donations is registered as a 501(c)(3) organization (or local equivalent) and provides necessary tax receipts;</li>
<li>a site collecting personal data provides a privacy policy that clearly discloses what data is collected, how the data is used, and how the data is shared.</li>
</ul>

<p>Additionally, to the extent that you intend to include links to such third-party sites, you must provide your own terms of service and privacy policy.</p>

<h2>Using Large Language Models in Devvit Apps</h2>

<p>Your Devvit apps can use approved Large Language Models (“LLMs”) via fetch functionality, provided your app adheres to the following guidelines as well as all applicable Reddit terms and policies, including our <a href="https://www.redditinc.com/policies/developer-terms">Developer Terms</a> and <a href="https://www.redditinc.com/policies/developer-dpa">Developer Data Protection Addendum</a>, as well as our <a href="https://www.redditinc.com/policies/">User Agreement</a>, <a href="https://www.reddit.com/policies/privacy-policy">Privacy Policy</a>, <a href="https://www.redditinc.com/policies/content-policy">Content Policy</a>, <a href="https://support.reddithelp.com/hc/en-us/articles/26410290525844-Public-Content-Policy">Public Content Policy</a>, and <a href="https://redditinc.force.com/helpcenter/s/article/Reddit-Advertising-Policy-Restricted-Advertisements">Advertising Policy</a> (collectively, “Reddit Rules”). Your app:</p>

<ul>
<li>Provides significant and unique benefits to redditors and Reddit communities;</li>
<li>Uses one of the approved LLMs listed below;</li>
<li>Does not use Reddit data to create, improve, modify, train, or fine-tune any generative AI, LLM, ML, or NLP models (collectively, “Model Training”);</li>
<li>Does not provide access to or otherwise enable any third party to use Reddit data for Model Training;</li>
<li>Includes terms of services and a privacy policy for handling Reddit data; and</li>
<li>Adheres to all other rate limits and guidelines as outlined in our <a href="https://www.redditinc.com/policies/developer-terms">Developer Terms</a> and other Reddit Rules.</li>
</ul>

<h3>Approved LLMs:</h3>

<p>Below are the only LLMs approved by Reddit for use:</p>

<ul>
<li>Google LLMs (e.g., Gemini)</li>
<li>OpenAI LLMs (e.g., ChatGPT)</li>
</ul>

<p>For the avoidance of doubt, self-hosted and other LLMs (e.g. Llama, Mistral) are not approved for use at this time.</p>

<p>Reddit reserves the right to update these guidelines, including our list of approved LLMs, at any time and at our discretion. As always, it is your responsibility to ensure your app is compliant with the Reddit Rules and our latest guidelines.</p>

<h2>Devvitquette</h2>

<p>Do:</p>

<ul>
<li>Remember the human, community, and your fellow devs
<ul>
<li>Build with the ecosystem in mind - provide discrete functionality and always try to add value</li>
<li>Be reliable - maintain work that communities rely on, communicate when you cannot, and make it easy to contact you for support</li>
<li>Provide transparency - use clear naming and descriptions that accurately describe your app's functionality, purpose, and data practices</li>
<li>Respect Redditors' data and privacy - make sure you get consent and appropriate permissions before processing data, or taking any actions (automated or not) on Redditors' behalf; and only use the necessary data for your app's stated functionality</li>
<li>make sure your app complies with our <a href="https://www.redditinc.com/policies/moderator-code-of-conduct">moderator code of conduct</a></li>
</ul></li>
<li>Facilitate successful deployment
<ul>
<li>Consider inclusion/exclusion lists if your app is not installed on the subreddit level</li>
<li>Test your app locally and in sandbox subreddits when applicable</li>
</ul></li>
<li>Let us know if your app is compromised (e.g., data breach, unauthorized access)</li>
</ul>

<p>Don’t:</p>

<ul>
<li>Break any rule outlined in Reddit’s Terms &amp; Policies - make sure your app doesn't:
<ul>
<li>Facilitate, promote nor amplify any form of harassment, violence or hateful activities</li>
<li>Engage in nor enable the manipulation of Reddit's features (e.g., voting, karma) or the circumvention of safety mechanisms (e.g., user blocking, account bans)</li>
<li>Promote deceptive content (e.g., spam, malware) nor facilitate adverse actions that may interfere with the normal use of Reddit (e.g., introducing malicious code or programs that violate Reddit Terms &amp; Policies)</li>
<li>Mislead Redditors about your relationship with Reddit or any other person or entity</li>
<li>Infringe on others' intellectual property rights, nor make it easier to violate others' privacy</li>
<li>Enable the distribution of harmful content or the facilitation of illegal or legally restricted activities</li>
<li>Expose Redditors to graphic, sexually-explicit, or offensive content without proper labeling</li>
<li>Allow others to break any of the rules in Reddit Terms &amp; Policies</li>
</ul></li>
<li>Write programs that respond to generic words or event types</li>
<li>Create an app or functionality for use in or that targets services in a prohibited or regulated industry such as (but not limited to) gambling, healthcare, financial and cryptocurrency products and services, political advertisement, alcohol, recreational drugs, or any other restricted category listed in the <a href="https://redditinc.force.com/helpcenter/s/article/Reddit-Advertising-Policy-Restricted-Advertisements">Reddit Advertising Policy</a></li>
<li>Process account data to infer Redditors' personal characteristics, such as racial or ethnic origin, political opinions, religious or philosophical beliefs, union membership, genetics or biometrics, health, sex life, or sexual orientation</li>
<li>Gather intelligence nor attempt to track Redditors or Reddit content for the purpose of surveillance, and/or to provide that information to governments or other entities conducting surveillance</li>
<li>Intrude on Redditors' privacy and autonomy in spaces your app isn't authorized to access or moderate</li>
<li>Request that Redditors share their login credentials or any other personal information to access or complete any action through your app</li>
<li>Attempt to publish an app targeting anyone under 13 -- Redditors must all be over the age of 13 to use the platform!</li>
<li>Attempt to circumvent any safety or security enforcement measures Reddit may have taken, including against your app</li>
</ul>
<h1>Help</h1>

<p>The best place to get help is from one of our communities!
Our subreddit, <a href="https://reddit.com/r/devvit">r/devvit</a>, is a great place to discuss the platform, ask common questions, or share information about your app. This is also where we share important information and updates.</p>

<p>For quick troubleshooting or live support we recommend posting in our <a href="https://discord.com/invite/R7yu2wh9Qz">Discord server</a>. The devvit team and expert users (aka the Devvit Ducks 🪿) are usually quick to reply. The server is also where we host office hours.</p>

<p>We’re always happy to offer more dedicated support in the form of live coding sessions or a private space to iterate on your project. If this is of interest to you, please reach out in one of the communities above.
Please read the community rules before participating.</p>

<p>To file a feature request or submit a bug, you can use our <a href="https://github.com/reddit/devvit/issues">public issues tracker</a>. We recommend also notifying the team if you are blocked by a lacking feature or bug.</p>
<h1>Build a blocks post</h1>

<ol>
<li>Login to Devvit.</li>
<li>Start a new project.</li>
</ol>

<p><code>tsx
devvit new &lt;my-project&gt;
</code></p>

<ol start="3">
<li>Select the <code>blocks-post</code> template. (if you're familar with webviews, you can use <code>webview-post</code>)</li>
<li>Navigate to your project directory.</li>
</ol>

<p><code>tsx
cd &lt;my-project&gt;
</code></p>

<ol start="5">
<li><p>If you want to add some additional flair to the template code, edit the <code>src/main.ts</code> file and save your changes.</p></li>
<li><p>Upload your project.</p></li>
</ol>

<p><code>tsx
devvit upload
</code></p>

<ol start="7">
<li>Use playtest to check out your interactive post on a test subreddit that you moderate.</li>
</ol>

<p><code>tsx
devvit playtest &lt;your-test-subreddit-name&gt;
</code></p>

<ol start="8">
<li>Go to your test subreddit to see your interactive post (you might need to hit refresh).</li>
</ol>

<p><img src="./assets/experience-post-example.png" alt="experience_post" /></p>

<p>When you're done iterating, you can <a href="dev_guide.mdx#9publish">publish</a> your app and then make it <a href="dev_guide.mdx#10gopublic">public</a>.</p>
<h1>Overview</h1>

<p>Interactive posts allow you to build apps like <a href="./showcase/apps.mdx#livescores">live scoreboards</a>, <a href="./showcase/playgrounds.mdx#polls">polls</a>, or <a href="./community_games.md">community games</a> on Reddit. This guide will help you understand how to build them effectively.</p>

<h2>What’s supported</h2>

<p>|               | Supported                             |
| ------------- | ------------------------------------- |
| <strong>Platform</strong>  | Android, iOS, and web                 |
| <strong>Surface</strong>   | Post details page and subreddit feeds |
| <strong>Media</strong>     | Uploading image files                 |
| <strong>Post type</strong> | One custom post type per project      |</p>

<h2>Templates</h2>

<p>Devvit provides two interactive post templates:</p>

<ul>
<li><code>blocks-post</code> to create an interactive post with blocks.</li>
<li><code>web-view-post</code> to create an interactive post that uses web views.</li>
</ul>

<p>You can also create your own interactive post from scratch.</p>

<h3>Devvit blocks</h3>

<p><a href="./blocks/overview.mdx">Blocks</a> is a Reddit native declarative UI framework that provides:</p>

<ul>
<li>✅ Reddit-styled components</li>
<li>✅ Cross-platform compatibility</li>
<li>✅ Optimized for performance</li>
<li>✅ Simple, declarative syntax</li>
</ul>

<p>Perfect for: Polls, scoreboards, simple &amp; fast interactive games</p>

<p>You can see code examples of apps built with blocks <a href="./showcase/apps.mdx">here</a> or in our <a href="https://developers.reddit.com/play">playground</a>.</p>

<h3>Webviews</h3>

<p><a href="./webviews.md">Webviews</a> lets you use standard web technologies:</p>

<ul>
<li>✅ HTML, CSS, JavaScript</li>
<li>✅ Rich multimedia support</li>
<li>✅ Advanced animations</li>
</ul>

<p>Perfect for: Games, complex visualizations, rich interactions</p>

<p>You can find some webview example games <a href="./webviews.md#examples">here</a></p>

<h1>Should I use blocks or webviews?</h1>

<p>Here’s a comparison between the two:</p>

<p>| Feature                                    | Webviews | Blocks |
| ------------------------------------------ | -------- | ------ |
| Uses Reddit design system                  | ❌       | ✅     |
| Optimized for in-feed experience           | ❌       | ✅     |
| Rich multimedia (animations, video, audio) | ✅       | ❌     |
| Advanced gestures                          | ✅       | ❌     |</p>

<p><strong>Choose blocks if you:</strong></p>

<ul>
<li>Want a Reddit-native look and feel</li>
<li>Prefer a simpler, more constrained API</li>
<li>Need optimal feed performance</li>
</ul>

<p><strong>Choose webviews if you:</strong></p>

<ul>
<li>Are experienced with web development</li>
<li>Need rich multimedia or advanced interactions</li>
<li>Want full control over styling and behavior</li>
</ul>

<h2>Creating an interactive post</h2>

<h3>1. Define your post type with <code>addCustomPostType</code></h3>

<p>The <code>.addCustomPostType(customPostType: CustomPostType)</code> function contains:</p>

<ul>
<li>name of the post type</li>
<li>an optional description</li>
<li>render to return the UI for the interactive post using:
<ul>
<li><a href="./blocks/overview.mdx">blocks</a>, or</li>
<li>the <a href="webviews.md">webviews</a> component, which looks for files in the project’s <code>webroot/</code> directory</li>
</ul></li>
</ul>

<p>:::note
The UI is wrapped in <code>&lt;blocks&gt;</code>. If you don’t include them, <code>&lt;blocks&gt;</code> will be automatically added.
:::</p>

<p>```ts
// blocks
Devvit.addCustomPostType({
 name: 'My Custom Post Type',
 description: 'A big hello text.',
 render: () =&gt; {
   return (
     <blocks height="regular">
       <vstack>
         <text style="heading" size="xxlarge">
           Hello!
         </text>
         <button icon="heart" appearance="primary" />
       </vstack>
     </blocks>
   );
 },
});</p>

<p>// webviews
Devvit.addCustomPostType({
 name: 'My Custom Post Type',
 description: 'A big hello text.',
 render: () =&gt; {
   return (
     <blocks height="regular">
       <webview page="index.html">
     </blocks>
   );
 },
});</p>

<p>```</p>

<h3>2. Add a menu item to create your post</h3>

<p>Once the interactive post has been submitted and instantiated, it needs a place for users to call it for creation. This example uses the subreddit menu.</p>

<p>The <code>.addMenuItem(menuItem: MenuItem)</code> function has these parameters:</p>

<ul>
<li>label for the text users will see</li>
<li>location to indicate where the menu item will be</li>
<li>onPress handler, which specifies what happens when the menu item is pressed</li>
</ul>

<p><strong>Example</strong></p>

<p><code>ts
Devvit.addMenuItem({
  location: 'subreddit',
  label: 'Add a poll',
  onPress: async (_, context) =&gt; {
    const currentSubreddit = await context.reddit.getCurrentSubreddit();
    await context.reddit.submitPost({
      title: 'My custom post',
      subredditName: currentSubreddit.name,
      preview: (
        &lt;vstack&gt;
          &lt;text&gt;Loading...&lt;/text&gt;
        &lt;/vstack&gt;
      ),
    });
    context.ui.showToast(`Submitted custom post to ${currentSubreddit.name}`);
  },
});
</code></p>

<h3>3. Create post submission with <code>submitPost</code></h3>

<p>The <code>submitPost(options: SubmitPostOptions)</code> function has these parameters:</p>

<ul>
<li>title for the name of the interactive post</li>
<li>subredditName to show where the post will be instantiated</li>
<li>preview to provide a lightweight UI that shows while the post renders (required)</li>
</ul>

<p><strong>Example</strong></p>

<p><code>ts
await reddit.submitPost({
  title: 'My custom post',
  subredditName: currentSubreddit.name,
  preview: (
    &lt;vstack&gt;
      &lt;text&gt;Loading...&lt;/text&gt;
    &lt;/vstack&gt;
  ),
});
</code></p>

<h2>Next steps</h2>

<p>Now that you know what interactive posts can do, you can:</p>

<ul>
<li>Try blocks, using our <a href="./quickstart.mdx">quickstart to build an interactive post</a>.
<ul>
<li>Read our <a href="./blocks/overview.mdx">blocks overview</a></li>
</ul></li>
<li>Check out our <a href="webviews.md">webviews</a> doc if you're already familiar with web development</li>
<li>Start iterating with code in real time in the <a href="playground.md">playground</a></li>
</ul>
<hr />

<h2>slug: /</h2>

<h1>Welcome to Devvit</h1>

<p>Meet Devvit: Reddit’s Developer Platform that lets you build powerful apps to enhance the communities you love.</p>

<iframe width="xxx" height="xxx" src="https://www.youtube.com/embed/BHtTIInycgg" title="Getting started with Reddit&#39;s Developer Platform" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<h2>Bring your imagination to life</h2>

<p>Devvit lets you create rich, immersive posts that seamlessly integrate into Reddit’s ecosystem.</p>

<p>Build interactive posts that ignite your community:</p>

<ul>
<li><a href="./showcase/apps#live-scores">Live scoreboards</a> that give your community play-by-play updates and a space for shitposting during the game.</li>
<li><a href="./showcase/playgrounds">Polls</a> to provoke spicy conversations or take the pulse of your community.</li>
<li><a href="./showcase/apps#bingo">Multiplayer games</a> played asynchronously or with other redditors in real time.</li>
</ul>

<p>Or create an entirely new <a href="./community_games.md">community game</a> around an app, like <a href="https://www.reddit.com/r/Pixelary/">r/Pixelary</a>, a multiplayer game created just for redditors to draw, guess, and compete for bragging rights.</p>

<h2>Tools at your fingertips</h2>

<p>Building on Devvit is simple and comes with built-in tools to help you succeed:</p>

<ul>
<li><a href="playground.md">Playground</a> – an interactive code editor with a live preview window that lets you experiment with blocks and try out your ideas.</li>
<li><a href="devvit_kit.md">@devvit/kit</a> – a library of UI components and backend patterns you can use to build your apps fast.</li>
<li><a href="devvit_cli.md">Devvit CLI</a> – the bridge between your codebase and Reddit.</li>
</ul>

<p>Reddit hosts your code with dedicated Redis-backed storage. The UI toolkit lets you build <a href="interactive_posts.md">interactive posts</a>, add new buttons, and create unique post layouts. Triggers let you listen to and respond to events. You only have to write code once, and it’s available on web, iOS, and Android platforms.</p>

<h2>Community and support</h2>

<p>Reddit’s Developer Platform provides a supportive environment where you can collaborate, ask questions, share knowledge, and inspire one another. Join <a href="https://www.reddit.com/r/devvit/">r/devvit</a> or become a member of our <a href="https://discord.com/invite/R7yu2wh9Qz">Discord</a> channel. Browse example apps in our <a href="https://github.com/reddit/devvit/tree/main/packages/apps">public repo</a> for project code you can fork and make your own.</p>

<h2>Ready to explore?</h2>

<p>If you're a dev, checkout the <a href="quickstart.mdx">quickstart</a>.</p>

<p>If you’re a mod, here’s <a href="mod_resources.md">everything you need to know</a> about adding apps to your community.</p>
<h2>JSON</h2>

<p>Several APIs in Devvit only accept plain <a href="https://www.json.org">JSON</a> data which is typed as <code>JSONValue</code>. The JSON format is used to save data because it's lossless, simple, and ubiquitous. If you attempt to pass a <code>class</code> instance, <code>interface</code> instance, or other incompatible type, the TypeScript compiler will flag it as an error. Type errors such as these are intended to provide quick feedback that your program probably won't work as intended.</p>

<h3>Example Problem: Class and <code>Context.useState()</code></h3>

<p>```ts
import { Devvit, useState } from '@devvit/public-api';</p>

<p>class Foo {}
const [foo, setFoo] = useState(new Foo()); // Error!
```</p>

<p><code>
No overload matches this call.
  The last overload gave the following error.
    Argument of type 'Foo' is not assignable to parameter of type 'void | JSONValue | (() =&gt; void | JSONValue | Promise&lt;void | JSONValue&gt;)'.ts(2769)
</code></p>

<h3>Example Problem: Interface and <code>KVStore.put()</code></h3>

<p><code>ts
interface Bar {}
const bar: Bar = {};
await context.kvStore.put('foo', bar); // Error!
</code></p>

<p><code>
Argument of type 'Bar' is not assignable to parameter of type 'JSONValue'.
</code></p>

<h3>What Is JSON?</h3>

<p>In Devvit, JSON is typed as <code>JSONValue</code> which is a string, number, boolean, null, an array of any of these, or an object of these values, recursively.</p>

<p>All of the following are examples of valid JSON values:</p>

<p><code>ts
const a: JSONValue = 'abc';
const b: JSONValue = 1;
const c: JSONValue = false;
const d: JSONValue = null;
const e: JSONValue = [];
const f: JSONValue = {};
const g: JSONValue = { a: 123 };
const h: JSONValue = [{ a: 123 }, 1, null];
</code></p>

<p>None of the following are valid JSON values:</p>

<p><code>ts
class Foo {}
const a: JSONValue = new Foo(); // Error!
const b: JSONValue = new Map(); // Error!
const c: JSONValue = new Set(); // Error!
const d: JSONValue = new Date(); // Error!
</code></p>

<h3>Solutions</h3>

<h4>Prefer <code>type</code> Instead of <code>interface</code></h4>

<p>It's always safe to favor <code>type</code> over <code>interface</code>. The compiler will tell you if there's a problem.</p>

<p><code>ts
// Problem
interface Fruit {
  type: 'Apple' | 'Banana';
}
</code></p>

<p><code>ts
// Solution
type Fruit = { type: 'Apple' | 'Banana' };
</code></p>

<p><code>interface</code> is open, <code>type</code> is closed. You don't normally need or want open typing because they're harder to reason about. See <a href="https://www.typescriptlang.org/play?ssl=11&ssc=1&pln=12&pc=1#code/PTAEEkDsBcFMCcBmBDAxrAzqZ9bYDYDuyAnlgPYAOskAdALABQAljAiuqAPLWRRxI0eAN5NQ2AFyhIAVwC2AIwRMAvkyYgIbQeiypkkAsTKgloWAA84kACawbDFto54eNfuyGhRjcQqmyisqMaowaYAAC0BgAtJbUqNBx8PDk8Eyo5JAY0KBUNFJufM5eALzeyFIAjAA0plIATCqgmgCiFglwNqDQ5KAAFsgAbnjI2LamAITqjJoAKiTUWDijRKR6+OQY9rSgAJrkMqD6hln4JKB2iKyjoAAG0Iuwd3mQ6NOzkdFxHbCJyal0oxHtRQABhTbbGwLUHlHziSrSeRKIGhcKgKKxeJ-JIIQFMEF4CFbewwvBwsT1JFBVFAA">a playground demonstrating their distinction</a> and <a href="https://github.com/microsoft/TypeScript/issues/15300">a related discussion in the TypeScript issue tracker</a>.</p>

<h5>When Would I Need an Interface?</h5>

<p>Rarely. A good example are Lit components. These are the default tags TypeScript knows of:</p>

<p><code>ts
interface HTMLElementTagNameMap {
    "a": HTMLAnchorElement;
    "abbr": HTMLElement;
    "address": HTMLElement;
    "area": HTMLAreaElement;
    "article": HTMLElement;
    ...
</code></p>

<p>If we were to define a custom component like <code>foo-bar</code>, we can augment TypeScripts knowledge:</p>

<p><code>ts
declare global {
  interface HTMLElementTagNameMap {
    'foo-bar': FooBar;
  }
}
</code></p>

<h4>Separate Data and Behavior</h4>

<p>```ts
// Problem
class XY {
  constructor(
    public x: number,
    public y: number
  ) {}</p>

<p>add(xy: XY): void {
    this.x += xy.x;
    this.y += xy.y;
  }
}
```</p>

<p>```ts
// Solution
type XY = { x: number; y: number };</p>

<p>function addEq(lhs: XY, rhs: XY): void {
  lhs.x += rhs.x;
  lhs.y += rhs.y;
}
```</p>

<h4>Serialize and Deserialize</h4>

<p>This is an example program for rectangle and coordinate classes. Both classes are typical in that they have state and methods. Additionally, the rectangle composes the coordinate.</p>

<p>```ts
type BoxJSON = { start: XYJSON; end: XYJSON };
class Box {
  static fromJSON(json: Partial<BoxJSON> | undefined): Box {
    const start = XY.fromJSON(json?.start);
    const end = XY.fromJSON(json?.end);
    return new Box(start.x, start.y, end.x, end.y);
  }</p>

<p>#start: XY;
  #end: XY;</p>

<p>constructor(x: number, y: number, w: number, h: number) {
    this.#start = new XY(x, y);
    this.#end = new XY(x + w, y + h);
  }</p>

<p>/** Return as a vector. */
  toXY(): XY {
    return this.#end.sub(this.#start);
  }</p>

<p>toJSON(): BoxJSON {
    return { start: this.#start.toJSON(), end: this.#end.toJSON() };
  }
}</p>

<p>type XYJSON = { x: number; y: number };
class XY {
  static fromJSON(json: Partial<XYJSON> | undefined): XY {
    return new XY(json?.x ?? 0, json?.y ?? 0);
  }</p>

<p>constructor(
    public x: number,
    public y: number
  ) {}</p>

<p>sub(xy: Readonly<XY>): XY {
    return new XY(this.x - xy.x, this.y - xy.y);
  }</p>

<p>toJSON(): XYJSON {
    return { x: this.x, y: this.y };
  }</p>

<p>toString(): string {
    return <code>(${this.x}, ${this.y})</code>;
  }
}</p>

<p>const original = new Box(0, 0, 1, 1);
const json = JSON.stringify(original);
console.log(<code>BoxJSON: ${json}</code>);
const revived = Box.fromJSON(JSON.parse(json));
console.log(<code>Revived Box: ${revived instanceof Box}; as vec: ${revived.toXY()}</code>);
```</p>
<h1>Key value store plugin</h1>

<p>:::note
<a href="https://developers.reddit.com/docs/redis">Redis</a> is replacing the key value store as Devvit’s hosted data store solution. You’ll need to <a href="migrate_kv_to_redis.md">migrate</a> your current apps to Redis.
:::</p>

<p>Sometimes you might want to store data in your app that will be there the next time it’s run.
Remember, Reddit Developer Platform apps are stateless, so you can’t just store data in memory across
executions or save data to the file system.</p>

<p>To store data, use the KV store plugin in your apps. Your data will be stored in a
persistent KV store database for quick retrieval. Currently, Get, Put, Delete, and List operations
are supported (see API Docs below).</p>

<p>Data in the KV store is partitioned by each installation of your app, so you don’t need to
worry about different installations overwriting data. This means that there won’t be one single
source of truth for all installations of your app, so keep that in mind. Each app installation can
only access the data that it has stored in the KV store.</p>

<p>Here’s an example:</p>

<blockquote>
  <p>Let’s say you’ve created an app and it has been installed into two different subreddits,
  <a href="https://www.reddit.com/r/cats">r/cats</a> and <a href="https://www.reddit.com/r/dogs">r/dogs</a>. In your app
  code, you save a value to the KV store. Each value is implicitly saved to a different
  partition, one for r/cats and one for r/dogs. When your app retrieves that value from the KV store in a later execution, the app will only see the value for the subreddit it is installed in.
  Any data in the KV store for another installation is inaccessible (after all,
  <a href="https://www.reddit.com/r/catswithdogs">r/CatsWithDogs</a> is a lie). This partitioning is all done
  for you automatically.</p>
</blockquote>

<h2>Use</h2>

<p>Enable the plugin in Devvit.configure.</p>

<p><code>ts
Devvit.configure({
  kvStore: true,
  // other plugins
});
</code></p>

<h2>Limitations</h2>

<ul>
<li>Max record size - 1Mb</li>
<li>Max KV store size (per subreddit) - 100Mb</li>
</ul>

<h2>Methods</h2>

<ul>
<li><code>put</code> - Assigns a value to a key in the KV store</li>
<li><code>get</code> - Retrieves a value from the KV store at the given key</li>
<li><code>delete</code> - Deletes a key from the KV store if present</li>
</ul>

<h2>Example</h2>

<p>```ts
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.configure({
  kvStore: true,
  // other plugins
});</p>

<p>Devvit.addMenuItem({
  label: 'Write to KV Store',
  location: 'post',
  onPress: (_, context) =&gt; {
    await context.kvStore.put('animalChoice', 'dog');
    const storedValue = context.kvStore.get('animalChoice');
    context.kvStore.delete('animalChoice');
  },
});</p>

<p>export default Devvit;
```</p>
<h1>App lifecycle</h1>

<p>Your app may go through several iterations on a subreddit. Here are a few procedures you might need.</p>

<h2>Adding an app to your subreddit</h2>

<p>To add an app to your subreddit, find it on the <a href="https://developers.reddit.com/apps">apps page</a>. Click into the app details screen, and click the "Add to community" button.</p>

<p><img src="./assets/install-app-button.png" alt="Post" /></p>

<p>This will give you a list of subreddits that will allow you to add the app. Generally, you can only add an app to subreddits that you moderate. Select a subreddit where you wish to install the app.</p>

<p><img src="./assets/communities-install-list.png" alt="Post" /></p>

<h2>Removing an app from your subreddit</h2>

<p><strong>Portal</strong><br />
Uninstallation is not yet available from the portal. Please uninstall from the CLI.</p>

<p><strong>CLI</strong><br />
You can find a list of installations by running <code>$ devvit list installs</code>. To uninstall an app, you can then run <code>$ devvit uninstall [app-name] --subreddit [subreddit-name]</code>.</p>

<p>```
$ devvit list installs
loading...... done</p>

<p>App Name          Installed Subreddits
 ───────────────── ────────────────────
 test-app-one    r/testsub1 (v0.0.1)</p>

<p>test-app-two    r/testsub2 (v0.0.3)</p>

<p>$ devvit uninstall test-app-one --subreddit r/testsub1
```</p>

<h2>Creating a new app</h2>

<p>Note: the <a href="./quickstart.mdx">quickstart</a> provides a simple guide to creating and publishing your first app. Check it out!</p>

<p>From the folder that you'd like to house your app folder, run the create command:</p>

<p><code>
$ devvit new [app-name]
</code></p>

<p>This will create a new project with <code>[app-name]</code>. <code>[app-name]</code> will be the primary way users identify your app on the Developer Portal and:</p>

<ul>
<li>must be all lowercase</li>
<li>must be at least 6 characters</li>
<li>have no starting numbers</li>
<li>can include any letters (a-z), numbers (0-9), or hyphens (-)</li>
</ul>

<p><strong>Select a project template</strong>
You will be asked to select a project template to start. All templates produce functioning code that can be published immediately. See the current list of project templates here.</p>

<h2>Uploading and publishing an app</h2>

<p><code>
$ devvit upload
</code></p>

<p>Move into your project directory and type <code>devvit upload</code>.
Note: you will be asked to select a “Version Bump” when uploading or publishing. Learn more about versioning.<br />
Uploading your app will create a private version of your app that you can see on developers.reddit.com and install into subreddits you moderate for testing purposes. Use this for debugging purposes before publishing. You can use devvit upload after your initial version has been published if you want to test new versions before making them available to other moderators.</p>

<p>```
$ cd ~/projects/myfirstapp
$ devvit upload
Bundling your app...... Success!
? Version Bump (Use arrow keys)
  major
  minor
❯ patch
  prerelease</p>

<p>Publishing new version "1.0.1" to Reddit...... Success!
```</p>

<h2>Updating your app</h2>

<p>You can update your app using <code>devvit upload</code>.</p>

<p>When you update your app, you will need to define a new version number. <strong>Subreddits will continue to use the old version until they choose to upgrade.</strong> If your app is listed publicly, the new version will only be available after review.</p>

<p><strong>Versioning</strong>
When using <code>devvit upload</code> you will be asked to choose a “Version Bump,” i.e. to increment your version Apps version number. Each option will increment your App’s version number differently.</p>

<p>| Version Bump | What will be incremented? | Example |
| ------------ | ------------------------- | ------- |
| Major        | X.0.0.0                   | 1.0.0.0 |
| Minor        | 0.X.0.0                   | 0.1.0.0 |
| Patch        | 0.0.X.0                   | 0.0.1.0 |
| Prerelease   | 0.0.0.X                   | 0.0.0.1 |</p>

<h2>Upgrading your subreddit to a newer version of an app</h2>

<p>Your app will need to be <strong>manually updated to each new version</strong> you upload on every subreddit at this time.</p>

<ul>
<li>Log into your allowlisted Reddit Developer account at <a href="https://www.reddit.com">https://www.reddit.com</a></li>
<li>Go to <a href="https://developers.reddit.com/my-apps">https://developers.reddit.com/my-apps</a></li>
<li>Click on your app's listing</li>
<li>You wil see a Communities section showing the subreddits on which your app has been installed along with the version installed on each</li>
<li>If a new version of an app is available for a given subreddit, you will see a blue "Upgrade" button</li>
<li>Click the button and follow the prompts to upgrade each installation</li>
</ul>

<h2>Removing your app from the store</h2>

<p>You can prevent new users from finding your app on the store by marking it "unavailable."<br />
Note that this will not remove the code from the store (you will still see it) and it will not remove the app from subreddits that have installed previous versions. This is because it is important to everyone that subreddits don't have functionality disappear suddenly, so once published and installed, that version will continue to exist until a moderator explicitly removes the functionality.</p>

<p><strong>Hide from the store UI</strong><br />
You can do this from developers.reddit.com by finding your app, clicking through to the app details page, scrolling down to the "Developer Settings" and toggling the "Available" option.</p>
<h1>Limitations</h1>

<p>There are certain limits applied to your applications in the Reddit Developer Platform. These are temporary limitations, and they will be modified as we gain a better understanding of how developers will use this platform.</p>

<h2>App execution limitations</h2>

<ul>
<li>App Execution Overall Time Limit - 1 second
<ul>
<li>Developer Platform has a maximum execution time for your application of 1 second. This
applies to the total time the code of your application is executing. If your application calls a
method on a plugin or another App, then the running time will pause until your application code
is executing. If your application exceeds this time limit, it will be terminated and no state
saved.</li>
</ul></li>
<li>App Continuous Execution Time Limit - 1 second
<ul>
<li>Each time your application code runs, it must complete or make an external method call within 1
second. When your code runs again, the 1s time limit restarts. However, your entire
application must complete execution within the overall time limit mentioned above. If your
application exceeds either time limit, it will be terminated.</li>
</ul></li>
</ul>

<p>Execution Time Limit Example:</p>

<p>Let’s say you have an app. Your app is invoked and runs some code that takes 220 milliseconds.
Then it calls a method on the Reddit API Plugin to get some listings. The time limit for your
script execution will stop at this point. When the Reddit API Plugin method completes, your app will
start executing again. It runs some code that takes 450 milliseconds before calling another method on
the Reddit API Plugin. At this point, your total application execution time is at 670 ms (220 + 450).
Remember, the overall limit is 1 second, so everything is still okay. Once the Reddit API Plugin
method returns, your app now has only 330 ms to run (1000 - 670). Let’s say it is doing something tough
and hits the limit. At this point, the runtime will terminate your app and return a timeout error
message to the invoker of your app.</p>

<h2>Resource limitations</h2>

<ul>
<li>App Method Argument Size Maximum - 1 MB
<ul>
<li>Invoking methods on an App is an async operation that passes through our runtime, so there is a
limit of 1 MB for all the arguments passed to that method.</li>
</ul></li>
<li>App Memory Space Maximum - 256 MB
<ul>
<li>When your App is running, it has access to a total of 256 MB during execution.</li>
</ul></li>
</ul>
<h1>Manage</h1>

<p>You can manage your apps and installations from your app page in “My Apps”.</p>

<h2>Update your app</h2>

<p>To edit the app name and description, select “Edit app details” from your app page.</p>

<p>Use <code>devvit upload</code> to <a href="release.md">release</a> a new version of your app.</p>

<p>When you publish an updated app, subreddits using your app will remain on the prior version until the moderator chooses to upgrade to the updated version If your app is listed publicly, the new version will be available after it has been reviewed.</p>

<h2>Upgrade your subreddit to a newer version of an app</h2>

<p>Currently, apps on a subreddit need to be manually updated when a new version is published. Go to your "app details" page in developers.reddit.com and locate the subreddit you want to update. Select “Install” and then “Upgrade” to get the latest version of the app.</p>

<h2>Remove an app from your subreddit</h2>

<p><strong>Uninstall from the portal</strong></p>

<ul>
<li>Find your app on <a href="https://developers.reddit.com/">developers.reddit.com</a>.</li>
<li>Click on the app info card to get to the app details page (e.g. <code>developers.reddit.com/apps/your-app-name</code>)</li>
<li>Under the <strong>Communities</strong> section, you will see a list of all subreddits your app is installed on</li>
<li>If you have permissions to uninstall the app, you can click the trash can icon to the right of a community name to uninstall the app from that community.</li>
</ul>

<p><img src="assets/manage_uninstall.png" alt="Uninstall" /></p>

<p><strong>Uninstall using the CLI</strong><br />
To find a list of installations, run <code>$ devvit list installs</code>.</p>

<p>```
$ devvit list installs
loading...... done</p>

<p>App Name          Installed Subreddits
 ───────────────── ────────────────────
 test-app-one    r/testsub1 (v0.0.1)</p>

<p>test-app-two    r/testsub2 (v0.0.3)</p>

<p>$ devvit uninstall test-app-one --subreddit r/testsub1
```</p>

<p>To uninstall an app, run <code>$ devvit uninstall [app-name] --subreddit [subreddit-name]</code>.</p>

<h2>Remove your app from the directory after it is published</h2>

<p>If your app is published, you can remove it from the Developer Portal. This will not remove the code from the directory, and it will not remove the app from subreddits that have installed previous versions. Once an app is published and installed, that version will continue to exist until a moderator explicitly removes it.</p>

<p><strong>Hide from the directory UI</strong><br />
Go to the <a href="https://developers.reddit.com">Developer Portal</a> and find your app. From the "App Details" page, scroll to the "Developer Settings" and toggle the "Available" option off. Note that you will not see this option for apps that have only been uploaded, but not published</p>
<h2>Manage your communities</h2>

<p>To view the subreddits you moderate, select “My communities” from the profile dropdown menu. This will list app installations across all communities where you have moderator permissions.</p>

<p><img src="./assets/mod_community_settings.png" alt="mod view" /></p>

<p>Click the subreddit name to install or remove apps from your community.</p>

<p><em>Note: only moderators with app management permissions will be able to modify community app installations. Permissions are <a href="https://mods.reddithelp.com/hc/en-us/articles/360009381491-User-Management-moderators-and-permissions">managed in mod settings</a>.</em></p>
<h1>How to migrate the KV store to Redis</h1>

<p>Migrating your app to the Redis plugin is easy! If your app is already using the key value store plugin, use the following steps to migrate to the Redis plugin.</p>

<ol>
<li>From the terminal, navigate to the directory where you store your project.</li>
<li>Open <code>main.ts</code> or <code>main.tsx</code> in your code editor.</li>
<li>Add the Redis plugin</li>
</ol>

<p><code>tsx
Devvit.configure({
  redis: true,
});
</code></p>

<ol start="4">
<li>In your app code, replace the following commands:</li>
</ol>

<ul>
<li>Change <code>kvStore.put</code> to <code>redis.set</code></li>
<li>Change <code>kvStore.get</code> to <code>redis.get</code></li>
<li>Change <code>kvStore.delete</code> with <code>redis.del</code></li>
</ul>

<ol start="5">
<li><code>kvStore.list</code> can be replaced with redis hash or sorted set usage. Example migration patterns:</li>
</ol>

<ul>
<li>Use <code>redis.hscan</code> if your app is retrieving key-value pairs based on a matched pattern. Alternate iteration methods like <code>redis.hgetall</code> and <code>redis.hkeys</code> might also fit your usecase. See the <strong>Redis Hash Migration</strong> for more details.</li>
<li>If you're implementing a leaderboard by listing all the keys and sorting them in memory - use <code>redis.zadd</code> and <code>redis.zrange</code> to leverage the redis data-structure custom built for this usecase.</li>
<li>If your app is periodically listing all the keys and deleting older keys based on a stored timestamp, use <code>redis.expire</code> to set a key expiration and simplify your code - no periodic listing is necessary.</li>
</ul>

<ol start="6">
<li>Save your changes.</li>
<li>Upload the new version of your app and update existing installations.</li>
</ol>

<h1>Redis Hash Migration</h1>

<p>A custom menu action to migrate all your KV store items to a Redis Hash</p>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.configure({
  redis: true,
  kvStore: true,
});</p>

<p>Devvit.addMenuItem({
  location: 'subreddit',
  label: 'Migrate KV Store to Redis Hash',
  onPress: async (<em>, { redis, ui, kvStore }) =&gt; {
    const keys = await kvStore.list();
    const hashKey = 'custom</em>hash_key'; // define your hash key here
    keys.forEach(async (key) =&gt; {
      const value = await kvStore.get(key);
      if (value) {
        console.log(<code>setting field: ${key} with value: ${value} in hash: ${hashKey}</code>);
        await redis.hset(hashKey, { [key]: value as string });
      }
    });
    // Verify the redis hash contents
    const items = await redis.hgetall(hashKey);
    if (items) {
      for (const key in items) {
        console.log(<code>redis hash contains field: ${key} and value: ${items[key]}</code>);
      }
    }
    // Now you can start using hget/hset methods for reads and writes
    // to the custom redis hash. And iterate with hscan, hgetall and hkeys.
    ui.showToast(<code>Completed redis hash migration</code>);
  },
});</p>

<p>export default Devvit;
```</p>

<h1>Troubleshooting</h1>

<ul>
<li>When apps use <code>kvStore.list</code> - safe execution in a multi-tenant environment is not guaranteed - it causes CPU spikes and blocks other Redis commands from running at the same time. We recommend using Redis Hashes instead, each hash can store upto 4.2 billion key value pairs and a combination of <code>hscan</code>, <code>hgetall</code> and <code>hkeys</code> can be used for iteration. Please reach out to us in Discord - we can help adapt your existing data model to use Redis and improve performance and reliability of your app.</li>
<li><code>kvStore.put</code> encodes the values with <code>JSON.stringify</code> and <code>kvStore.get</code> does <code>JSON.parse</code> to obtain the original data. If you are seeing returned values from <code>redis.get</code> wrapped in additional quotes during migration - add a try/catch block with <code>JSON.parse</code> to resolve the issue.</li>
</ul>
<h1>Migration guide</h1>

<p>With version 0.10.0 of Devvit, we are dramatically changing the syntax of our capabilities to make development even easier. Three keys changes you’ll see:</p>

<ul>
<li>Moving capabilities into a context object that’s passed into handlers</li>
<li>Removing the need to pass in metadata</li>
<li>Renaming items for consistency</li>
</ul>

<p>We’ve outlined the changes below.</p>

<h2>Menu items</h2>

<p>Menu items have been simplified:</p>

<ul>
<li><code>addAction</code> and <code>addActions</code> are now <code>addMenuItem</code></li>
<li>description has been dropped as a key</li>
<li>the new context.ui shows a form or a toast instead of returns</li>
<li>forms are created using Devvit.createForm</li>
<li><code>handler</code> has been renamed <code>onPress</code></li>
<li>no need to pass import-specific types:
<ul>
<li>context: Context.POST → location: ‘post’ or location: [‘post’, ‘comment’]</li>
<li>userContext: UserContext.Moderator → forUserType: ‘moderator’</li>
</ul></li>
</ul>

<p>```ts title="main.tsx"
Devvit.addMenuItem({
  label: 'Remind me later',
  location: 'post',
  onPress: (event, context) =&gt; {
    //  if you want to show a form
    context.ui.showForm(remindMeForm);</p>

<pre><code>// if you want to show a toast
context.ui.showToast('hello');
</code></pre>

<p>},
});</p>

<p>const remindMeForm = Devvit.createForm(
  {
    fields: [{ name: 'when', label: 'When?', type: 'string' }],
    title: 'Remind me',
    acceptLabel: 'Schedule',
  },
  remindMeHandler
);</p>

<p>async function remindMeHandler(event: FormOnSubmitEvent, context: Devvit.Context) {
  // remind me code here to do something after submitting form
}
```</p>

<h3>Dynamic forms</h3>

<p>Because we allow data as an argument in createForm, you can now create dynamic forms.</p>

<p>```ts title="main.tsx"
import { Devvit } from '@devvit/public-api';</p>

<p>const dynamicForm = Devvit.createForm(
  (data) =&gt; {
    console.log(data);</p>

<pre><code>return {
  fields: [
    {
      name: 'when',
      label: `a string (default: ${data.text})`,
      type: 'string',
      defaultValue: data.text,
    },
  ],
  title: 'Rule Form',
  acceptLabel: 'Send Rule',
};
</code></pre>

<p>},
  ({ values }, ctx) =&gt; {
    return ctx.ui.showToast(<code>You sent ${values.when}</code>);
  }
);</p>

<p>Devvit.addMenuItem({
  label: 'Show a dynamic form',
  location: 'post',
  onPress: async (_, { ui }) =&gt; {
    const randomString = Math.random().toString(36).substring(7);</p>

<pre><code>const formData = {
  text: randomString,
};

return ui.showForm(dynamicForm, formData);
</code></pre>

<p>},
});</p>

<p>export default Devvit;
```</p>

<h2>Triggers</h2>

<ul>
<li>There's no need to pass in a specific Devvit event type: <code>events: Devvit.Trigger.PostSubmit</code> is now <code>event: 'PostSubmit</code></li>
<li><code>handler</code> has been renamed to <code>onEvent</code></li>
</ul>

<p><code>ts title="main.tsx"
Devvit.addTrigger({
  event: 'PostSubmit',
  onEvent: (event, context) =&gt; {
    context.scheduler.runJob({ job: test - job });
  },
});
</code></p>

<h2>Scheduler</h2>

<ul>
<li>Scheduler is now part of the context object</li>
<li>The following have been renamed:
<ul>
<li><code>Devvit.addSchedulerHandler</code> is now <code>Devvit.addSchedulerJob</code></li>
<li><code>Scheduler.schedule</code> is now <code>scheduler.runJob</code> and <code>scheduler.cancelJob</code></li>
<li><code>handler</code> is now <code>onRun</code></li>
</ul></li>
</ul>

<p>```ts title="main.tsx"
Devvit.addSchedulerJob({
  name: 'daily-thread',
  onRun: async (job, context) =&gt; {
    const subreddit = await context.reddit.getCurrentSubreddit();
    const resp = await context.reddit.submitPost({
      subredditName: subreddit.name,
      title: 'Daily Thread',
      text: 'This is a daily thread, commment here!',
    });
  },
});</p>

<p>// run job once (within a menu item or trigger)
context.scheduler.runJob({ when: now, job: 'test-job' });</p>

<p>// run recurring job (within a menu item or trigger)
// for tips on cron syntax use https://crontab.guru/
context.scheduler.runJob({ cron: '* 12 * * * ', job: 'test-job' });
```</p>

<h2>Plugins</h2>

<p>The Reddit API, Fetch, and KV store plugins now use <code>Devvit.configure</code> to define the capabilities you want to use (these also can be found on the context object in a handler). This replaces <code>Devvit.use</code>.</p>

<p><code>ts title="main.tsx"
// can omit or set to false if not using
Devvit.configure({
  redditAPI: true,
  http: true, // for fetch
  kvStore: true,
});
</code></p>

<p>Check out the following examples of the plugins in use.</p>

<h3>Reddit API</h3>

<p>```ts title="main.tsx"
// can omit or set to false if not using
Devvit.configure({
  redditAPI: true,
});</p>

<p>Devvit.addMenuItem({
  label: 'Reply to post',
  location: 'post',
  onPress: async (event, context) =&gt; {
    const response = await context.reddit.submitComment({
      id: <code>t3_${context.postId}</code>,
      text: 'hello world!',
    });
    // if you want to show a toast
    context.ui.showToast('Successfully replied!');
  },
});</p>

<p>// alernative w/ deconstruction</p>

<p>Devvit.addMenuItem({
  label: 'Reply to post',
  location: 'post',
  onPress: (event, { reddit }) =&gt; {
    await reddit.submitComment({
      id: <code>t3_${context.postId}</code>,
      text: 'hello world!',
    });
    // if you want to show a toast
    context.ui.showToast('Successfully replied!');
  },
});
```</p>

<h3>Fetch</h3>

<p>```ts title="main.tsx"
Devvit.configure({
  http: true,
});</p>

<p>Devvit.addMenuItem({
  label: 'Fetch a response',
  location: 'post',
  onPress: async (event, context) =&gt; {
    const response = await fetch('https://example.com', {
      method: 'post',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ content: comment?.body }),
    });
    // if you want to show a toast
    context.ui.showToast(response);
  },
});
```</p>

<h3>KV store</h3>

<p>```ts title="main.tsx"
Devvit.configure({
  kvStore: true,
});</p>

<p>Devvit.addMenuItem({
  label: 'Get from kv store',
  location: 'post',
  onPress: async (event, context) =&gt; {
    const value = await context.kvStore.get('test-key');
    context.ui.showToast(value);
  },
});
```</p>

<h3>App configurations</h3>

<p>```ts title="main.tsx"
// set app configurations
Devvit.addSettings([
  {
    type: 'string',
    name: 'apiKey',
    label: 'API Key',
    onValidate: ({ value }) =&gt; {
      if (!value || value.length &lt; 10) {
        return 'API Key must be at least 10 characters long';
      }
    },
  },
]);</p>

<p>// retreiving app configurations</p>

<p>Devvit.addMenuItem({
  label: 'Get settings values',
  location: 'post',
  onPress: async (event, context) =&gt; {
    console.log('event: ', event);</p>

<pre><code>const singleSetting = await context.settings.get('apiKey');
const allSettings = await context.settings.getAll();

console.log('All settings: ', allSettings);
console.log('Single setting: ', singleSetting);
</code></pre>

<p>},
});
```</p>

<h2>Installation</h2>

<p>:::note
These syntax changes will require you to rewrite your app code.
:::</p>

<p>To update to this version of devvit, you should update your devvit CLI. If you want to update an existing project, you should use the command below.</p>

<p>To update, run the following commands:</p>

<p><code>bash
$ npm i -g devvit
</code></p>

<p>To update dependencies in an existing project:</p>

<p><code>bash
$ devvit update app
</code></p>

<h3>Moving from public-api-next</h3>

<p>If you were using <code>'public-api-next'</code> please run the following steps in your project directory to update your app:</p>

<ul>
<li><code>devvit update app</code></li>
<li><code>npm remove @devvit/public-api-next</code></li>
<li><code>npm i</code></li>
<li>In the app code, change <code>import { Devvit } from '@devvit/public-api-next';</code> to <code>import { Devvit } from '@devvit/public-api';</code></li>
</ul>

<h2>Typescript Notes</h2>

<h3>Object deconstruction for context</h3>

<p>Since the context object has different objects attached to it, you can use typescript deconstruction to specify the object you are looking to use to simplify code.</p>

<p><code>ts title="main.tsx"
// alernative w/ deconstruction
Devvit.addMenuItem({
  label: 'Reply to post',
  location: 'post',
  onPress: (event, { reddit, ui }) =&gt; {
    await reddit.submitComment({
      id: `t3_${context.postId}`,
      text: 'hello world!',
    });
    // if you want to show a toast
    ui.showToast('Successfully replied!');
  },
});
</code></p>

<h3>_ argument</h3>

<p>In some examples above, we are prefixing <code>_</code> in front of the argument, this avoids typecheck error for unused variables, but is not necessary.</p>
<h1>Mod actions</h1>

<p>Devvit supports the following (really long) list of mod actions.</p>

<h2>A - C</h2>

<ul>
<li>acceptmoderatorinvite</li>
<li>add<em>community</em>topics</li>
<li>addcontributor</li>
<li>addmoderator</li>
<li>addnote</li>
<li>addremovalreason</li>
<li>adjust<em>post</em>crowd<em>control</em>level</li>
<li>approvecomment</li>
<li>approvelink</li>
<li>banuser</li>
<li>collections</li>
<li>community_styling</li>
<li>community_widgets</li>
<li>create_award</li>
<li>createremovalreason</li>
<li>createrule</li>
<li>create<em>scheduled</em>post</li>
</ul>

<h2>D - G</h2>

<ul>
<li>delete_award</li>
<li>deleterule</li>
<li>delete<em>scheduled</em>post</li>
<li>deleteoverriddenclassification</li>
<li>deletenote</li>
<li>deleteremovalreason</li>
<li>dev<em>platform</em>app_changed</li>
<li>dev<em>platform</em>app_disabled</li>
<li>dev<em>platform</em>app_enabled</li>
<li>dev<em>platform</em>app_installed</li>
<li>dev<em>platform</em>app_uninstalled</li>
<li>disable_award</li>
<li>disable<em>post</em>crowd<em>control</em>filter</li>
<li>distinguish</li>
<li>editflair</li>
<li>edit<em>post</em>requirements</li>
<li>editrule</li>
<li>edit<em>scheduled</em>post</li>
<li>editsettings</li>
<li>enable_award</li>
<li>enable<em>post</em>crowd<em>control</em>filter</li>
<li>events</li>
</ul>

<h2>H - O</h2>

<ul>
<li>hidden_award</li>
<li>ignorereports</li>
<li>invitemoderator</li>
<li>invitesubscriber</li>
<li>lock</li>
<li>marknsfw</li>
<li>markoriginalcontent</li>
<li>mod<em>award</em>given</li>
<li>modmail_enrollment</li>
<li>muteuser</li>
<li>overrideclassification</li>
</ul>

<h2>R</h2>

<ul>
<li>removecomment</li>
<li>remove<em>community</em>topics</li>
<li>removecontributor</li>
<li>removelink</li>
<li>removemoderator</li>
<li>removewikicontributor</li>
<li>reordermoderators</li>
<li>reorderremovalreason</li>
<li>reorderrules</li>
</ul>

<h2>S - T</h2>

<ul>
<li>setcontestmode</li>
<li>setpermissions</li>
<li>setsuggestedsort</li>
<li>showcomment</li>
<li>snoozereports</li>
<li>spamcomment</li>
<li>spamlink</li>
<li>spoiler</li>
<li>sticky</li>
<li>submit<em>content</em>rating_survey</li>
<li>submit<em>scheduled</em>post</li>
</ul>

<h2>U</h2>

<ul>
<li>unbanuser</li>
<li>unignorereports</li>
<li>uninvitemoderator</li>
<li>unlock</li>
<li>unmuteuser</li>
<li>updateremovalreason</li>
<li>unsetcontestmode</li>
<li>unsnoozereports</li>
<li>unspoiler</li>
<li>unsticky</li>
</ul>

<h2>W - Z</h2>

<ul>
<li>wikibanned</li>
<li>wikicontributor</li>
<li>wikipagelisted</li>
<li>wikipermlevel</li>
<li>wikirevise</li>
<li>wikiunbanned</li>
</ul>
<h1>App feedback</h1>

<p>There is a feedback button on the app details page. You can also share your app feedback directly with the developer via pm.</p>

<h2>Reporting an app</h2>

<p>If you believe an app is in violation of Reddit’s sitewide content policies, is creating issues, or otherwise having negative impacts to communities it’s installed in, please contact our team via r/modsupport.</p>
<h1>Installing apps</h1>

<h2>How do I install an app?</h2>

<p>Go to the <a href="https://developers.reddit.com/apps">Developer Portal</a> and select an app. This opens the app detail page. Click the red <strong>Install</strong> button, select the subreddit you want to add the app to, and presto! You’ve just installed an app.</p>

<p><img src="./assets/app-details-5.png" alt="app details" /></p>
<h1>What's an app?</h1>

<p>An app is a program hosted and run on Reddit’s Developer Platform. Moderators can install an app on their subreddits to customize a community with bespoke mod tools, discussion bots, new governance tools, games, leaderboards, and more.</p>

<p>:::note
Some apps are for everyone in the community, while others are limited to moderators in the community. Moderation apps will often have buttons that show up in, or with, the mod shield icon.
:::</p>

<h2>How do apps work?</h2>

<h3>App configurations</h3>

<p>Some apps have settings that let you control how the app is configured to work on your subreddit. You can enable a specific setting or select options the developer provided to further customize your subreddit’s experience.</p>

<p><img src="./assets/app_config_screen.png" alt="app details" /></p>

<h3>App permissions</h3>

<p>Apps may require certain permissions in order to work on your subreddit. These permissions are listed on the app detail pages in the <a href="https://developers.reddit.com">Community Apps</a> directory.</p>

<p>Permissions fall in one of three categories.</p>

<p>| <strong>Category</strong>                   | <strong>Description</strong>                                                                      |
| ------------------------------ | ------------------------------------------------------------------------------------ |
| UI                             | Permissions the app needs for the UI elements it uses.                               |
| User data handling             | Permissions the app needs for the way it manages user data.                          |
| Mod permissions (required)     | Permission the app needs to create an <a href="###app-accounts">app account</a> with everything |
| permissions on your subreddit. |</p>

<p>You can see the permissions an app requires on the app details page, install details page, and in the CLI.</p>

<p><img src="./assets/app_permissions.png" alt="app permissions" /></p>

<h3>App accounts</h3>

<p>Each app has an “app account”’ which is basically a user account for the app. The app account may take mod actions, write posts/comments, or send messages programmatically. These accounts are not human-operated or logged into.</p>

<p>Currently, app accounts are granted full mod permissions. In the future they will be granted more granular permissions based on the actions they need to take.</p>

<p><img src="./assets/app_account_everything_permissions.png" alt="app details" /></p>

<h3>Custom actions</h3>

<p>Many apps use something called “custom actions,” which can be invoked when you select a cool robot icon button within a post, comment, or subreddit overflow menu. Mod-specific actions on posts and comments are located in the mod shield menu.</p>

<h2>Is it safe?</h2>

<h3>Data privacy</h3>

<p>Each installation of an app has its own data storage. This means that the data used by the app cannot interact with or share data with other communities, or with other apps . If the app you are installing uses external web services, the app will come with a separate privacy agreement with the developer.</p>

<p>If you uninstall an app from a subreddit, your subreddit-specific data storage instance will be deleted. Be sure you want to remove an app and all its data before you uninstall an app.</p>

<h3>App review</h3>

<p>Admins review the source code and test functionality of every app made publicly available. Apps going through major updates or with greater security risk go through the review process for each new version.</p>
<h1>Mod resources</h1>

<p>Devvit apps are programs hosted and run on Reddit’s Developer Platform. Moderators can install an app on their subreddits to customize a community with bespoke mod tools, discussion bots, new governance tools, games, leaderboards, and more.</p>

<p>:::note
Some apps are for everyone in the community, while others are limited to moderators in the community. Moderation apps will often have buttons that show up in, or with, the mod shield icon.
:::</p>

<h2>Understanding apps</h2>

<h3>Permissions</h3>

<p>Apps may require certain permissions in order to work on your subreddit. These permissions are listed on the app detail pages in the <a href="https://developers.reddit.com">Community Apps</a> directory.</p>

<p>Permissions fall in one of three categories.</p>

<p>| <strong>Category</strong>               | <strong>Description</strong>                                                                                                     |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------- |
| UI                         | Permissions the app needs for the UI elements it uses.                                                              |
| User data handling         | Permissions the app needs for the way it manages user data.                                                         |
| Mod permissions (required) | Permission the app needs to create an <a href="###app-accounts">app account</a> with everything permissions on your subreddit. |</p>

<p>You can see the permissions an app requires on the app details page, install details page, and in the CLI.</p>

<p><img src="./assets/app_permissions.png" alt="app permissions" /></p>

<h3>App accounts</h3>

<p>Each app has an “app account”’ which is basically a user account for the app. The app account may take mod actions, write posts/comments, or send messages programmatically. These accounts are not human-operated or logged into.</p>

<p>Currently, app accounts are granted full mod permissions. In the future they will be granted more granular permissions based on the actions they need to take.</p>

<p><img src="./assets/app_account_everything_permissions.png" alt="app details" /></p>

<h3>Configuration settings</h3>

<p>Some apps have settings that let you control how the app is configured to work on your subreddit. You can enable a specific setting or select options the developer provided to further customize your subreddit’s experience.</p>

<p><img src="./assets/app_config_screen.png" alt="app details" /></p>

<h2>How to install an app</h2>

<p>Go to the <a href="https://developers.reddit.com/apps">Apps</a> directory and select an app. This opens the app detail page. Click the red <strong>Install</strong> button, select the subreddit you want to add the app to, and presto! You’ve just installed an app.</p>

<p><img src="./assets/app-details-5.png" alt="app details" /></p>

<h2>Safety</h2>

<h3>Data privacy</h3>

<p>Each installation of an app has its own data storage. This means that the data used by the app cannot interact with or share data with other communities, or with other apps . If the app you are installing uses external web services, the app will come with a separate privacy agreement with the developer.</p>

<p>If you uninstall an app from a subreddit, your app history will be lost. Be sure you want to remove an app before clicking "uninstall," because you won't be able to retrieve the data or settings if you reinstall the app at a later date.</p>

<h3>App review</h3>

<p>Admins review the source code and test functionality of every app made publicly available. Apps going through major updates or with greater security risk go through the review process for each new version.</p>

<h3>Reporting an app</h3>

<p>If you believe an app is in violation of Reddit’s sitewide content policies, is creating issues, or otherwise having negative impacts to communities it’s installed in, please contact our team via r/modsupport.</p>
<h1>Optimizing performance</h1>

<p>You can optimize your app to make it run faster, use resources more efficiently, and create a better user experience. Here’s how.</p>

<h2>Always use the latest public-api</h2>

<p>To update your app to use the latest version of the public API:</p>

<ol>
<li><p>Run <code>npm install -g devvit</code> to update the Devvit CLI globally.</p></li>
<li><p>In your project directory, run the following commands:</p></li>
</ol>

<ul>
<li><code>devvit update app</code></li>
<li><code>npm install</code></li>
</ul>

<p>:::note
You must update the CLI before you upgrade @devvit/public-api in your project.
:::</p>

<h2>Write performant requests</h2>

<p>These best practices will optimize your app.</p>

<h3>Get as much data as possible from the context</h3>

<p>If you only need the name of the current user:</p>

<ul>
<li>Avoid requests like <code>context.reddit.getCurrentUser()</code> or <code>context.reddit.getUserById(context.userId)</code>.</li>
<li>Use <code>context.reddit.getCurrentUsername()</code> instead.</li>
</ul>

<p>If you only need the subreddit name:</p>

<ul>
<li>Don’t request the whole Subreddit model with <code>context.reddit.getCurrentSubreddit()</code>.</li>
<li>Use <code>context.reddit.getCurrentSubredditName()</code> instead.</li>
</ul>

<h3>Cache requests to RedditAPI or external resources</h3>

<p>Use <code>context.cache</code> to reduce the amount of requests to optimize performance and running costs of your application. See <a href="./capabilities/cache.md">cache helper</a> for details and examples.</p>

<h3>Leverage scheduled jobs to fetch or update data</h3>

<p>Use <a href="./capabilities/scheduler.md">scheduler</a> to make large data requests in the background and store it in <a href="./capabilities/redis.md">Redis</a> for later use. You can also <a href="#how-to-use-the-cache-helper​">fetch data for multiple users</a>.</p>

<h3>Batch API calls to make parallel requests</h3>

<p>Every request defined in <code>useState</code> is blocking the render function. You can improve app performance by <a href="#how-to-make-parallel-requests">making parallel requests</a>.</p>

<h2>Ensure your app has a lightweight first view</h2>

<p>The faster the first view appears on the user’s screen, the better the user experience. You can minimize and delay the data loading necessary for your app to display the first view. To do this:</p>

<ul>
<li>Use <a href="./custom_post_preview.md">setCustomPostPreview</a> to make a dynamic, compelling preview that loads quickly.</li>
<li>Use <a href="./working_with_useasync.md">useAsync</a> to load the necessary data without blocking the rendering process.</li>
<li>Import <a href="./working_with_usestate.md">useState</a> or <a href="./working_with_useasync.md">useAsync</a> to load the data needed for the specific component only when that component is rendered.</li>
</ul>

<h2>How to: make parallel requests</h2>

<p>In Devvit, the first <a href="./rendering_apps.md">render</a> happens on the server side. Parallel fetch requests will speed up the first render.</p>

<h3>Before optimization: individual fetch requests</h3>

<p>In the render function of this interactive post, the app fetches data about the post, the user, the weather, and the leaderboard stats.</p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>render: (context) =&gt; {
  const [postInfo] = useState(async () =&gt; {
    return await getThreadInfo(context);
  });</p>

<p>const [user] = useState(async () =&gt; {
    return await getUser(context);
  });</p>

<p>const [weather] = useState(async () =&gt; {
    return await getTheWeather(context);
  });</p>

<p>const [leaderboardStats] = useState(async () =&gt; {
    return await getLeaderboard(context);
  });</p>

<p>// the rest of the render function
};
```</p>

<p>If each request takes roughly 250 ms, then four requests will take around 1 second to resolve. If we change the example to make those requests in parallel, it would take 250 ms to resolve all four!</p>

<h3>After optimization: parallel fetch requests</h3>

<p>You can do this in two ways:</p>

<ul>
<li>Use <a href="./working_with_useasync.md">useAsync</a> to make everything non-blocking.</li>
<li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all">Promise.all</a> inside one <a href="./working_with_usestate.md">useState</a> method to get all of the information at once.</li>
</ul>

<p>:::note
The main difference between these two methods is that <code>useState</code> blocks render until it is resolved, and <code>useAsync</code> allows the app to render immediately and requires loading states while the requests resolve.
:::</p>

<h4>useAsync</h4>

<p>This is the best choice for performance because it allows you to render parts of your application while others may still be loading. Here’s how the same example looks for useAsync:</p>

<p>```tsx
import { Devvit, useAsync } from '@devvit/public-api';</p>

<p>const { data: postInfo, loading: postInfoLoading } = useAsync(async () =&gt; {
  return await getThreadInfo(context);
});</p>

<p>const { data: user, loading: userLoading } = useAsync(async () =&gt; {
  return await getUser(context);
});</p>

<p>const { data: weather, loading: weatherLoading } = useAsync(async () =&gt; {
  return await getTheWeather(context);
});</p>

<p>const { data: leaderboardStats, loading: leaderboardStatsLoading } = useAsync(async () =&gt; {
  return await getLeaderboard(context);
});
```</p>

<h4>useState</h4>

<p>This is the same example using useState.</p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>render: (context) =&gt; {
  const [appState, setAppState] = useState(async () =&gt; {
    const [postInfo, user, weather, leaderboardStats] = await Promise.all([
      getThreadInfo(context),
      getUser(context),
      getTheWeather(context),
      getLeaderboard(context),
    ]);
    return {
      postInfo,
      user,
      weather,
      leaderboardStats,
    };
  });</p>

<p>const { postInfo, user, weather, leaderboardStats } = appState;</p>

<p>// the rest of the render function
};
```</p>

<p>You can see the app gets the same variables from the state object, which means that you won’t need to change the way you access the data from the state in the rest of the app.</p>

<p>:::note
If you need to update one of the state props, you’ll need to do <code>setAppState({...appState, postInfo: newPostInfo})</code> instead of <code>setPostInfo(newPostInfo)</code>.
:::</p>

<h2>How to: cache data</h2>

<p>The following example shows how unoptimized code for fetching data from an external resource, like a weather API, looks:</p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>// naive, non-optimal way of fetching that kind of data
const [externalData] = useState(async () =&gt; {
  const response = await fetch('https://external.weather.com');</p>

<p>return await response.json();
});
```</p>

<h3>Problem: request overload</h3>

<p>In this case, <a href="./rendering_apps.md">state</a> is initialized for each user that sees the app. This means that in a large subreddit where thousands of users can see the post at the same time, your app would make thousands of requests to the external resource. If you request the data in an interval, like to get a game score or stock market information, then the load repeats on each interval tick. This is not ideal.</p>

<h3>Solution: make one request</h3>

<p>You can use a <a href="./capabilities/cache.md">cache helper</a> to make one request for data, save the response, and provide this response to all users requesting the same data. The cache lives at the subreddit level (not the app level).</p>

<p><strong>Example: fetch weather data every 2 hours with cache helper</strong></p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>// optimized, performant way of fetching that kind of data
const [externalData] = useState(async () =&gt; {
  return context.cache(
    async () =&gt; {
      const response = await fetch('https://external.weather.com');
      return await response.json();
    },
    {
      key: <code>weather_data</code>,
      ttl: 2 * 60 * 60 * 1000, // 2 hours in milliseconds
    }
  );
});
```</p>

<p>:::note
Do not cache sensitive information. Cache helper randomly selects one user to make the real request and saves the response to the cache for others to use. You should only use cache helper for non-personalized fetches, since the same response is available to all users.
:::</p>

<h3>Solution: schedule a job</h3>

<p>Alternatively, you can use <a href="./capabilities/scheduler.md">scheduler</a> to make the request in background, save the response to <a href="./capabilities/redis.md">Redis</a>, and avoid unnecessary requests to the external resource.</p>

<p><strong>Example: fetch weather data every 2 hours with a scheduled job</strong></p>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.addSchedulerJob({
  name: 'fetch<em>weather</em>data',
  onRun: async (<em>, context) =&gt; {
    const response = await fetch('https://external.weather.com');
    const responseData = await response.json();
    await context.redis.set('weather</em>data', JSON.stringify(responseData));
  },
});</p>

<p>Devvit.addTrigger({
  event: 'AppInstall',
  onEvent: async (<em>, context) =&gt; {
    await context.scheduler.runJob({
      cron: '0 */2 * * *', // runs at the top of every second hour
      name: 'fetch</em>weather_data',
    });
  },
});</p>

<p>// inside the render method
const [externalData] = useState(async () =&gt; {
  return context.redis.get('fetch<em>weather</em>data');
});</p>

<p>export default Devvit;
```</p>

<h2>How to: update the client state without intervals​</h2>

<p>If you have a game with a leaderboard, scores need to be updated immediately for all active sessions.</p>

<p>One way to achieve this is to set an interval to fetch leaderboard stats as often as possible, but making a request in the interval would <a href="./rendering_apps.md#clientserver-environments">switch the execution to server environment</a> and affect the performance of the app. In addition, each time a user viewed the app, it would spam the leaderboard database in an attempt to get the latest data.</p>

<p>To optimize performance, use <a href="./capabilities/realtime.md">realtime</a> to send the leaderboard stats to all users directly.</p>

<h3>Without realtime​</h3>

<p>Before using realtime, the leaderboard fetching code looked like this:</p>

<p>```tsx
const getLeaderboard = async () =&gt;
  await context.redis.zRange('leaderboard', 0, 5, {
    reverse: true,
    by: 'rank',
  });</p>

<p>const [leaderboard, setLeaderboard] = useState(async () =&gt; {
  return await getLeaderboard();
});</p>

<p>const leaderboardInterval = useInterval(async () =&gt; {
  const newLeaderboard = await getLeaderboard();
  setLeaderboard(newLeaderboard);
}, 1000);</p>

<p>leaderboardInterval.start();
```</p>

<p>And code for updating the leaderboard looked like this:</p>

<p><code>tsx
await context.redis.zAdd('leaderboard', { member: username, score: gameScore });
</code></p>

<h3>With realtime​</h3>

<p>Using realtime, you can fetch the leaderboard during the initial render and emit the new leaderboard state when the user completes the game.</p>

<p>This is the updated game completion code:</p>

<p><code>tsx
// stays as is
await context.redis.zAdd('leaderboard', { member: username, score: gameScore });
// new code
context.realtime.send('leaderboard_updates', { member: username, score: gameScore });
</code></p>

<p>Now replace the interval with the realtime subscription:</p>

<p>```tsx
const [leaderboard, setLeaderboard] = useState(async () =&gt; {
  return await getLeaderboard();
}); // stays as is</p>

<p>const channel = useChannel({
  name: 'leaderboard_updates',
  onMessage: (newLeaderboardEntry) =&gt; {
    const newLeaderboard = [...leaderboard, newLeaderboardEntry] // append new entry
      .sort((a, b) =&gt; b.score - a.score) // sort by score
      .slice(0, 5); // leave top 5
    setLeaderboard(newLeaderboard); // update the state
  },
});</p>

<p>channel.subscribe();
```</p>

<p>Using realtime ensures that extra requests will not impact your app’s performance, and the app only emits the event when the data has changed.</p>

<h2>How to: measure your app’s performance</h2>

<p>You can use <code>console.log</code> to calculate the operation time of your app.</p>

<p>This example shows the render function of a basic post that fetches the number of subreddit members.</p>

<p>```tsx
const [subscriberCount] = useState<number>(async () =&gt; {
  const devvitSubredditInfo = await context.reddit.getSubredditInfoByName('devvit');
  return devvitSubredditInfo.subscribersCount || 0;
});</p>

<p>return (
  // app markup goes here
);
```</p>

<h3>Add a console log</h3>

<p>Before the above post can be rendered, two pieces of data need to be requested:
subreddit subscribers count and user avatar url. You can measure the amount of time it takes to request data inside the <code>useState</code> hook.</p>

<p>To do this, you can add:</p>

<ul>
<li>A variable that stores the timestamp of the operation start.</li>
<li>A console log between the operation end and the return statement that prints the difference between the start and end in milliseconds.</li>
</ul>

<p>```tsx
const [subscriberCount] = useState<number>(async () =&gt; {
  const startSubscribersRequest = Date.now(); // a reference point for the request start
  const devvitSubredditInfo = await context.reddit.getSubredditInfoByName('devvit');</p>

<p>console.log(<code>subscribers request took: ${Date.now() - startSubscribersRequest} milliseconds</code>);</p>

<p>return devvitSubredditInfo.subscribersCount || 0;
});
```</p>

<p>Alternatively, you can measure the whole data collection step. On the first line of the render method you can declare a state variable:</p>

<p><code>tsx
const [performanceStartRender] = useState(Date.now()); // a reference point for the render start
</code></p>

<p>Add a console.log before the return statement:</p>

<p><code>tsx
console.log(`Getting the data took: ${Date.now() - performanceStartRender} milliseconds`);
</code></p>

<p>All of that put together will look like this:</p>

<p>```tsx
const [performanceStartRender] = useState(Date.now()); // a reference point for the render start</p>

<p>const [subscriberCount] = useState<number>(async () =&gt; {
  const startSubscribersRequest = Date.now(); // a reference point for the request start
  const devvitSubredditInfo = await context.reddit.getSubredditInfoByName('devvit');</p>

<p>console.log(<code>subscribers request took: ${Date.now() - startSubscribersRequest} milliseconds</code>);</p>

<p>return devvitSubredditInfo.subscribersCount || 0;
});</p>

<p>console.log(<code>Getting the data took: ${Date.now() - performanceStartRender} milliseconds</code>);</p>

<p>return (
  // app markup goes here
);
```</p>

<h3>Review your data</h3>

<p>Once you’ve set up your data collection, you can expect something like that in your logs:</p>

<p><code>
subscribers request took: 106 milliseconds
getting user avatar url took: 203 milliseconds
getting the data took: 310 milliseconds
</code></p>

<p>This will help you find the operations that affect your app’s performance.</p>
<h1>Add payments</h1>

<p>You can use the payments template to build your app or add payment functionality to an existing app.</p>

<p>To start with a template, select the payments template when you create a new project or run:</p>

<p><code>bash
devvit new --template=payments
</code></p>

<p>To add payments functionality to an existing app, run:</p>

<p><code>bash
npm install @devvit/payments
</code></p>

<p>:::note
Make sure you’re on Devvit 0.11.3 or higher. See the <a href="https://developers.reddit.com/docs/next/quickstart">quickstart</a> to get up and running.
:::</p>

<h2>Register products</h2>

<p>Register products in the src/products.json file in your local app. The JSON schema for the file format is available at https://developers.reddit.com/schema/products.json.</p>

<p>Each product in the products field has the following attributes:
| <strong>Attribute</strong> | <strong>Description</strong> |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| <code>sku</code> | A product identifier that can be used to group orders or organize your products. Each sku must be unique for each product in your app. |
| <code>displayName</code> | The official name of the product that is displayed in purchase confirmation screens. The name must be fewer than 50 characters, including spaces. |
| <code>description</code> | A text string that describes the product and is displayed in purchase confirmation screens. The description must be fewer than 150 characters, including spaces. |
| <code>price</code> | An predefined integer that sets the product price in Reddit gold. See details below. |
| <code>image.icon</code> | <strong>(optional)</strong> The path to the icon that represents your product in your <a href="../app_image_assets">assets</a> folder. |
| <code>metadata</code> | <strong>(optional)</strong> An optional object that contains additional attributes you want to use to group and filter products. Keys and values must be alphanumeric (a - Z, 0 - 9, and - ) and contain 30 characters or less. You can add up to 10 metadata keys. Metadata keys cannot start with "devvit-". |
| <code>accountingType</code> | Categories for how buyers consume your products. Possible values are: <ul><li><code>INSTANT</code> for purchased items that are used immediately and disappear.</li><li><code>DURABLE</code> for purchased items that are permanently applied to the account and can be used any number of times</li><li><code>CONSUMABLE</code> for items that can be used at a later date but are removed once they are used.</li><li><code>VALID_FOR_</code> values indicate a product can be used throughout a period of time after it is purchased.</li></ul> |</p>

<p>Registered products are updated every time an app is uploaded, including when you use <a href="../playtest">Devvit playtest</a>.</p>

<h2>Price products</h2>

<p>Product prices are predefined and must be one of the following gold values:</p>

<ul>
<li>5 gold ($0.10)</li>
<li>25 gold ($0.50)</li>
<li>50 gold ($1)</li>
<li>100 gold ($2)</li>
<li>150 gold ($3)</li>
<li>250 gold ($5)</li>
<li>500 gold ($10)</li>
<li>1000 gold ($20)</li>
<li>2500 gold ($50)</li>
</ul>

<p>:::note
Actual payments will not be processed until your products are approved. While your app is under development, you can use sandbox payments to <a href="#simulate-purchases">simulate purchases</a>.
:::</p>

<h2>Design guidelines</h2>

<p>You’ll need to clearly identify paid products or services. Here are some best practices to follow:</p>

<ul>
<li>Use a short name, description, and image for each product.</li>
<li>Don’t overwhelm users with too many items.</li>
<li>Try to keep purchases in a consistent location or use a consistent visual pattern.</li>
<li>Only use the gold icon to indicate purchases for Reddit gold.</li>
</ul>

<h3>Product image</h3>

<p>Product images need to meet the following requirements:</p>

<ul>
<li>Minimum size: 256x256</li>
<li>Supported file type: .png</li>
</ul>

<p>If you don’t provide an image, the default Reddit product image is used.</p>

<p><img src="../assets/default_product_image.png" alt="default image" /></p>

<p><strong>Example</strong></p>

<p><code>json
{
  "$schema": "https://developers.reddit.com/schema/products.json",
  "products": [
    {
      "sku": "god_mode",
      "displayName": "God mode",
      "description": "God mode gives you superpowers (in theory)",
      "price": 25,
      "images": {
        "icon": "products/extra_life_icon.png"
      },
      "metadata": {
        "category": "powerup"
      },
      "accountingType": "CONSUMABLE"
    }
  ]
}
</code></p>

<h3>Purchase buttons (required)</h3>

<p>Use Reddit’s primary, secondary, or bordered button component and gold icon in one of the following formats:</p>

<p><img src="../assets/payments_button_purchase.png" alt="default image" /></p>

<h3>Product components</h3>

<p>Use a consistent and clear product component to display paid goods or services to your users. Product components can be customized to fit your app, like the examples below.</p>

<p><img src="../assets/payments_component_button.png" alt="default image" /></p>

<p><img src="../assets/payments_component_list.png" alt="default image" /></p>

<p><img src="../assets/payments_component_tile.png" alt="default image" /></p>

<h2>Complete the payment flow</h2>

<p>Use <code>addPaymentHandler</code> to specify the function that is called during the order flow. This customizes how your app fulfills product orders and provides the ability for you to reject an order.</p>

<p>Errors thrown within the payment handler automatically reject the order. To provide a custom error message to the frontend of your application, you can return {success: false, reason: <string>} with a reason for the order rejection.</p>

<p>This example shows how to issue an "extra life" to a user when they purchase the "extra_life" product.</p>

<p>```ts
import { type Context } from '@devvit/public-api';
import { addPaymentHandler } from '@devvit/payments';
import { Devvit, useState } from '@devvit/public-api';</p>

<p>Devvit.configure({
  redis: true,
  redditAPI: true,
});</p>

<p>const GOD<em>MODE</em>SKU = 'god_mode';</p>

<p>addPaymentHandler({
  fulfillOrder: async (order, ctx) =&gt; {
    if (!order.products.some(({ sku }) =&gt; sku === GOD<em>MODE</em>SKU)) {
      throw new Error('Unable to fulfill order: sku not found');
    }
    if (order.status !== 'PAID') {
      throw new Error('Becoming a god has a cost (in Reddit Gold)');
    }</p>

<pre><code>const redisKey = godModeRedisKey(ctx.postId, ctx.userId);
await ctx.redis.set(redisKey, 'true');
</code></pre>

<p>},
});
```</p>

<h2>Implement payments</h2>

<p>The frontend and backend of your app coordinate order processing.</p>

<p><img src="../assets/payments_order_flow_diagram.png" alt="Order workflow diagram" /></p>

<p>To launch the payment flow, create a hook with <code>usePayments()</code> followed by <code>hook.purchase()</code> to initiate the purchase from the frontend.</p>

<p>This triggers a native payment flow on all platforms (web, iOS, Android) that works with the Reddit backend to process the order. The <code>fulfillOrder()</code> hook calls your app during this process.</p>

<p>Your app can acknowledge or reject the order. For example, for goods with limited quantities, your app may reject an order once the product is sold out.</p>

<h3>Get your product details</h3>

<p>Use the <code>useProducts</code> hook or <code>getProducts</code> function to fetch details about products.</p>

<p>```tsx
import { useProducts } from '@devvit/payments';</p>

<p>export function ProductsList(context: Devvit.Context): JSX.Element {
  // Only query for products with the metadata "category" of value "powerup".
  // The metadata field can be empty - if it is, useProducts will not filter on metadata.
  const { products } = useProducts(context, {
    metadata: {
      category: 'powerup',
    },
  });</p>

<p>return (
    <vstack>
      {products.map((product) =&gt; (
        <hstack>
          <text>{product.name}</text>
          <text>{product.price}</text>
        </hstack>
      ))}
    </vstack>
  );
}
```</p>

<p>You can also fetch all products using custom-defined metadata or by an array of skus. Only one is required; if you provide both then they will be AND’d.</p>

<p><code>tsx
import { getProducts } from '@devvit/payments';
const products = await getProducts({,
});
</code></p>

<h3>Initiate orders</h3>

<p>Provide the product sku to trigger a purchase. This automatically populates the most recently-approved product metadata for that product id.</p>

<p><strong>Example</strong></p>

<p>```tsx
import { usePayments } from '@devvit/payments';</p>

<p>// handles purchase results
const payments = usePayments((result: OnPurchaseResult) =&gt; { console.log('Tried to buy:', result.sku, '; result:', result.status); });</p>

<p>// for each sku in products:
<button onPress{payments.purchase(sku)}&gt;Buy a {sku}</button>
```</p>
<h1>Manage payments</h1>

<p>Once your app and products have been approved, you’re ready to use Reddit’s production payments system. Real payments will be triggered automatically when invoked from approved app versions. No code changes are required.</p>

<h2>Check orders</h2>

<p>Reddit keeps track of historical purchases and lets you query user purchases.</p>

<p>Orders are returned in reverse chronological order and can be filtered based on user, product, success state, or other attributes.</p>

<p><strong>Example</strong></p>

<p>```tsx
import { useOrders, OrderStatus } from '@devvit/payments';</p>

<p>export function CosmicSwordShop(context: Devvit.Context): JSX.Element {
  const { orders } = useOrders(context, {
    sku: 'cosmic_sword',
  });</p>

<p>// if the user hasn’t already bought the cosmic sword
  // then show them the purchase button
  if (orders.length &gt; 0) {
    return <text>Purchased!</text>;
  } else {
    return <button onPress={/* Trigger purchase */}&gt;Buy Cosmic Sword</button>;
  }
}
```</p>

<h2>Update products</h2>

<p>Once your app is in production, existing installations will need to be manually updated via the admin tool if you release a new version. Contact the Developer Platform team if you need to update your app installation versions.</p>

<p>Automatic updates will be supported in a future release.</p>

<h2>Issue a refund</h2>

<p>Reddit may reverse transactions under certain circumstances, such as card disputes, policy violations, or technical issues. If there’s a problem with a digital good, a user can submit a request for a refund via <a href="https://support.reddithelp.com/hc/en-us/requests/new?ticket_form_id=29770197409428">Reddit Help</a>.</p>

<p>When a transaction is reversed for any reason, you may optionally revoke product functionality from the user by adding a <code>refundOrder</code> handler.</p>

<p><strong>Example</strong></p>

<p>``<code>tsx
addPaymentHandler({
  fulfillOrder: async (order: Order, ctx: Context) =&gt; {
    // Snip order fulfillment
  },
  refundOrder: async (order: Order, ctx: Context) =&gt; {
    // check if the order contains an extra life
    if (order.products.some(({ sku }) =&gt; sku === GOD_MODE_SKU)) {
      // redis key for storing number of lives user has left
      const livesKey =</code>${ctx.userId}:lives`;</p>

<pre><code>  // if so, decrement the number of lives
  await ctx.redis.incrBy(livesKey, -1);
}
</code></pre>

<p>},
});
```</p>

<h2>Payments help</h2>

<p>When you enable payments, a <strong>Get Payments Help</strong> menu item is automatically added to the three dot menu in your app. This connects the user to <a href="https://support.reddithelp.com/hc/en-us/requests/new?ticket_form_id=29770197409428">Reddit Help</a> for assistance.</p>
<h1>Overview</h1>

<p>Add products to your app and get paid for what you sell. The payments plugin lets you prompt users to buy premium features that you build into your app, like in-game items, additional lives, or exclusive features into your app.</p>

<p><img src="../assets/payments_example.png" alt="Sample payment app screen" /></p>

<p>:::note
Payments is a beta feature.<br />
:::</p>

<h2>How to get paid</h2>

<p>You’ll set the price of the products in your app in Reddit <a href="https://support.reddithelp.com/hc/en-us/articles/17331548463764-What-is-gold-and-how-do-I-use-it">gold</a>. Users will use gold to acquire the items, and an equivalent amount of gold will accumulate in your app account.</p>

<p>Information about payouts is located <a href="https://support.reddithelp.com/hc/en-us/articles/30641905617428-Developer-Program#h_01J8GCHXEG24ZNR5EZZ9SPN48S">here</a>.</p>

<h2>Prerequisites</h2>

<p>You can use the sandbox to build and test payments, but before you can publish your app and sell products, you’ll need to:</p>

<ul>
<li>Verify you meet the <a href="https://support.reddithelp.com/hc/en-us/articles/30641905617428-Developer-Program#h_01J8GCHXEG24ZNR5EZZ9SPN48S">eligibility criteria</a>.</li>
<li>Complete the verification process. You can start the process and check the status of your verification via your <a href="https://developers.reddit.com/my/settings">settings page</a>.</li>
<li>Accept and comply with our <a href="https://redditinc.com/policies/earn-terms">Earn Terms</a> and <a href="https://www.redditinc.com/policies/earn-policy">Earn Policy</a>.</li>
</ul>

<p>All products will be reviewed by the Developer Platform team to ensure compliance with our content policy. Products are approved during the <a href="../publishing.md">app review process</a> after you publish your app.</p>
<h1>Publish your app</h1>

<p>:::note
The Developer Platform team reviews and approves apps and their products before products can be sold.
:::</p>

<p>To publish your app:</p>

<ol>
<li>Run <code>devvit publish</code>.</li>
<li>Select how you want your app to appear in the Apps directory:</li>
</ol>

<ul>
<li><strong>Unlisted</strong> means that the app is only visible to you in the directory, and you can install your app on larger subreddits that you moderate.</li>
<li><strong>Public</strong> means that your app is visible to all users in the Apps directory and can be installed by mods and admins across Reddit.</li>
</ul>

<p>You can change your app visibility at any time. See <a href="publishing.md">publishing an app</a> for details.</p>

<h3>Ineligible products</h3>

<p>Any apps or products for which you wish to enable payments must comply with our <a href="http://redditinc.com/policies/earn-policy">Earn Policy</a> and <a href="https://developers.reddit.com/docs/guidelines">Devvit Guidelines</a>.</p>
<h1>Test payments</h1>

<p>Use the payments sandbox environment to simulate payment transactions. All apps automatically start in the payments sandbox.</p>

<h2>Start a playtest</h2>

<p>To test your app:</p>

<ol>
<li>Run <code>devvit upload</code> to upload your app to the Apps directory.</li>
<li>Run <code>devvit playtest</code> <test-subreddit-name> .</li>
</ol>

<p>Once you start a playtest session, a new pre-release version of your app is automatically created and installed on your test subreddit. The pre-release version has a fourth decimal place, so if your current app is 0.0.1, the first pre-release version will be 0.0.1.1.</p>

<p>The pre-release version is updated and uploaded to your test subreddit every time you save your app code. You’ll need to refresh your subreddit to see the updated app. This may take a couple of seconds, so be patient.</p>

<h2>Simulate purchases</h2>

<p>In your test subreddit, you can make simulated purchases to test your app. No gold deducted in this state.</p>

<p><img src="../assets/payment_simulation.png" alt="Sample payment simulation" /></p>

<p>To end your playtest, press CTRL + C in the terminal session where you started it.</p>
<h1>Playground</h1>

<p>Experiment with blocks and custom posts in real time.</p>

<p>A <a href="https://developers.reddit.com/play">playground</a> is a lightweight tool for rapid experimentation with blocks and custom posts. This is useful for both beginner and advanced developers to test out new ideas fast.</p>

<p>Each playground provides an interactive code editor and a live preview in the browser. No setup or account is necessary. You can start with the base template or select a new template from the new template dropdown. Changes are automatically saved as you work.</p>

<p><img src="./assets/play/screenshot.png" alt="Playground screenshot." /></p>

<p>You can also share your work by sharing your playground’s URL. Every change you make generates a new URL. If you share your playground with another developer, any changes they make are seamlessly forked to their own playground and won’t override your code.</p>

<h2>Live preview​</h2>

<p>Code is executed on every change and shown in the interactive preview window. Be sure to test both dark and light modes as well as the smallest and largest screen sizes to ensure your posts look great everywhere.</p>

<p><img src="./assets/play/preview.png" alt="Live preview of hello world." /></p>

<h2>Code completion​</h2>

<p>Press control and spacebar (ctrl+space) to suggest code completions at the cursor position. This is a great way to explore the available APIs when dotting off an object.</p>

<p><img src="./assets/play/code_completion.png" alt="Code completion for &lt;code&gt;md5-94dfa0c1b9ccbc99957453c194d00b05&lt;/code&gt;." /></p>

<h2>Type-checking​</h2>

<p>Code is type-checked as it's written. Failures appear in the console and also on hover. It's okay to ignore type errors, but if the type-checker can understand the code, it's more likely to run as expected and other people can probably read it easier. It's like a free test, making sure the program fits together.</p>

<p><img src="./assets/play/type-check.png" alt="Type-checking." /></p>

<h2>Build an app​</h2>

<p>Playgrounds are for experimentation. When you're ready for the next step, start a new app using your playground as a template by pressing the <strong>Export</strong> button. You'll need to have the Devvit CLI set up. If you have any trouble with the export process, copy-and-paste your code into a new Devvit project instead.</p>

<p><img src="./assets/play/export.png" alt="Export a program." /></p>

<h2>Collaborate</h2>

<p>Press the <strong>Share</strong> button to copy the URL to the clipboard, and then paste it in a message to share your playground with other developers.</p>

<p><img src="./assets/play/collaborate.png" alt="Share a program by URL." /></p>

<h2>Examples</h2>

<p>These examples are a great starting point for your next project. Share your own examples on <a href="https://discord.com/channels/1050224141732687912">Discord</a>.</p>

<p>| <strong>Post type</strong>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | <strong>Description</strong>                                         |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------- |
| <a href="https://developers.reddit.com/play/#pen/N4IgdghgtgpiBcIASMA2qD2ACAQpgxgNYDOAhCADQjEBO+CIAllAA4Y0AuWwAIjAG79GHAL5YAZjQxQsAcgACAEwFCOAehYBXAEapG+ALQQWjWQB0wFvoOEA6CIsUBhTcQ7SAChjcAVAJ4sMAAUwBZYWJCw8HIAyhB+WCjoGLIUYVg0MGDKNNH4GGAcMAAeXAC8AHzc6eH5YG5YANr5moUwNBRYxDAcThitRTQAulhlWHVFpbauMDEcEEVBAAwAlDUZPZo0YFhB6+EAPPxuEERYEHoA5mCwhWWy+FmDWFCMjqgwslgAFjCMl98OPcAIxLJYAUi+l2M91QEBol0+FX24SwB0mXGIjAAXjB7sVinCEZ8sAB3P4AoGybQYVCKWTInao5nhJKYUhYQC8G4BpHZRhzUGMZLNRB20mg47ksTOF4WMgXhEDAj3uLBozHhfnM0plBQ8mWIxDKwCCK1GVW6vX6bRoQRa1rN4ytzwA1FhgSsRHysEKZeEnHozrBSF6DmoxRKCj7hcA7c8APy7L2HQXAAAGAE1+uMA4QYIosAASGNO9piDjMYLEFakVMiUOCr2m6J7bXC9ElDgVABkYG0xBYAG56x2oyyPSjQ8d5kRR2smZ6wCI5xYSmxOFhlOIIJpUFxrKoLJQQPx2liCghgSIgA"><img src="./assets/play/example_hello_blocks.png" alt="Hello Blocks! screenshot." /></a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Hello Blocks! creates a minimal interactive post.       |
| <a href="https://developers.reddit.com/play/#pen/N4IgdghgtgpiBcIDCAbA9gYwNYgDQgGcAnDBEASygAc0iAXAAmABEYA3N8ugXwYDMiaKAwDkAAQAm7TnQD0VAK4AjFOQwBaCFXIiAOmH18FYDHXJowDAOYw6SBUSIwwdACqUYACgCUTfQwYMCwJGMDQAdwYAXgYwGEjmCDovb39A4MYACzQHAmiGAGU6InIwK08w8IA6GzoACRyiAh9vKqoICSKIek8AJlxRAAYRVMt0sBCGKFKFZLyYopKyioia2wBZGbmWto6unv6hkbSgicYCGFOJecLi0vLKtboCy4trnfbOum66PoGRYajAJOOgOSwAAwAJMBsrluPBodMwLMYAR4dCLlc0eD9Nx9PpWBwuFUOhJ7CEhAAFNAhVwATyoXmAaUgsHgolQmCwIlwaScYCkRHZp2SAA9GFEAHx+MYBU6TADaZlgAwubg8AF18iKYOKqgoLl1kp4fNFpbV7I5nOrYC00nKMgwzNh8qapQw1e5bW7zbZLfybSkgQFxmK6PqLgBJFwwIhsCAoTzOrADACMgwzrRCPx8+NlDBBYIYnntIYAPGxsy6E+QrGBYC4oiIMNbY1NyBIJCgYCIGJkYLXMnQosB04NuJLSyGGGWwx7yAAvGBN0WilDdGwiSXAZUwbhl2Rhyf5gIHyvfbDH6fBvFgbijfS6mj0BhSPgQBQoRiEmT6PAgNhYwIcwwAQVNuCAA"><img src="./assets/play/example_clock.png" alt="Clock screenshot." /></a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Clock shows periodic live updates.                      |
| <a href="https://developers.reddit.com/play/#pen/N4IgdghgtgpiBcIAKB7ANmgziANCTATgMYIgCWUADigQC4AEwAIjAG6tm0C+9AZgSij0A5AAEAJmw60A9JQCuAIzRkiAWgiUywgDpg9tAJ6UY9ACoQMh+gF56AbRSVaZFGHj1MtAmTABzHHpWFFoYTA8weShFGAIAXT0iNy96WksVMI8CGAhxNzRrCyt7ONsHPXoHYQBNMOFAgFYARgAmOJwKqoA5FHr6ABY2jrBK+2EAWQhDGL7WgA4EsEW9XnkwIhc3Pl9xAHVfMF8-IoKACgBKDxPrYE60GAYoCAAPK-TrAB96SIwyn7ROrwaPRTkkwCk0lZ6CheKl0mQwudGJ1KmRYacAIRPZ70D5fSEFexNUoAPno2KJcSRtxGlTp2LKBMMKPoXE6bNpaJBDJsvO+8gw1JZtAAFgIAO7fGCSgCiBAEBFOwh6cKhQLW4gAdMJzuzOtlaPICCNsXoOYlkgwABI5SQEMoXWxk06dAA8rC8ECIAGsSSzXSLPT76CKYGQ-CLaDZhABmFqUZ7CeiWcNgWBgKPCKBkcTie7CP20un0V2YShe2KeMgALxg0dg4jIUSTMkLxcqrtCzwYmBrdeEmCeGCT4rDEczinQ4iTSTQNGjYBg8m8ljUYNCGYLLOLAHkTPoi3TXTIu7Q2+3S+WiJXe7Xo4P0i3z8XOzBu1W7wOh2gR2PI9HJzQad6FnedhEXZcCFXdcYAzNRRwgb0t0PYtACICbcSxPN8zwwy8K3tW9+wfYd6FbXDTw-Ijv1-cN-2EQDgNAggFyXFc0DXNwN1oeCciQ592waTUADZvSCEIwlwrDu3449AzSH0ZLkr1RNDWjMyaBMk0UZS-AEDUAGF0DAiC2LUScCDtHjEKfN0ZA9eTfT0XUDzBFIADEUHE+07FOSgBEocJGCIEUyCA7IwAAfg8Fh2E4TUZXudNaH0kKwtgrgkRsZ03SU4M-E0e9qOTFQ-DTWDM2zXN83octcyOesYEbZsQz-TM400-jgD8pxME1YLQvEcKORfCimJYyDoM48qrKQyjCsffjKiaBoQxQI1MHoJomnJXxlzCeh7l4Wh-SknDaVkoNHLAZy9Bi6RNVycR9PkLxBFQLwzGMGBThpSpIFgDxhFQDANplZ5oEofNhkqcK7Q8GD3yy5FD1chh7EwGB7g2VwwECDHaAAZUxmBsbcUo7AR2hNRemACbSUIlR1FlUYcEUIEwAA1cTxDxh4rXZrnQnEcmQKm7tqYxumIAZ3hLAxm6UctehBaOAmiGyWCHVw+zlJqx76qzRqmygJMU1KpL7zSOgk3yygGqak36F0lBxUWulgAJBFeqeShTlORxnBxwIAH1WEseQYCpJ0QQwl9cu9WP2zNsqM3rHM8xgXQUPbSpVPHaMWjmTTE+LNwkGyTBMBsYBHSR-GiaxzYwFOJwm-OYac7pN2c7w68CL7aNnmIn9SO7i9VDcEv23+utfs7+eMcbnHbD5Vucan+eIpEKDGxQMzl1oNw1F4UKfw3zvAZ31x99oQ+wDUNbaBURcs-nnOO7fukxrnz-i0Xkmm4rzsGvLYW8BwkzcOICABBDBqEhhAXwSZAYYzBFAmBM1X6-0qB-N+ZFs49zLPhOaX5Hyj3Pr3G8A9hBDyKngrBr53xjXAag6BsD4GIJJMAEBYAuDHlPGPDsMh45j3OO3SSOsFIsgVsWFmh9ISMnhGETU2RxDyGvH7L0RBAhECNOFWgmUySaPoAAahAro8qlJAgAAZnIyKVuKA4Rw9yALsCfMAexHH+GuBcZmSsABKYQBS0EwGrDWIwfLa0usVVMFsBxW1oDbAqJCSK1UbP4e2xsbYSjHh7RR3tNB+wDk3QIYc0ARyjkjH+ncWYmGIOVCAfhTB2EmKKZRa13F+1KRHUiqQQiWCRAAKk2lYmxU8DRGhGC6fBF5qxRIceIUU1cmgjK4AIi88dz7Fjzv+YAyyrE4KwfMxZXVYjXgzA0mABzf7aR9M7AyRlmJVKwZUBxYBDj+GcTjewVjyar0DpPaZWCwEED8NpU4LQGgNBwFY6F0LNQtHOJg557ZkEQPcawsyOk9LuKRc8q5n8kjGliH43ITYq7JLPoC9sdDnmulmQ5J2STh6mxKinCq6dqqpINsytZPdRoPPGqZGCcEvACH8DRfO9EpzIWRcWYAXTLmbKPKdXl6zLqqoIVeSsRyRTRgaEJTSZCqXzwYQwJhJkoLsWFdxUVbg-AFi4f8nhfDsIauVcIpVx56XKVVV69VU9bGdwylc48EirrFmkXScZxoY7Z3dFE7Z6kRkAFIZWd1dDaXIlYaU52AGzTm3N6BbwCZgIJIT1YwE1h4FW-hQmVp4YnV0HkvJrOABifNgtGr0AAGTdtjfQxQB8AXIs0CYaBEB1j9j8hQVhuLP6EXmsOJVjZMAQGUI1auGJ-6kwbcaukZcK5VxrgYzwfMBbc1ON4COYi91us7eQmQg7b5uDWTek1Mhm2hAIG7UN-rDyBo5BlPQeg3zUDoPQSQssgn0DupwPQuAQCsFiL2NwCAmhcCAA"><img src="./assets/play/example_polls.png" alt="Polls screenshot." /></a> | Polls collect user votes and present the current tally. |
| <a href="https://developers.reddit.com/play/#pen/N4IgdghgtgpiBcIAKAnA9gcxTAzjgBAEIQogA0IOKAxgiAJZQAOaKALvsACIwBuv9NgF98AM3RR8AcgACAEz4C2AeiYBXAEYAbetQC0EJvSkAdMGZ79BAOghy5AYTU42aKEjQuAKgE8mMAApgM3x8SFh4aVRMbDx8DRJ8GAAPaCYtGCkyEPxsMAUUSOo0MDYUjgBeAD5OHNDisBd8AG0mdCxcHDJ8HBg2aI68AF18CvwGsuS2a2cYAGU2CDKAgGYABgBKOty+tRQwfADt0IAeXhcIagBrY9D8CB0MMFhSiqlqGFKYFHwoensMqYDncQQALGD0DCgtgVYAARjWayEt1CGEMb1gcnoaigQJBIKYdixYAwby0JAwmVuVRR+DOF2u8UuVywaDU+QcaC0rDeAGIAGL8rgAVgcADYpONWGBvgAlOzYnBvURqLRaSUAd3+bFBsIRSJpwPxdxOoIZVyZ11Z7McXJ5Ul5XAAnCsAIKIzXa3XANoxTpCQ3G40nHCEj4-HD0ABeMAxMCxOMlOFBhljUhwAEc1CRMvhlIGg6dlGbFtcC8HlOdS1dy-jTeb8GimHGE7j8Fq5Dq9YiA7TTho1GxXOYjYX8LoSm8cJo2ChLmw9KJ6Gq8WPQh2u8BhUi+3cSqhOrCAhtRjVev12rEcAFfYMCNV8ABZJag6xQCDJG+Xzr4PT4BHdJsGzIqOxr5ruJwDkOJS7qEE5gG8RKLsu6qwe2XqwtuIFrqE+5XkeJ7VGhoTngMV5fn6cQPs+OpvvQYAUXe+AANT-ms3T6hsWygUG2FjuBPFFiWzK1kWVYids3GhCBQjcWYKQsOw+AKKIECqhwlhKGY5AgLw3yRiUCBwkIQA"><img src="./assets/play/example_progress_bar.png" alt="Progress bar screenshot." /></a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Progress bar shows the status of an action.             |</p>

<h2>Limitations</h2>

<p>Playgrounds are a fast, iterative way to test your code, but there are some things playgrounds can’t do.</p>

<ul>
<li>You can’t use Devvit plugins such as the Reddit API, Redis, or scheduler.</li>
<li>You can’t use other UI integrations like menu actions.</li>
<li>Playgrounds are short-lived, and you should save your changes to your computer regularly. A playground will attempt to persist changes to your local browser but if you lose the URL, you may lose your playground program.</li>
<li>Apps cannot be published from a playground. Use the export feature when you're ready to launch.</li>
</ul>

<h2>Troubleshooting</h2>

<p>Playground doesn't support the complete set of Devvit APIs because many require a live reddit.com production server to run. For example, none of the <code>Devvit.Context</code> APIs are enabled, so <code>await context.reddit.getCurrentUser()</code> will fail.</p>

<p>Calls to unsupported APIs throw a <code>CircuitBreakerResponse</code> error with a <code>ServerCallRequired</code> message. If you see this error, don't worry. Your app may run in production, and it's usually fine to comment out this code or put in placeholder values.</p>
<h1>Playtest</h1>

<p>Playtest lets you test your app while it's still in development. Playtest installs your app to a test subreddit and uploads a new version whenever you save changes to your app code. You can see your app changes and logs in real time using real data.</p>

<p>One caveat: your test subreddit cannot have more than 50 subscribers. Once installed, your playtest app will be visible to other users on the subreddit.</p>

<h2>Start a playtest</h2>

<ol>
<li>Run <code>devvit upload</code> to upload your app to the Apps directory.</li>
<li>Open a terminal and enter this command from the root of your project.</li>
</ol>

<p><code>bash
$ devvit playtest &lt;test subreddit name&gt;
</code></p>

<p>Once you start a playtest session, a new pre-release version of your app is automatically created and installed on your test subreddit. The pre-release version has a fourth decimal place, so if your current app is 0.0.1, the first pre-release version will be 0.0.1.1.</p>

<p>The pre-release version is updated and uploaded to your test subreddit every time you save your app code. You'll be prompted to visit your subreddit URL like <code>https://www.reddit.com/r/&lt;test subreddit name&gt;/?playtest=&lt;app name&gt;</code>. If you have an interactive post and your URL includes a <code>playtest=&lt;app name&gt;</code> or <code>playtest</code> query parameter, it will automatically refresh when the new version has been installed. If not, you’ll need to refresh your subreddit to see the updated app. This may take a couple of seconds, so be patient.</p>

<p>:::note
If you need help, run <code>devvit playtest —-help</code> for additional information.
:::</p>

<h2>View logs</h2>

<p>Playtest continuously streams logs for your app installation. This will show in the output of your terminal where the playtest is running. Check out <a href="./debug.md">logs</a> to learn more.</p>

<h2>Connect to client-side logs</h2>

<p>To enable client-side logs, add the<code>?playtest=&lt;app_name&gt;</code> query parameter to your subreddit URL (e.g. http://reddit.com/r/devvit?playtest=pixelary-game). This allows client side logs to stream into Devvit playtest logs and live reloads your browser when there are changes.</p>

<p>:::note
This url is also shown in your terminal when you start a playtest.
:::</p>

<h2>End a playtest</h2>

<p>Press Ctrl + C to exit the playtest.</p>

<p>Exiting the playtest does not uninstall the playtest version or revert your app back to a previous version. The playtest version you just tested will remain installed on the test subreddit.</p>

<h2>Revert your app</h2>

<p>If you want to revert back to the latest non-playtest version of the app, run the following command from within your project directory:</p>

<p><code>bash
$ devvit install &lt;subreddit&gt;
</code></p>

<p>If you want to revert to a different version of your pre-playtest app, you can specify which version using the <code>install</code> command. Entering app name is optional if you are running this command from within your project directory.</p>

<p><code>bash
$ devvit install &lt;subreddit&gt; [@version]
</code></p>

<h2>Upload your app</h2>

<p>If you’re satisfied with your playtest app and want to upload an installable version, run:</p>

<p><code>bash
$ devvit upload
</code></p>

<p>This will automatically bump your app version to the next patch release. For example, if your playtest version is 0.0.1.6, the upload command will remove the playtest version increment and change your app version to 0.0.2.</p>

<p>Once you <a href="./dev_guide.mdx/#9publish">publish your app</a> to the Apps Directory, it will be available for users to install.</p>
<h1>Setting post size</h1>

<p>Specify the height and element sizes.</p>

<p>There are two sets of dimensions that you’ll need to think about when creating an interactive post: the height of the post itself and the dimensions of the elements within the post. These dimensions will let you create responsive designs that will render consistently across platforms.</p>

<h2>Post height</h2>

<p>Height is a property on <code>addCustomPostType</code>. You can set the height to <code>regular</code> or <code>tall</code>. By default, posts are regular height.</p>

<h3><a href="https://developers.reddit.com/play#pen/N4IgdghgtgpiBcIQBoQGcBOBjBICWUADgPYYAuABMACIwBudeZAvhQGYbFQUDkAAgBN6jMgHpCAVwBGAGzxYAtBEJ4eAHTAbaDJgDoIAgQGEJaMlwAKxMwBUAnoRgAKYBooVIseLwBy0GDzIbhQAFjB4AOYhZN48ZBAyMoHBGDBgQhjeAPpYxGBkMAAelAC8AHxUwe6pZBIYYBROVe4UADyyxFgA1mhlze6toh3dvc0AlMHMGswTmmBFJOQUQmwQEjKU2iIoIHQwGGh4eQgAjMxAA">Playground link</a></h3>

<h3>Code sample</h3>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.addCustomPostType({
  name: 'Name',
  height: 'tall',
  render: (_context) =&gt; {
    return <blocks></blocks>;
  },
});</p>

<p>export default Devvit;
```</p>

<h2>Elements height and width</h2>

<p>Elements in blocks have a height, width, and a corresponding minimum and maximum size for each. Elements are defined using pixels or percentages.</p>

<h3><a href="https://developers.reddit.com/play#pen/N4IgdghgtgpiBcIQBoQGcBOBjBICWUADgPYYAuABMACIwBudeZAvhQGYbFQUDkAAgBN6jMgHpCAVwBGAGzxYAtBEJ4eAHTAbaDJgDoIAgQGEJaMlwAKxMwBUAnoRgAKYBooVIseLwBy0GDzIbhQYMGBCGN4A+ljEYGQwAB6UALwAfFTB7qFkEhhgFE5Z7hQAPHRmEFgA1mnF7mpkpQAWlTUUAO54AmTNKTwATACshIk8FM0weADmzWT9w6PjUlXV05wS4UbEMqT9shIBaaWirWSrdQUlDU1nq53dvQsjYxNTs-ODL8ur68Sbxh2ex46xgYR4x1ObVqFGKjRa0IePT6XyWbxmc2eaJWNT+AO2uww-VCAghJzuNUu13cJwq50pxQAlMFmBpmMzNGAkiRyBQhGwIBIZJRtCIUCA6DAMGg8HEEABGZhAA">Playground Link</a></h3>

<h3>Code sample in pixels</h3>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.addCustomPostType({
  name: 'Name',
  render: (_context) =&gt; {
    return (
      <vstack>
        <hstack width="25px" height="25px" backgroundColor="blue"></hstack>
        <hstack width="25px" height="25px" backgroundColor="green"></hstack>
        <hstack width="25px" height="25px" backgroundColor="red"></hstack>
      </vstack>
    );
  },
});</p>

<p>export default Devvit;
```</p>

<h2>Min/max height and width</h2>

<p>You can also specify the minimum and maximum height and width in your interactive post to get the desired layout across platforms. Use <code>minWidth</code>, <code>maxWidth</code>, <code>minHeight</code>, and <code>maxHeight</code> to set these parameters.</p>

<h3><a href="https://developers.reddit.com/play#pen/N4IgdghgtgpiBcIQBoQGcBOBjBICWUADgPYYAuABMACIwBudeZAvhQGYbFQUDkAAgBN6jMgHpCAVwBGAGzxYAtBEJ4eAHTAbaDJgDoIAgQGEJaMlwAKxMwBUAnoRgAKYBooVIseLwBy0GDzIbhQYMGBCGN4A+ljEYGQwAB6UALwAfFTB7qFkEhhgFE5Z7hQAPHRmEFgA1hQA7ngCZAAWKTwAjAAMnYSJPBRQEIkAEjB4AObNZG1dPX0UUlXV45wS4UbEMqRtdjAyW3U8acUlJaXNlTVppQnJFGh4AF4wKWogiYkyEBjjMG9pAGUuDAKAAZb6-Cg2JKUUahUqiW5ka6iC5kJbHAqnMqiCroq7FACUwWYGmYxM0YCSJHIFCEbAgEhklG0Ig0KBAdBgGAecQQ7WYQA">Playground link</a></h3>

<h3>Code sample with maxHeight</h3>

<p>```tsx
import { Devvit } from '@devvit/public-api';</p>

<p>Devvit.addCustomPostType({
  name: 'Name',
  render: (_context) =&gt; {
    return (
      <vstack width="100px" maxHeight="100px" backgroundColor="yellow">
        <hstack>
          <text size="xxlarge">Some Large Text Here</text>
        </hstack>
      </vstack>
    );
  },
});</p>

<p>export default Devvit;
```</p>
<h1>Publishing an app</h1>

<p>Once you <a href="./dev_guide.mdx#7upload">upload</a> your app, a private version of it is added to the <a href="https://developers.reddit.com/apps">Apps</a> directory. Only you will be able to see your app in the directory, and it’s available for you to use in small subreddits with fewer than 200 subscribers for testing purposes.</p>

<p>To use your app in larger subreddits, you’ll need to publish your app. To do this from the CLI, run:</p>

<p><code>
devvit publish
</code></p>

<p>Your app is automatically submitted to the Devvit team for review and approval. From the CLI, you’ll be prompted to select how you want this version of your app to appear in the Apps directory:</p>

<ul>
<li><strong>Unlisted</strong> means that the app is only visible to you in the directory, and you can install your app on larger subreddits that you moderate.</li>
<li><strong>Public</strong> means that your app is visible to all users in the Apps directory and can be installed by mods and admins across Reddit.</li>
</ul>

<p>:::note
If you select <code>Unlisted</code>, your app will be available immediately and will be reviewed retroactively. However, if your app uses blocks, it will require preemtive review for both unlisted and public apps.
:::</p>

<h2>Publishing requirements</h2>

<p>Before submitting your app for review, please go through the following checklists to make sure your app is ready for prime time. This will expedite the review process.</p>

<h3>Requirements for public apps</h3>

<p>Public apps are discoverable on our apps directory for anyone on Reddit. These apps should be fully functional, tested, and have detailed READMEs that non-technical users can understand. Prior to publishing make sure to:</p>

<ul>
<li>Add a README.md file to the root of your project directory with:
<ul>
<li>An app overview</li>
<li>Instructions on how to use the app</li>
<li>Changelogs for new versions</li>
</ul></li>
<li>Test your app across viewport sizes and user states</li>
<li>Ensure app contents can be moderated</li>
<li>Ensure app complies with our <a href="https://redditinc.com/policies/developer-terms">Developer Terms</a> and <a href="guidelines.md">guidelines</a></li>
</ul>

<h3>Requirements for unlisted apps</h3>

<ul>
<li>Add a README.md file to the root of your project directory with an app overview</li>
<li>Ensure app contents can be moderated</li>
<li>Ensure app complies with our <a href="https://redditinc.com/policies/developer-terms">Developer Terms</a> and <a href="guidelines.md">guidelines</a></li>
</ul>

<h2>App review</h2>

<p>Apps are reviewed and published on a per version basis. The Developer Platform team will review your code, read through your app README.md file, and potentially test your app. The review process typically takes one week, and you’ll be notified of your app status, which could be:</p>

<ul>
<li>Approved</li>
<li>Approved with non-blocking feedback</li>
<li>Rejected with feedback on how to get your app approved</li>
<li>Rejected on the basis of a policy, guideline, or conflict with the intended behavior of our products</li>
</ul>

<p>If you are submitting a new version of a previously approved app, review will typically go very quickly.</p>

<h2>Changing app visibility</h2>

<p>After your app has been approved, you may want to change the visibility status.</p>

<h3>Unlisted to public</h3>

<p>To make your unlisted app public after it's been approved, run:</p>

<p><code>tsx
devvit upload
devvit publish --public
</code></p>

<h3>Public to unlisted</h3>

<p>To hide all versions of your app from the public after it’s been listed, please reach out to the Developer Platform team via r/Devvit or Discord.</p>

<h2>Promotion</h2>

<p>If you need help finding the right place on Reddit for your app, reach out to our team. In some cases we may be able to:</p>

<ol>
<li>Provide guidance on the right home(s) for your app</li>
<li>Help you coordinate with subreddit moderators</li>
<li>Connect you with users that would be interested in your app</li>
<li>Run playtests for your app, provide feedback, and improve your app</li>
<li>Provide other materials, like visual assets, to help you market your app</li>
<li>Give guidance on how to grow a subreddit</li>
</ol>

<p>We cannot help facilitate the success of all apps, but we will provide guidance whenever possible. Reach out to one of our support channels to chat with our team.</p>

<p>:::note
Make sure you don’t break subreddit rules or sitewide content policies when promoting your app on Reddit.
:::</p>
<h1>Reddit Developer Funds 2025</h1>

<p>Reddit developer funds is a way for developers to earn money for the apps they build.</p>

<h2>What we’re looking for</h2>

<p>We want creative new apps that enrich the Reddit community through:</p>

<ul>
<li>A new experience, like a <a href="https://developers.reddit.com/docs/showcase/apps#live-scores">live score board</a> or <a href="https://developers.reddit.com/docs/showcase/apps#bingo">community bingo</a></li>
<li>An entirely new community created around the app, like <a href="https://www.reddit.com/r/Pixelary/">r/pixelary</a> or <a href="https://www.reddit.com/r/riddonkulous/">r/riddonkulous</a></li>
<li>A quality of life improvement that benefits hundreds of subreddits</li>
</ul>

<h2>How it works</h2>

<p>The Reddit Developer Funds 2025 program (the “Program”) will run from April 1, 2025 - Dec 31, 2025. The Program is focused on reach, and success will be measured by Daily Qualified Engagers and Qualified Installs defined as:</p>

<ul>
<li><p>A “Qualified Install” means that a subreddit has your app installed and that subreddit: 1) has a minimum of 1,000 members, and 2) is eligible for monetization under Reddit’s Earn Policy (e.g., that is Safe for Work).</p></li>
<li><p>A “Daily Qualified Engager” is a unique user that clicks and takes an action in your App for a specific day that: 1) occurs after April 1, 2025; 2) is logged in; 3) is in a subreddit that has a minimum of 200 members, and 4) is in a subreddit or on content that is eligible for monetization under Reddit’s Earn Policy (e.g., that is Safe for Work).</p></li>
</ul>

<p>Measurement and eligibility are further defined in our terms. Please reference our <a href="https://support.reddithelp.com/hc/en-us/articles/27958169342996">terms</a> when evaluating your app performance.</p>

<h2>Awards</h2>

<p>| Tier              | Threshold                          | Payout  | Cumulative Payout |
| :---------------- | :--------------------------------- | :------ | :---------------- |
| Tier 1 - Engagers | 500 daily qualified engagers       | $500    | $500              |
| Tier 2 - Engagers | 1,000 daily qualified engagers     | $1,000  | $1,500            |
| Tier 3 - Engagers | 10,000 daily qualified engagers    | $5,000  | $6,500            |
| Tier 4 - Engagers | 50,000 daily qualified engagers    | $10,000 | $16,500           |
| Tier 5 - Engagers | 250,000 daily qualified engagers   | $25,000 | $41,500           |
| Tier 6 - Engagers | 1,000,000 daily qualified engagers | $75,000 | $116,500          |</p>

<p>The Daily Qualified Engagers threshold(s) are determined on a rolling seven day average, which means that the average Daily Qualified Engagers for your app over the prior seven days exceeds a given threshold.</p>

<p>| Tier     | Threshold              | Payout |
| :------- | :--------------------- | :----- |
| Installs | 250 qualified installs | $1000  |</p>

<p>The “Qualified Install” threshold is met when your app exceeds the threshold below and maintains that number of qualified installs for a consecutive 7-day period.</p>

<h3>Eligibility restrictions:</h3>

<p>Apps are not eligible if they previously received a payout under Developer Funds. However, if you have an app that you are excited about that previously received a payout under Developer Funds that would otherwise qualify, please reach out to us. We may consider exceptions to this restriction.</p>

<h2>Program rules</h2>

<ul>
<li>After you create your developer account, you'll be able to onboard <a href="https://www.reddit.com/contributor-program">here</a></li>
<li>Apps can only qualify once for each reward tier.</li>
<li>Don’t use spam, bots, or other forms of view manipulation, which may result in your disqualification from the program</li>
<li>The community comes first. Apps should only be installed where relevant, useful, or enriching</li>
<li>Up to three apps per developer can qualify for the funds program.</li>
<li>Apps should be unique, original, and created by you.
<ul>
<li>A significant portion of the code and app UI should be original (see the platform <a href="https://developers.reddit.com/docs/guidelines">devviquette</a>)</li>
<li>Forked versions of apps must be significantly different in concept and function</li>
<li>You are welcome to use elements from example code or templates as a starting point for your project, as well as tools from <a href="https://github.com/reddit/devvit-kit">Devvit Kit</a></li>
</ul></li>
<li>Apps must be on the latest version of Devvit</li>
</ul>

<p>To be eligible for the program please sign up by <a href="https://developers.reddit.com/create-account">creating a developer account</a>. You must have a verified reddit email in order to receive onboarding instructions.</p>

<h2>Tracking</h2>

<p>We want developers who are interested in this program to have the right tools for success - this includes tracking how your app is performing. Once you have signed up and onboarded onto the program <a href="https://forms.gle/nywmjkvR6P6Ax2fM7">fill out this form</a> to receive regular updates on your app’s performance.</p>

<h2>We’re here to help</h2>

<p>We want you to succeed! We can help facilitate conversations with moderators that you think would love your app. You can reach us at <a href="https://www.reddit.com/r/devvit/">r/devvit</a> or become a member of our <a href="https://discord.com/invite/R7yu2wh9Qz">Discord</a> server for support.</p>

<h2>Terms and conditions</h2>

<p>Additional terms and conditions apply; see the <a href="https://support.reddithelp.com/hc/en-us/articles/27958169342996">Reddit Developer Funds Terms</a> for the complete rules and restrictions.</p>
<h1>Release</h1>

<p>Now you're ready to make your app available to other redditors.</p>

<h2>Upload your app</h2>

<p>Uploading your app creates a private version of the app that you can see on developers.reddit.com. You can install this private version into subreddits you moderate to test and debug your app before you publish it.</p>

<p>To upload your app, enter <code>devvit upload</code> in your project directory. Your app's version number will be automatically incremented by 1 at this time, e.g. if this is your second upload, then your app would be version 2.0.0.0.</p>

<p><code>
$ devvit upload
</code></p>

<p>:::note</p>

<p>You can use devvit upload to test new versions of your app before making it available to other moderators.</p>

<p>:::</p>

<h2>Publish your app</h2>

<p>Publishing your app will make it discoverable to other users with permissions to install apps on developers.reddit.com. It is not yet possible for you to publish your own app. To publish your app, please <a href="https://reddit.com/message/compose/?to=/r/Devvit">contact us</a>.</p>

<p>:::note</p>

<p>Publishing a new version does not automatically upgrade existing installations of your app.</p>

<p>:::</p>

<h2>Add your app to a subreddit</h2>

<p>To add an app to your subreddit, find it on developers.reddit.com/apps. Go to the app details screen, and click "Install".</p>

<p><img src="./assets/install-app-button.png" alt="Post" /></p>

<p>This will give you a list of subreddits that will allow you to add the app. Generally, you can only add an app to subreddits that you moderate.</p>

<p>Select a subreddit to install the app.</p>

<p><img src="./assets/communities-install-list.png" alt="Post" /></p>

<h2>Load or refresh your subreddit</h2>

<p>Navigate to the subreddit. If the page is already open, <strong>refresh the page</strong>. It may take a few seconds for apps to load.</p>
<h1>Rendering apps</h1>

<p>Before your app is displayed on the screen, it needs to be rendered by Devvit. Understanding this process will help you think about how your code executes and explain its behavior.</p>

<h2>Client/server environments</h2>

<p>Devvit apps exist in two environments: client and server. As a developer, you don’t have to worry about it too much, but this concept is important to understand how things work under the hood.</p>

<p>To optimize app performance, Devvit executes on the client side as much as possible to avoid making unnecessary requests to the server. This is why app code is downloaded by the client and executed locally most of the time.</p>

<p>Some things can only be executed on the server side, including:</p>

<ul>
<li><code>onPress</code> handlers of <a href="./capabilities/menu-actions.md">menu actions</a></li>
<li><a href="./capabilities/scheduler.md">Scheduled actions</a></li>
<li>API requests (such as <a href="./api/redditapi/classes/RedditAPIClient.RedditAPIClient.md">Reddit API</a>, <a href="./capabilities/redis.md">Redis</a>, and <a href="./capabilities/http-fetch.md">HTTP fetch</a>)</li>
</ul>

<p>If the API request is encountered when the app code runs on the client, Devvit switches the code execution to the server side.</p>

<h2>Using state variables</h2>

<p>Your app relies on state variables to know what to render. The <code>useState</code> function declares the variable and contains:</p>

<ul>
<li>the current value</li>
<li>a value setter</li>
<li>the initial value/initialization function</li>
</ul>

<p><code>const [clickCount, setClickCount] = useState(0);</code></p>

<p>In this example <code>clickCount</code> holds the current value, <code>setClickCount</code> is the value setter function, and <code>0</code> is the initial value. When the initialization function is passed instead of initial value, the result of the function call is used as the initial value.</p>

<p>State variables are shared between client and server environments, and they persist through a single user session. If a user disconnects or navigates away from the page, the session ends and the state is invalidated.</p>

<h2>Rendering an app for the first time</h2>

<p>Each app is rendered separately for each user. For the first render, your application’s code is executed on the server and the calculated layout is sent to the client to display. The initial values of all state variables are calculated and used at this point. All the state variables are initialized one after the other.</p>

<p>At the same time, Devvit sets up the local environment for your app and downloads the app code. As soon as it’s done, the rendering switches to the client side. If a re-render needs to happen before the download is complete, Devvit will send a request to the server to get the new layout.</p>

<h2>Re-rendering the app</h2>

<p>To trigger a UI update, you need to update at least one of the state variables. You can do this by calling the value setter, which can be updated on user action or from an external event.</p>

<h3>Example: user action</h3>

<p><code>ts
const onClick = () =&gt; {
  const newValue = clickCount + 1;
  setClickCount(newValue);
};
</code></p>

<p>You can pass this function to <code>onPress</code> handler to react to user actions. If the handler has the API request, the execution will switch to the server side.</p>

<h3>Example: external event</h3>

<p>You can use intervals and realtime to trigger a UI update that is not initiated by the user.</p>

<p>In this countdown example, the value setter function is called inside the interval to update the UI based on a timer:</p>

<p>```ts
import { Devvit, useState, useInterval } from '@devvit/public-api';</p>

<p>const [counter, setCounter] = useState(1000);</p>

<p>const updateInterval = useInterval(() =&gt; {
  setCounter((counter) =&gt; counter - 1);
}, 1000);</p>

<p>updateInterval.start();
```</p>

<p>In the synced progress bar example, the value setter function is called inside the onMessage handler to update UI based on an external event.</p>

<p>```ts
const [progress, setProgress] = useState(0);</p>

<p>const progressChannel = useChannel({
  name: 'progress_state',
  onMessage: (message) =&gt; {
    setProgress(message.payload.progress);
  },
});</p>

<p>progressChannel.subscribe();
```</p>
<h1>Trigger actions</h1>

<p>Use <code>sendTo</code> to trigger an action.</p>
<h1>Monetization</h1>

<p>See how other developers add products and payments to <a href="../payments/payments_overview.md">monetize</a> their apps.</p>

<h2>Buildit</h2>

<p><a href="https://www.reddit.com/r/buildit/">Buildit</a> is a 2D platformer game developed by <a href="https://www.5thcell.com/">5th Cell</a> exclusively for Reddit.</p>

<p>Redditors compete in challenges to earn a top spot on the leaderboard, unlock custom flair, and shitpost in the comments along the way. They can also build their own challenges to share with the community.</p>

<h3>How to play</h3>

<p>Use your keyboard or the virtual buttons to move your Snoo. Try to reach the key as fast as possible, but watch out for traps!</p>

<p><img src="../assets/showcase/buildit_gameplay.gif" alt="Buildit play" /></p>

<p>You can also build a new level. Add tiles and objects to a custom map and throw down your challenge by posting it to the community.</p>

<p><img src="../assets/showcase/buildit_building.gif" alt="Buildit build" /></p>

<h3>Adding payments</h3>

<p>In-game purchasing is integrated into the “build” aspect of the game. There are a variety of free tiles available for redditors to use in the building process, or they can purchase special tile sets to customize their challenge. 5th Cell used the <a href="../payments/payments_overview.md">monetization</a> feature to add premium items to their game.</p>

<p><img src="../assets/showcase/buildit_purchasing.gif" alt="Buildit purchase" /></p>

<h3>From the developer</h3>

<p><em>Although the primary focus of buildit was on competition, we also wanted to allow players to customize the tile sets behind the levels. This was a perfect fit for monetization using Reddit gold. Including the SDK was quick and easy, and offers a small but important customization element to the final game.</em></p>

<p><em>It’s proven that adding optional purchases for core users can increase engagement and boost retention. We’re excited to see how players customize their levels in the future!</em></p>

<h2>Dark Dungeon</h2>

<p><a href="https://www.reddit.com/r/DarkDungeonGame/">Dark Dungeon</a> is an experimental game developed by <a href="https://www.cabbagesystems.com/">Cabbage Systems</a> exclusively for Reddit. Each <a href="interactive_posts.md">interactive post</a> contains a trap-filled dungeon, and you need to find the exit if you want to survive.</p>

<h3>How to play</h3>

<p>Click or tap to move your knight, and use the footsteps of past redditors to try to figure out an exit route. Along the way you’ll find much-needed food—and also the skulls of players who died in a trap and tombstones marking players who died of hunger.</p>

<p><img src="../assets/showcase/dark_dungeon.gif" alt="Dark Dungeon" /></p>

<h3>Adding payments</h3>

<p>Players are rewarded with gems (in-game currency) for every dungeon they successfully escape. These gems can be used to purchase powerful boosts—like lock picks that open any door, gut expanders to extend the hunger limit, and brighter torches to illuminate their path. Using the <a href="../payments/payments_overview.md">payments</a> feature, Cabbage Systems added the ability for players to also purchase in-game gems using Reddit Gold.</p>

<p><img src="../assets/showcase/dark_dungeon_shop.gif" alt="Dark Dungeon" /></p>

<h3>From the developer</h3>

<p><em>Cabbage Systems is proud to be the first team to integrate the payments API into a game for Reddit. Implementation was very straightforward, and went off without a hitch.</em></p>

<p><em>Our game wasn't designed from the beginning to include in-game purchases, so we were careful not to disrupt the game's original intention when adding the shop. By allowing Redditors to earn gems through gameplay or purchase them with Reddit Gold, we tried to leave room for Redditors who wanted to use Gold and those who didn't.</em></p>

<p><em>Dark Dungeon is a single-player game with community features, so we wanted to stock the game's shop with items that might help players when they're stuck, or encourage players to find secrets to share with the community. We believe it's important in games that include any kind of multiplayer interaction to avoid perceptions of "pay to win," so we did our best to keep the game fair for everyone.</em></p>

<h2>Riddonkulous</h2>

<p><a href="https://www.reddit.com/r/riddonkulous/">Riddonkulous</a> is a game developed by <a href="https://hammertime.studio/en">Hammertime Studio</a> (a Devvit Community Developer) using Reddit’s Developer Platform. Each <a href="../interactive_posts.md">interactive post</a> lets you create and solve riddles while earning XP and leveling up!</p>

<h3>How to play</h3>

<p>Players craft riddles in three ways:</p>

<ul>
<li>Classic: Use pre-set riddle templates (remplates) and a word catalog to create riddles.</li>
<li>Freestyle: Make riddles with any word and text of your choice.</li>
<li>AI Riddle: Let AI help generate riddles based on a given word.</li>
</ul>

<p>Redditors rack up XP by creating and solving riddles:</p>

<ul>
<li>+10 points for creating a riddle</li>
<li>+5 points for correctly solving a riddle</li>
<li>+3 points for the riddle creator if someone solves their riddle</li>
<li>+5 bonus points for cracking a tricky riddle</li>
</ul>

<p>XP stay within each subreddit, and your level determines what features you unlock!</p>

<p><img src="../assets/showcase/riddonkulous_guess.gif" alt="Riddonkulous game" /></p>

<h3>Adding payments</h3>

<p>Using the <a href="../payments/payments_overview.md">monetization</a> feature, Hammertime Studio added the ability for players to purchase AI credits using Reddit gold. Each AI credit enables players to generate one riddle using AI or unlock an AI generated hint for everyone as a comment. The option to unlock AI Riddle mode and buy AI credits becomes available once players reach level 5.</p>

<p><img src="../assets/showcase/riddonkulous_reddit_gold.gif" alt="Riddonkulous IAP" /></p>

<h3>From the developer</h3>

<p><em>Riddonkulous is bringing in In-App Purchases (IAP) as a way to earn extra in-game credits, without turning the game into a pay-to-play grind. Credits can be earned naturally through gameplay - solving and creating riddles - so progression feels rewarding, whether you spend real world money or not.</em></p>

<p><em>From a technical perspective, tying IAP products to an in-game currency keeps things flexible. It reflects a single source of truth for exclusive and non-exclusive features. The Purchase API, through its integrated payment providers, is made easy for new or experienced Devvit developers.</em></p>

<p><em>Good in-game purchasing isn’t just about monetization, from my personal standpoint, it’s about making the game more fun. Instead of just unlocking perks for themselves, players can use credits to the benefit of the whole community, for example unlocking a hint for everyone in the comments. A shared experience is way more engaging than just buying an edge for yourself, and is intended to boost the community-driven spirit of Riddonkulous.</em></p>

<p><em>For the planned Riddle Raid Boss event features, players will be able to re-buy health while working together to take down a massive Riddle Raid Boss. The goal isn’t PVP dominance - it’s about collaborative riddle-solving. By giving players ways to stay in the game when things get tough, IAP helps keep the challenge fun rather than frustrating, encouraging players to stick around longer and stay invested in the experience. You might find yourself also giving health to your Raid friends through IAP as well.</em></p>

<h2>Next steps</h2>

<p>Learn how to <a href="../payments/payments_overview.md">monetize</a> your app!</p>
<h1>Tutorials</h1>

<h2><a href="./tutorials/intro-to-devvit.mdx">Intro to Devvit</a></h2>

<p>This interactive tutorial will help you get to know Devvit and help <a href="https://www.reddit.com/r/Devvit/">r/Devvit</a> get to know you! You'll learn how to work with templates, run a playtest, and create an interactive post on Reddit. When you're done, you'll have your own introduction post that you can share with the community.</p>

<p><strong>Capabilities used:</strong></p>

<ul>
<li><a href="../templates.mdx">Templates</a></li>
<li><a href="../interactive_posts.md">Interactive Posts</a></li>
<li><a href="../playtest.md">Playtest</a></li>
</ul>

<h2><a href="./tutorials/remind_me.md">Remind me</a></h2>

<p>Learn how to implement a Remind Me Later feature on Reddit using scheduler and the Reddit API client. The tutorial covers creating scheduled jobs, displaying custom input forms, and leveraging the chrono-node library to interpret user-inputted timeframes like "in two weeks." Users can set reminders from the overflow menu of a post, and the Remind Me app automatically sends private messages containing post links at the scheduled times, enhancing user engagement.</p>

<p><strong>Capabilities used:</strong></p>

<ul>
<li><a href="../capabilities/menu-actions">Menu actions</a></li>
<li><a href="../capabilities/forms">Forms</a></li>
<li><a href="../capabilities/scheduler">Scheduler</a></li>
</ul>

<h2><a href="./tutorials/three_strikes.md">Three strikes</a></h2>

<p>In this tutorial, you'll learn to implement a powerful moderation tool using Redis and the Reddit API, creating a "Three Strikes" system to manage rule violations within a community. The tutorial guides you through setting up the app, adding menu actions, and creating mod functionalities. The "Three Strikes" system imposes escalating penalties: a warning message for the first strike, a one-day community ban for the second, and a one-year ban for the third. The tutorial covers creating keys for authors using Redis, fetching posts and comments, checking and removing strikes, and even banning users when necessary. With step-by-step instructions and code snippets, you'll build a robust moderation tool that enhances community management on Reddit.</p>

<p><strong>Capabilities used:</strong></p>

<ul>
<li><a href="../capabilities/menu-actions">Menu actions</a></li>
<li><a href="../capabilities/forms">Forms</a></li>
<li><a href="../capabilities/redis">Redis</a></li>
</ul>
<h1>Remind me tutorial</h1>

<p>Use scheduler and the Reddit API client to set up a reminder message.</p>

<p>In this tutorial, you'll learn how to:</p>

<ul>
<li>create scheduled jobs using <code>Devvit.addScheduledJobType</code></li>
<li>create and show custom forms to prompt for user input</li>
<li>fetch user info using the <code>reddit</code> api client</li>
</ul>

<p>The <strong>Remind Me Later</strong> option is located in the overflow menu of a post (look for the three dots). When selected, the user is prompted to enter a future time for the reminder. The <a href="https://www.npmjs.com/package/chrono-node">chrono-node</a> library interprets the input as a regular sentence (for example, "in two weeks") to generate a timestamp. At the specified time, the Remind Me app sends the user a private message containing a link to the original post.</p>

<p>| Post menu                                               | User input                                               |
| ------------------------------------------------------- | -------------------------------------------------------- |
| <img src="../../assets/remind_me_bot_menu_entry.png" alt="Post menu" /> | <img src="../../assets/remind_me_bot_input_form.png" alt="User input" /> |</p>

<h2>Start a project</h2>

<!-- :::info -->

<!-- The fully-functioning code in this tutorial is also available in the `remind-me` template. Simply type `devvit new --template remind-me <replace-with-your-app-name>` to start a project with the code below already written. -->

<!-- ::: -->

<p>To create a Remind Me app starting from an empty template:</p>

<ol>
<li>From the terminal, navigate to a directory where you'll store your project (e.g. <code>cd ~/my/project/directory</code>).</li>
<li>Enter the following command to create a project folder on your local machine.</li>
</ol>

<p><code>bash
devvit new &lt;replace-with-your-app-name&gt;
</code></p>

<p>This creates a new directory in your current directory named <code>&lt;your-app-name&gt;</code>. You may change into
that directory to see the template folder structure of a devvit app.</p>

<ol start="3">
<li>In your new project, open <code>main.ts</code> your editor (we recommend VS Code).</li>
</ol>

<p>```bash
your-app-name
├── devvit.yaml
├── package.json
├── src
│   └── main.ts        # &lt;- the main code is here (ignore the rest for now)
├── tsconfig.json
├── yarn.lock</p>

<p>```</p>

<h2>Install dependencies</h2>

<p>This app uses <code>chrono-node</code> and <code>@devvit/public-api</code>, which you'll need to manually add as dependencies.</p>

<ol start="4">
<li>Install packages for this app using your favorite package manager.</li>
</ol>

<p><code>bash
npm i @devvit/public-api chrono-node &amp;&amp;\
npm install
</code></p>

<p><strong>or</strong></p>

<p><code>bash
yarn add @devvit/public-api chrono-node &amp;&amp;\
yarn
</code></p>

<ol start="5">
<li>Make sure your project registered the update by checking the <code>package.json</code> file in your app's root directory.</li>
</ol>

<p>```bash
your-app-name
├── devvit.yaml
├── package.json        # &lt;- check this file
├── src
│   └── main.ts
├── tsconfig.json
├── yarn.lock</p>

<p>```</p>

<p>The <code>package.json</code> file should have a <code>dependencies</code> entry with <code>chrono-node</code> and <code>@devvit/public-api</code>.</p>

<p><code>bash
{
  ...
  "dependencies": {
    "chrono-node": "some.version.number"            // &lt;- chrono node has been registered in this project!
    "@devvit/public-api": "some.version.number" // &lt;- @devvit/public-api has been registered in this project!
  }
  ...
}
</code></p>

<p>:::note</p>

<p>Your <code>package.json</code> file will include other fields, and that's to be expected! Just make sure that
<code>@devvit/public-api</code> and <code>chrono-node</code> are present.</p>

<p>:::</p>

<p>:::note
If you are having trouble installing <code>chrono-node</code>, check out our <a href="../../quickstart.mdx">quickstart</a> to make sure your environment is set up properly.
:::</p>

<h2>Add code</h2>

<p>Copy and paste the following sequence of code snippets into <code>src/main.ts</code> file.</p>

<ol start="6">
<li>Add the following imports at the top.</li>
</ol>

<p><code>typescript
import { Devvit, FormOnSubmitEvent } from '@devvit/public-api';
import * as chrono from 'chrono-node';
</code></p>

<ol start="7">
<li>Configure your app to use the necessary capabilities.</li>
</ol>

<p>```typescript
Devvit.configure({
  redditAPI: true, // &lt;-- this allows you to interact with Reddit's data api
});</p>

<p>const REMIND<em>ME</em>ACTION_NAME = 'remindme'; // &lt;-- reusable action ID constant that will be useful later
```</p>

<ol start="8">
<li>Define the form that gets popped open when a user clicks on the menu item.</li>
</ol>

<p>```typescript
const remindMeForm = Devvit.createForm(
  {
    fields: [{ name: 'when', label: 'When?', type: 'string' }],
    title: 'Remind me',
    acceptLabel: 'Schedule',
  },
  remindMeHandler // defined below
);</p>

<p>// this handler function defines the behavior when <code>remindMeForm</code> is submitted
async function remindMeHandler(event: FormOnSubmitEvent, context: Devvit.Context) {
  const whenStr = (event.values.when as string) || '';
  if (!whenStr) {
    context.ui.showToast("I don't know when to remind you!");
    return;
  }</p>

<p>const parsedTime = chrono.parseDate(whenStr);
  const now = new Date();</p>

<p>if (parsedTime &lt; now) {
    context.ui.showToast("I can't remind you in the past!");
    return;
  }
  const currentUser = await context.reddit.getCurrentUser();</p>

<p>await context.scheduler.runJob({
    name: REMIND<em>ME</em>ACTION_NAME,
    data: {
      userId: currentUser.id,
      postId: context.postId,
      fromWhen: now,
    },
    runAt: parsedTime,
  });</p>

<p>context.ui.showToast(<code>Gotcha! I'll send you a message about this post at ${parsedTime}!</code>);
}
```</p>

<ol start="9">
<li>Add a menu item that pops open a form when clicked by a user.</li>
</ol>

<p><code>typescript
Devvit.addMenuItem({
  label: 'Remind me later',
  location: 'post',
  // here we tell the ui client to show `remindMeForm` defined above when the
  // menu item is pressed
  onPress: (_, context) =&gt; {
    context.ui.showForm(remindMeForm);
  },
});
</code></p>

<ol start="10">
<li>Define and schedule a job to be run at a given time in the future.</li>
</ol>

<p>```typescript
Devvit.addSchedulerJob({
  name: REMIND<em>ME</em>ACTION_NAME,
  onRun: async (event, context) =&gt; {
    const { userId, postId, fromWhen } = event.data!;</p>

<pre><code>const user = await context.reddit.getUserById(userId);
const post = await context.reddit.getPostById(postId);

await context.reddit.sendPrivateMessage({
  to: user.username,
  subject: 'RemindMe',
  text: `Beep boop! You asked me to remind you about [${post.title}](${post.permalink}) at ${fromWhen}!`,
});
</code></pre>

<p>},
});
```</p>

<p>:::note</p>

<p>You might be a little scared by the <code>async</code>, <code>await</code> and <code>Promise</code> keywords--don't be! These core Javascript concepts just mean this function has to wait for an asynchronous response like the return value of an HTTP request. In this example, the <code>await</code> means "don't go to the next line until we get a response from the Reddit API". Once the promise is resolved, the code can continue to execute. Check out <a href="https://javascript.info/promise-basics">this overview</a> to learn more <code>async</code>/<code>await</code>.</p>

<p>:::</p>

<p>:::note</p>

<p>Apps are executed as the app account that gets created upon upload (we will see how this is done in
the next section). This means that the reminder messages defined in this app will be sent from the
app's auto-generated account.</p>

<p>:::</p>

<ol start="11">
<li>Make sure to export <code>Devvit</code> at the end of the file.</li>
</ol>

<p><code>typescript
export default Devvit;
</code></p>

<h2>Complete the project</h2>

<h3>Upload your app</h3>

<p>Your app is now ready for uploading to <a href="https://developers.reddit.com"> Reddit Developer Portal </a>.</p>

<p>Run this in your project directory:</p>

<p><code>bash
devvit upload
</code></p>

<p>This command will run a series of checks and prompts to make sure that your app is in a good state before its uploaded. Once the upload is completed, you'll see a link to your app's detail page on Developer Portal. Click on the link to open it in the browser.</p>

<h3>Install your app on a subreddit</h3>

<p>Click on the <code>Install</code> button at the top right of the detail page, and select a subreddit(s) where you want to install the app.</p>

<p><img src="../../assets/install.png" alt="Install" /></p>

<h3>Use your app</h3>

<p><strong>Refresh your subreddit page.</strong> When you want to use the Remind Me app, click on the overflow menu (look for the three dots) and select "Remind Me Later" menu item.</p>

<p><img src="../../assets/remind_me_bot_menu_entry.png" alt="Remind Me" /></p>

<p>You'll be prompted to enter a time you want to receive the reminder. When this is done, a toast pops up at the bottom of the page to either confirm the message reminder or highlight any input errors.</p>

<p><img src="../../assets/remind_me_bot_success_toast.png" alt="Successful reminder" /></p>

<p>If the input was invalid or left blank, you'll see the corresponding error toast.</p>

<p>| Invalid                                                            | Blank                                                                  |
| ------------------------------------------------------------------ | ---------------------------------------------------------------------- |
| <img src="../../assets/remind_me_bot_failed_toast_past.png" alt="Failed - past" /> | <img src="../../assets/remind_me_bot_failed_toast_unknown.png" alt="Failed - blank" /> |</p>

<h2>Next steps</h2>

<p>Congratulations on getting your Remind Me app running! Next up:</p>

<ul>
<li>Learn how to use Redis in our <a href="./three_strikes.md">Three Strikes tutorial</a>.</li>
<li>Add <a href="../../get-started/debug.md">logging</a> to your app to help you debug.</li>
</ul>
<h1>Three strikes tutorial</h1>

<p>Use Redis, create an author key, and add menu actions to create a mod tool.</p>

<p>This app allows a moderator to remove rule-breaking content and use a "three strike" system to manage users who violate community rules. The penalties become more severe with each strike:</p>

<p><strong>Strike 1</strong>: Sends a private warning message the user.<br />
<strong>Strike 2</strong>: Bans the user from the community for one day.<br />
<strong>Strike 3</strong>: Bans the user from the community for one year.</p>

<p>| Post menu                                                  | Comment menu                                                     |
| ---------------------------------------------------------- | ---------------------------------------------------------------- |
| <img src="../../assets/three_strikes_app_post_menu.png" alt="Post menu" /> | <img src="../../assets/three_strikes_app_comment_menu.png" alt="Comment menu" /> |</p>

<h2>Start a project</h2>

<p>To create a Three Strikes app, use the default empty <a href="../../get-started/create-app.md#templates">template</a> to start a new project.</p>

<ol>
<li>From the terminal, navigate to a directory where you'll store your project.</li>
<li>Enter the following command to create a project folder on your local machine.</li>
</ol>

<p><code>bash
devvit new &lt;replace-with-your-app-name&gt;
</code></p>

<ol start="3">
<li>In your new project, open <code>main.ts</code> in your code editor (we recommend VS Code).</li>
</ol>

<p><code>bash
your-app-name
├── devvit.yaml
├── package-lock.json  # If you use yarn, this will be yarn.lock
├── package.json
├── src
│   └── main.ts     # &lt;- the main code is here (ignore the rest for now)
├── tsconfig.json
</code></p>

<ol start="4">
<li>Add the following code to the top of the `main.ts' file (you can replace the existing import statement).</li>
</ol>

<p><code>typescript
import { Devvit, MenuItemOnPressEvent, User } from '@devvit/public-api';
</code></p>

<p>Importing this code adds core classes and plugins from the Reddit Developer Platform (<code>@devvit/public-api</code>).</p>

<ol start="5">
<li>Add the <a href="/docs/capabilities/redis.md">Redis plugin</a>. This plugin allows you to store data in your app that will be there the next time it’s run. You also need to enable access to the Reddit API.</li>
</ol>

<p><code>typescript
Devvit.configure({
  redis: true,
  redditAPI: true,
});
</code></p>

<h2>Create helper methods</h2>

<h3>Create an author key</h3>

<p>Redis lets you store data in your app (for example, the number of strikes a user has). Each uniquely identified key is paired with an associated value and is available every time the app is run.</p>

<ol start="6">
<li>For the three strikes app, you’ll create a key for the author of the post or comment, where {author} is a Reddit username and the associated value is the user’s strike value.</li>
</ol>

<p><code>typescript
/**
 * Creates a Redis key for the author
 */
function getKeyForAuthor(author: User) {
  return `$\{author.id}_strikes`;
}
</code></p>

<h3>Get the offending post or comment</h3>

<ol start="7">
<li>Add a function that will take the onPress event and retrieve the associated post or comment</li>
</ol>

<p><code>typescript
async function getThing(event: MenuItemOnPressEvent, context: Devvit.Context) {
  if (event.location === 'post') {
    return await context.reddit.getPostById(event.targetId);
  } else if (event.location === 'comment') {
    return await context.reddit.getCommentById(event.targetId);
  }
  throw 'Cannot find a post or comment with that ID';
}
</code></p>

<h3>Get the author of the post or comment</h3>

<ol start="8">
<li>Add a function that will get the author of the post or comment</li>
</ol>

<p><code>typescript
async function getAuthor(event: MenuItemOnPressEvent, context: Devvit.Context) {
  const thing = await getThing(event, context);
  return await context.reddit.getUserById(thing.authorId!);
}
</code></p>

<h2>Add mod menu functionality</h2>

<p>Strike functionality is added to the mod menu so that the moderator can remove rule-breaking content and manage users who violate the community’s guidelines. Add the following code to your <code>main.ts</code> file.</p>

<h3>Check user's strikes</h3>

<p>This function determines if the author currently has any strikes.</p>

<ol start="9">
<li>Add the <code>getAuthorStrikes</code> function to sync with the Redis plugin.</li>
</ol>

<p><code>typescript
async function getAuthorStrikes(author: User, context: Devvit.Context) {
  const key = getKeyForAuthor(author);
  return ((await context.redis.get(key)) as number) || 0;
}
</code></p>

<ol start="10">
<li>Add the <code>checkStrikes</code> function to get data from the post or comment.</li>
</ol>

<p><code>typescript
async function checkStrikes(event: MenuItemOnPressEvent, context: Devvit.Context) {
  const author = await getAuthor(event, context);
  const strikes = await getAuthorStrikes(author, context);
  context.ui.showToast(`Author u/$\{author.username} strike count: ${strikes}`);
}
</code></p>

<p>When this option is selected from the mod menu, a toast returns the number of strikes at the bottom of the page.</p>

<p><img src="../../assets/three_strikes_app_author_strike_count.png" alt="Author strike count" /></p>

<h3>Remove strike from author</h3>

<p>This function allows the moderator to change a user’s strike count.</p>

<ol start="11">
<li>Add the <code>setAuthorStrikes</code> function to update the strike counter in the Redis plugin.</li>
</ol>

<p><code>typescript
async function setAuthorStrikes(author: User, strikes: number, context: Devvit.Context) {
  const key = getKeyForAuthor(author);
  await context.redis.put(key, strikes);
}
</code></p>

<ol start="12">
<li>Add the <code>removeStrike</code> function to check the metadata in the Redis plugin and update the strike counter for the author.</li>
</ol>

<p>```typescript
async function removeStrike(event: MenuItemOnPressEvent, context: Devvit.Context) {
  // Get some relevant data from the post or comment
  const author = await getAuthor(event, context);
  let strikes = await getAuthorStrikes(author, context);</p>

<p>if (strikes &gt; 0) {
    await setAuthorStrikes(author, --strikes, context);
    context.ui.showToast(
      <code>Removed a strike from u/$\{author.username}. Remaining strikes: ${strikes}.</code>
    );
    return;
  }</p>

<p>context.ui.showToast(<code>u/$\{author.username} does not have any strikes!</code>);
}
```</p>

<p>If a mod attempts to remove a strike when a user’s strike count is zero, an error toast appears at the bottom of the screen.</p>

<p><img src="../../assets/three_strikes_app_no_strikes.png" alt="Strike count error toast" /></p>

<h3>Remove all strikes from author</h3>

<p>This function updates metadata in the Redis plugin and resets the strike counter for the author to zero.</p>

<ol start="13">
<li>Add the <code>clearStrikes</code> function.</li>
</ol>

<p>```typescript
async function clearStrikes(event: MenuItemOnPressEvent, context: Devvit.Context) {
  // Get some relevant data from the post or comment
  const author = await getAuthor(event, context);
  const hadStrikes = await getAuthorStrikes(author, context);</p>

<p>if (hadStrikes &gt; 0) {
    await setAuthorStrikes(author!, 0, context);
    context.ui.showToast(
      <code>Cleared ${hadStrikes} strike${hadStrikes !== 1 ? 's' : ''} from u/$\{author.username}!</code>
    );
    return;
  }</p>

<p>context.ui.showToast(<code>u/$\{author.username} does not have any strikes!</code>);
}
```</p>

<h3>Remove and strike</h3>

<p>This function shows the mod where the action came from, pulls relevant data from the post or comment (including name, author, and permalink), and adds a strike to the user’s account. Then the content is removed by the <a href="https://www.reddit.com/dev/api#POST_api_remove">Reddit Remove Post API</a>. If this is the third strike for a user, the <a href="https://www.reddit.com/dev/api#POST_api_friend">Reddit Friend API</a> bans the user from the community.</p>

<ol start="14">
<li>Add the <code>strike</code> function.</li>
</ol>

<p>```typescript
async function strike(event: MenuItemOnPressEvent, context: Devvit.Context) {
  // Use the correct term in our message based on what was acted upon
  const thing = await getThing(event, context);
  const author = await getAuthor(event, context);
  /**
   * Remove the content
   * See: https://www.reddit.com/dev/api#POST<em>api</em>remove
   *
   * NOTE: Apps are executed as the moderator that installed this app and
   *       must have permission to remove content for this to work!
   */
  await thing!.remove();</p>

<p>// Add a strike to the user and persist it to the Redis plugin
  let strikes = await getAuthorStrikes(author, context);
  await setAuthorStrikes(author, ++strikes, context);</p>

<p>// What we'll send the user in a private message
  let pmMessage = '';
  // Used to tell the moderator what punishment the user received
  let punishment = '';
  // Ban if they're on their 2nd or 3rd strike
  let ban = true;
  // We'll determine how long the ban lasts based on how many strikes they have
  let days = 0;</p>

<p>// Get the current subreddit from the metadata
  const subreddit = await context.reddit.getCurrentSubreddit();
  const permalink = thing.permalink;
  const location = event.location;
  switch (strikes) {
    case 1:
      // first strike, send a warning
      pmMessage = <code>You have received a strike and your ${location} has been removed from ${subreddit.name} for breaking the rules. Another strike will result in a 1-day ban.\n\n${permalink}</code>;
      punishment = <code>sent a warning</code>;
      ban = false;
      break;
    case 2:
      // second strike, temp ban, warn again
      days = 1;
      pmMessage = <code>You have received your second strike and your ${location} has been removed from ${subreddit.name} and you have been banned for 1 day for breaking the rules.\n\nONE MORE STRIKE WILL RESULT IN A 1-YEAR BAN FROM THIS SUBREDDIT.\n\n${permalink}</code>;
      punishment = <code>banned for 1 day</code>;
      break;
    case 3:
    default:
      // third (and any subsequent strikes), ban for 1 year from now
      days = 365;
      pmMessage = <code>You have been banned from ${subreddit.name} for one year for receiving ${strikes} strikes for your ${location}.\n\n${permalink}</code>;
      punishment = <code>banned for 1 year</code>;
      break;
  }</p>

<p>/**
   * Send a private message to the user
   * See: https://www.reddit.com/dev/api#POST<em>api</em>compose
   *
   * NOTE: Apps are executed as the moderator that installed this app into a
   *       subreddit and will be used as the user that sends this message!
   */
  await context.reddit.sendPrivateMessage({
    to: author.username,
    subject: <code>Received a strike on ${subreddit.name}</code>,
    text: pmMessage,
  });</p>

<p>const result = <code>u/$\{author.username} strikes: ${strikes} and has been ${punishment}.</code>;</p>

<p>if (ban) {
    const currentUser = await context.reddit.getCurrentUser();
    await context.reddit.banUser({
      subredditName: subreddit.name,
      username: author.username,
      duration: days,
      context: thing!.id,
      reason: <code>Received ${strikes} strike${strikes !== 1 ? 's' : ''} for breaking subreddit rules</code>,
      note: <code>Strike added by ${currentUser.username}</code>,
    });
  }</p>

<p>context.ui.showToast(result);
}
```</p>

<h3>Compose a message</h3>

<p>When a mod selects the <strong>Remove and strike</strong> menu option, a private message is sent to the user with the appropriate warning based on the user’s number of strikes. There is boilerplate text in the <a href="#Remove-and-strike">strike functionality</a> you added earlier. If you would like to modify the messages, edit that file under the appropriate strike count.</p>

<h2>Add menu actions</h2>

<p>You can use the <code>Devvit.addMenuItem</code> method to add menu names to functions you just set up. This is where you determine where the menu actions will show up (for example, setting location: 'post' means that your menu action will appear in the moderation menu of a post). The <code>onPress</code> parameter defines the function that is called when the action is invoked.</p>

<ol start="15">
<li>Use <code>Devvit.addMenuItem</code> to create a new overflow menu item called "Three Strikes".</li>
</ol>

<p>```typescript
/**
 * Declare our custom mod-only actions and add it to Posts and Comments
 */
Devvit.addMenuItem({
  label: 'Remove and Strike',
  location: ['post', 'comment'],
  forUserType: 'moderator',
  onPress: strike,
});</p>

<p>Devvit.addMenuItem({
  label: <code>Check User's Strikes</code>,
  location: ['post', 'comment'],
  forUserType: 'moderator',
  onPress: checkStrikes,
});</p>

<p>Devvit.addMenuItem({
  label: 'Remove Strike from Author',
  location: ['post', 'comment'],
  forUserType: 'moderator',
  onPress: removeStrike,
});</p>

<p>Devvit.addMenuItem({
  label: 'Remove All Strikes from Author',
  location: ['post', 'comment'],
  forUserType: 'moderator',
  onPress: clearStrikes,
});
```</p>

<h2>Complete the project</h2>

<p>You’ll know your project is complete when you see the following (kinda cryptic) line at the end of your code.</p>

<p><code>typescript
export default Devvit;
</code></p>

<p>All of the code above this line modified the core Devvit object. This line simply makes the updated Devvit object (which now implements the Three Strikes app) available to the Reddit Developer Platform. When this new instance of Devvit is installed on a subreddit, it will contain the three strikes menu shortcut and the logic you just wrote to make it work.</p>

<h3>Upload your app</h3>

<p>Your app is now ready to upload! Move into the top-level directory and use <code>devvit upload</code> to upload your app to the Reddit Developer Platform. Make sure to install this in a subreddit you moderate.</p>

<p><code>bash
`your-app-name      # &lt;- you should be here
├── devvit.yaml
├── package-lock.json  # If you use yarn, this will be yarn.lock
├── package.json
├── src
│   └── main.ts
├── tsconfig.json
</code></p>

<h3>Use your app</h3>

<p>When you want to use the Three Strikes app, click on the mod menu (shaped like a shield) and select the appropriate action.</p>

<p>| Post menu                                                  | Comment menu                                                     |
| ---------------------------------------------------------- | ---------------------------------------------------------------- |
| <img src="../../assets/three_strikes_app_post_menu.png" alt="Post menu" /> | <img src="../../assets/three_strikes_app_comment_menu.png" alt="Comment menu" /> |</p>

<h2>Next steps</h2>

<p>Congratulations on getting your Three Strikes app running! Next up: add <a href="../../debug">logging</a> to your app to help you debug.</p>
<h1>Support</h1>

<p>Guidelines, limitations, and help.</p>

<ul>
<li><a href="beta_participation.md">Beta participation</a></li>
<li><a href="limits">Limitations</a></li>
<li><a href="help.md">Help</a></li>
</ul>
<h1>Text fallback for older platforms</h1>

<p>Some surfaces (like old.reddit) don’t render interactive posts. To remedy this, use textFallback to ensure that you can specify the text for the instances when Devvit cannot render your post. You can do this with a text string or in rich text.</p>

<h2>Use a text string</h2>

<p><code>tsx
const post = await reddit.submitPost({
  title: 'Devvit post with text fallback',
  subredditName: subreddit.name,
  textFallback: { text: 'This is a text fallback' },
  preview: (
    &lt;vstack height="100%" width="100%" alignment="middle center"&gt;
      &lt;text size="large"&gt;View me in old.reddit!&lt;/text&gt;
    &lt;/vstack&gt;
  ),
});
</code></p>

<p><strong>Example</strong></p>

<p><img src="./assets/fallback_text_string.png" alt="text string fallback" /></p>

<h2>Use a text string with markdown</h2>

<p><code>tsx
const post = await reddit.submitPost({
  title: 'Devvit post with markdown text fallback',
  subredditName: subreddit.name,
  textFallback: {
    text: '**[Check out the developer platform docs](https://developers.reddit.com/docs/)**',
  },
  preview: (
    &lt;vstack height="100%" width="100%" alignment="middle center"&gt;
      &lt;text size="large"&gt;View me in old.reddit!&lt;/text&gt;
    &lt;/vstack&gt;
  ),
});
</code></p>

<p><strong>Example</strong></p>

<p><img src="./assets/fallback_markdown.png" alt="text string fallback" /></p>

<h2>Use rich text</h2>

<p>```tsx
const textFallbackRichtext = new RichTextBuilder()
  .heading({ level: 1 }, (h) =&gt; {
    h.rawText('Yay for text fallbacks!');
  })
  .codeBlock({}, (cb) =&gt; cb.rawText('This post was created via the Devvit API.'));</p>

<p>const post = await reddit.submitPost({
  title: 'Devvit post with richtext fallback',
  subredditName: subreddit.name,
  textFallback: { richtext: textFallbackRichtext },
  preview: (
    <vstack height="100%" width="100%" alignment="middle center">
      <text size="large">View me in old.reddit!</text>
    </vstack>
  ),
});
```</p>

<p><strong>Example</strong></p>

<p><img src="./assets/fallback_richtext.png" alt="text string fallback" /></p>

<h2>Update a post’s text fallback</h2>

<p>The post author can edit and update text fallback content after it’s been created. To do this, call post.setTextFallback with the desired fallback content.</p>

<p><code>tsx
// from a menu action, form, scheduler, trigger, custom post click event, etc
const newTextFallback = { text: 'This is an updated text fallback' };
const post = await context.reddit.getPostById(context.postId);
await post.setTextFallback(newTextFallback);
</code></p>
<h2>View your app</h2>

<p>To see your app in action:</p>

<ol>
<li>Navigate to <a href="https://www.reddit.com">reddit.com</a> on your desktop web browser (Android and iOS support are coming soon!).</li>
<li>Go to the subreddit where you installed your app.</li>
<li>Make sure there is at least one post.</li>
<li>Click the three dots on the bottom of the post. You'll see several robot icons with your app's associated actions at the bottom of the menu.</li>
</ol>

<p><img src="./assets/qs_complete.png" alt="qs complete" /></p>
<h1>Web views</h1>

<p>Web views allow you to include HTML, CSS, and JavaScript and have it run within your Reddit app. This gives you full control over your app's appearance and behavior while running within Reddit's platform.</p>

<h2>Migration guide</h2>

<p><details>
  <summary>Click here for instructions on how to migrate from the web view component to the new useWebView hook.</summary>
  <div>
    <div></p>

<p>This migration guide helps you migrate from using the web view component with visibility toggle, as used in our web-view-post template, to using the new useWebView hook. This will give you access to more gestures and sounds, and make sure your apps are performant in Reddit feeds.</p>

<p><strong>Overview</strong></p>

<p>The <code>useWebView</code> hook simplifies web view management with three main parameters:</p>

<ul>
<li>url: The URL of your web view content</li>
<li>onMessage: Handler for messages from the web view</li>
<li>onUnmount: Cleanup function that runs when the web view is closed</li>
</ul>

<p>Instead of managing visibility with state, you'll use the mount function returned by the hook to open the web view.</p>

<p><strong>Before (web view component)</strong></p>

<p>```ts
// Managing visibility with state
const [webViewVisible, setWebViewVisible] = useState(false);</p>

<p>// Message handler
const onMessage = async (msg) =&gt; {
  if (msg.type === 'setCounter') {
    await context.redis.set(<code>counter_${context.postId}</code>, msg.data.newCounter.toString());
    setCounter(msg.data.newCounter);
  }
};</p>

<p>return (
  <vstack>
    <button onPress={() =&gt; setWebViewVisible(true)}&gt;Launch App</button>
    {webViewVisible ? <webview id="myWebView" url="page.html" onMessage={onMessage} /> : null}
  </vstack>
);
```</p>

<p><strong>After (useWebView hook)</strong></p>

<p>```ts
import { useWebView } from '@devvit/public-api';</p>

<p>// Using useWebView hook
const { mount } = useWebView({
  // URL of your web view content
  url: 'page.html',</p>

<p>// Message handler
  onMessage: async (message, webView) =&gt; {
    if (message.type === 'setCounter') {
      await context.redis.set(<code>counter_${context.postId}</code>, message.data.newCounter.toString());
      setCounter(message.data.newCounter);
    }
  },</p>

<p>// Cleanup when web view is closed
  onUnmount: () =&gt; {
    context.ui.showToast('Web view closed!');
  },
});</p>

<p>return (
  <vstack>
    <button onPress={mount}&gt;Launch App</button>
  </vstack>
);
```</p>

<p><strong>Key Differences</strong></p>

<ol>
<li>Opening the web view</li>
</ol>

<p>Old: Web view component was open immediately
The old web-view-post template toggled visibility with state (setWebViewVisible(true))</p>

<p>New: Use mount function from the hook</p>

<ol start="2">
<li>Message Handling</li>
</ol>

<p>Old: Separate onMessage function passed as a parameter to component
New: Defined directly in useWebView parameters, along with access to an onUnmount function</p>

<ol start="3">
<li>Cleanup</li>
</ol>

<p>Old: N/A
New: onUnmount parameter handles callback after cleanup</p>

</div>
    <br/>
  </div>
</details>

Supported platforms:

<ul>

<p><li>iOS (v2025.05)</li>
<li>Android (v2025.05)</li>
<li>Web</li></p>

</ul>

<h2>Getting started</h2>

Create a new web view project:

```bash
devvit new --template web-view-post
cd my-project
```

Your project structure will look like this.

```
my-project/
├── webroot/          # All web content goes here
│   ├── page.html     # Main HTML file
│   ├── styles.css    # Stylesheets
│   └── app.js        # JavaScript code
└── src/
    └── main.tsx      # Devvit app code
```

<h2>useWebView</h2>

The `useWebViewHook` integrates web views into your Devvit app. This opens a large viewport (full screen on mobile and a modal on web) and provides a clean interface for managing the web view lifecycle and communication.

<h3>Syntax</h3>

```typescript
/** Message from Devvit to the web view. */
export type DevvitMessage =
  | { type: 'initialData'; data: { username: string; currentCounter: number } }
  | { type: 'updateCounter'; data: { currentCounter: number } };

/** Message from the web view to Devvit. */
export type WebViewMessage =
  | { type: 'webViewReady' }
  | { type: 'setCounter'; data: { newCounter: number } };

const { mount, unmount, postMessage } = useWebView<WebViewMessage, DevvitMessage>({
  url: 'page.html',
  onMessage: (message, webView) => {},
  onUnmount: () => {},
});
```

<ul>

<p><li>url: the path to your HTML file relative to the webroot directory (defaults to ‘index.html’ if unspecified)</li>
<li>onMessage: callback function that handles messages received from the web view; it receives two parameters:</p>

<ul>
<li>message: the data sent from the web view via postMessage</li>
<li>webView: an object containing methods to interact with the web view</li>
</ul></li>

<p><li>onUnmount (optional): callback function that runs when the web view is closed. This does not fire on navigation or closing the browser tab.</li></p>

</ul>

Return values:

<ul>

<p><li>mount: function to programmatically open the web view</li>
<li>unmount: function to programmatically close the web view</li>
<li>postMessage: function to send a message to the web view</li></p>

</ul>

<h3>Basic example</h3>

```typescript
const App = () => {
  const { mount } = useWebView({
    // URL of your web view content
    url: 'page.html',
<pre><code>// Handle messages from web view
onMessage: (message) =&gt; {
  console.log('Received from web view:', message);
},

// Cleanup when web view closes
onUnmount: () =&gt; {
  console.log('Web view closed');
},

</code></pre>
  });

  return <button onPress={mount}>Launch App</button>;
};
```

Be sure to call `mount` after some user interaction, like a button press, so that it's clear to the user what initiated the fullscreen presentation.

:::note
Web views that are presented in fullscreen without user interaction will not be approved.
:::

<h2>Best practices</h2>

<h3>UI/UX patterns</h3>

<ul>

<p><li>Handle responsive views across mobile and desktop devices</li>
<li>Call mount only after user interaction (e.g. onPress)</li></p>

</ul>

<h3>File organization</h3>

<ul>

<p><li>Keep all web files in the webroot/ directory</li>
<li>Use separate files for HTML, CSS, and JavaScript</li>
<li>Consider using a bundler for larger applications</li></p>

</ul>

<h3>Data Synchronization</h3>

<ul>

<p><li>Cache data in localStorage where appropriate</li>
<li>Wait to send messages to the web view until the web view is fully loaded</li></p>

</ul>

<h2>Known limitations</h2>

<h3>CSS/JS requirements</h3>

<ul>

<p><li>❌ No inline CSS or JavaScript</li>
<li>✅ Use separate .css and .js files</li></p>

</ul>

<h3>Forms</h3>

<ul>

<p><li>❌ No direct form submissions</li>
<li>✅ Use JavaScript to handle form data</li>
<li>✅ Send data via postMessage</li></p>

</ul>

<h2>Communication between Devvit and web view</h2>

Web views let you build custom UIs with HTML/CSS/JS while accessing Devvit's backend services ([Redis](./capabilities/redis.md), [fetch](./capabilities/http-fetch.md), [scheduler](./capabilities/scheduler.md), [triggers](./capabilities/triggers.md)) via message passing between the two contexts.

![Sample web views post](./assets/webviews-devvit-architecture.png)

<h3>From web view to Devvit</h3>

In your web view JavaScript:

```javascript
// app.js
window.parent.postMessage(
  {
    type: 'userAction',
    data: { clicked: true },
  },
  '*'
);
```

In your Devvit app:

```typescript
// main.tsx
const { mount } = useWebView({
  url: 'page.html',
  onMessage: (message, webView) => {
    if (message.type === 'userAction') {
      console.log('User clicked:', message.data.clicked);
    } else if (message.type === 'unmount') {
      webView.unmount();
    }
  },
});
```

<h3>From Devvit to web view</h3>

In your Devvit app:

```typescript
// main.tsx
const { mount } = useWebView({
  url: 'page.html',
  onMessage: (message, webView) => {
    if (message.type === 'userAction') {
      console.log('User clicked:', message.data.clicked);
      webView.postMessage({
        type: 'userActionHandled',
        data: { userActionComplete: true },
      });
    }
  },
});
```

In your web view JavaScript:

```javascript
// app.js
window.addEventListener('message', (event) => {
  if (event.data.type === 'devvit-message') {
    const { message } = event.data;
    console.log('Received from Devvit:', message);
  }
});
```

<h2>Managing state</h2>

<h3>Handling initial state</h3>

Use `postMessage` to inject the initial state from the Devvit app into the web view after it is mounted. To ensure the web view is loaded before sending messages to it, send a message to the Devvit app requesting the initial state.

<h4>From web view to Devvit</h4>

In your web view JavaScript:

```javascript
// app.js
// Inform the Devvit app that the web view is ready to receive messages
addEventListener('load', (event) => {
  window.parent.postMessage({ type: 'webViewReady' }, '*');
});
```

In your Devvit app:

```typescript
// main.tsx
const { mount } = useWebView({
  url: 'page.html',
  onMessage: (message, webView) => {
    if (message.type === 'webViewReady') {
      webView.postMessage({ data: { score: 44 } });
    }
  },
});
```

<h3>Local state</h3>

Persist local state using `localStorage`, which is fast, secure, and available on all platforms.

Web views can use `localStorage` for client-side persistence:

```javascript
// Save data
localStorage.setItem('gameState', JSON.stringify(state));

// Load data
const savedState = localStorage.getItem('gameState');
```

<h3>Server state</h3>

To allow for state to sync across devices, data should be persisted using Redis within the Devvit app. It's recommended to frequently store state using `localStorage`, which is faster and use Redis less frequently.

```typescript
const App = () => {
  // Load data from Redis
  const [counter] = useState(async () => {
    const value = await context.redis.get(`counter_${context.postId}`);
    return Number(value ?? 0);
  });

  const { mount } = useWebView({
    url: 'page.html',
    onMessage: async (message) => {
      if (message.type === 'updateCounter') {
        // Update Redis
        await context.redis.set(`counter_${context.postId}`, message.data.newValue);
      }
    },
  });

  return <button onPress={mount}>Open App</button>;
};
```

<h2>Adding payments</h2>

Adding [payments](payments/payments_add.md) to your app is pretty straightforward, but there are a couple of things to you need to know when also using web views.

For a full working example, see `devvit new --template=payments-web-view`.

<h3>Using events to handle payments</h3>

Your user will interact with a web view, but payments APIs can only be invoked in blocks. To make this work, you need to:

<ul>

<p><li>Use events (from web view to Devvit) to communicate that the user wants to purchase a product.</li>
<li>Use events (from Devvit to the web view) to communicate whether purchase succeeds and what the user purchased.</li>
</ul></p>

<h3>Communicating between web view and payments</h3>

<p>Both your web view and payments integrations need to be declared in the same <code>addCustomPostType</code> block. At that point, the lambdas given to each integration will be able to reference each other:</p>

<p><code>typescript
const payments = usePayments((result: OnPurchaseResult) =&gt; {
  // Tell the web view that a purchase was made.
  // A full example might validate that the purchase was successful &amp; communicate what was purchased.
  webView.postMessage({
    type: 'purchaseMade',
    data: {},
  });
});
const webView = useWebView&lt;WebViewMessage, DevvitMessage&gt;({
  url: 'page.html',
  async onMessage(message) {
    // Trigger a payment, based on user interaction in the web view.
    // A full example might check that the user is eligible to make the purchased indicated -
    // for instance validating they aren't trying to purchase something they've already purchased
    // or are otherwise ineligible to purchase.
    if (message.type === 'purchase') {
      payments.purchase(message.data.sku);
    }
  },
});
</code></p>
<h1>Working with useAsync</h1>

<p>:::note
This feature is experimental, which means the design is not final but it's still available for you to use.
:::</p>

<p><code>useAsync</code> is a hook that allows your app to perform server side calls like <code>redis.get</code> or <code>reddit.getCurrentUser</code> without blocking the render process.</p>

<h2>Blocking versus non-blocking</h2>

<p>The code you write in Javascript can be blocking or non-blocking. To keep applications speedy, non-blocking code is preferred.</p>

<p>Blocking code produces a waterfall of actions. One line must happen after another, so the speed in which a program can render takes a large hit. We want to avoid waterfalls to provide a nice experience for users.</p>

<h3>Without useAsync (blocking) example</h3>

<p>```tsx
const App = () =&gt; {
  // This will block the render until data is fetched
  const [message] = useState(async () =&gt; await redis.get('welcomeMessage'));</p>

<p>return <text>{message}</text>;
};
```</p>

<h3>With useAsync (non-blocking) example</h3>

<p>```tsx
const App = () =&gt; {
  const { data: message, loading, error } = useAsync(async () =&gt; await redis.get('welcomeMessage'));</p>

<p>return (
    <vstack>
      {loading &amp;&amp; <text>Loading...</text>}
      {error &amp;&amp; <text>Error fetching message</text>}
      {message &amp;&amp; <text>{message}</text>}
    </vstack>
  );
};
```</p>

<p>This example displays “Loading…” immediately while fetching the data.</p>

<h2>Understanding useAsync</h2>

<h3>Syntax</h3>

<p><code>ts
const { data, loading, error } = useAsync(asyncFunction, { depends: {JSON object}, finally: () =&gt; { function }  });
</code></p>

<ul>
<li>asyncFunction: an asynchronous function that must return a valid JSON value. Note that setState is not allowed in this function. Use the finally parameter if you need to use setState (see the example below).</li>
<li>depends (optional): a JSON object or array of JSON objects that, when changed, will cause the asyncFunction to re-execute.</li>
<li>finally (optional): a callback function that runs after the async operation completes regardless of success or failure. Ideal for state updates (i.e. calls to setState) and side effects.</li>
</ul>

<h3>Return values</h3>

<ul>
<li>data: the data returned from the initializer.</li>
<li>loading: a boolean that denotes if it is loading or not.</li>
<li>error: an error if the request failed.</li>
</ul>

<p><strong>The initializer for <code>useAsync</code> (the first argument of the function) must return a valid JSON value.</strong> This differs from React due to how Devvit components work across server and client boundaries.</p>

<h3>Example: fetching the time and setting state</h3>

<p><code>ts
useAsync(
  async () =&gt; {
    const response = await fetch(`https://date.api/today?timezone=${timezone}`);
    return response.json();
  },
  {
    depends: [timezone],
    finally: (data, error) =&gt; {
      if (error) {
        console.error('Failed to load date data:', error);
      } else {
        setTodayDate(data['currentDate']);
      }
    },
  }
);
</code></p>

<h3>Example: fetching user data</h3>

<p>```ts
// A normal useAsync function
const {
  data: username,
  loading: usernameLoading,
  error: usernameError,
} = useAsync(async () =&gt; {
  const user = await ctx.reddit.getCurrentUser();</p>

<p>return user?.username ?? null;
});</p>

<p>// A dependent useAsync function
const {
  data: userDetails,
  loading: userDetailsLoading,
  error: userDetailsError,
} = useAsync(
  // This will run every time the value in depends changes
  async () =&gt; {
    if (!username) return null;</p>

<pre><code>const resp = await fetch(`https://some-api/get-user-details/${username}`);
return await resp.json();
</code></pre>

<p>},
  {
    // NOTE: This will be deep equality for objects and arrays!
    depends: username,
  }
);
```</p>

<h3>Example: complete application</h3>

<p>This a simple application that leverages useAsync to fetch data in a non-blocking way and updates the app whenever the page changes.</p>

<p>```ts
import { useAsync, useState } from '@devvit/public-api';</p>

<p>const App = () =&gt; {
  const [count, setCount] = useState(1);</p>

<p>const { data, loading, error } = useAsync(
    async () =&gt; {
      const response = await fetch(<code>https://xkcd.com/${count}/info.0.json</code>);
      if (!response.ok) throw new Error(<code>HTTP error ${response.status}: ${response.statusText}</code>);
      return await response.json();
    },
    { depends: [count] }
  );</p>

<p>return (
    <vstack alignment="center middle" height="100%" gap="small">
      <text size="large">XKCD Titles</text>
      <vstack>
        {loading &amp;&amp; <text>Loading...</text>}
        {error &amp;&amp; (
          <text color="red" wrap={true}&gt;
            {error.message}
          </text>
        )}
        {data &amp;&amp; <text>{data.title}</text>}
      </vstack>
      <text>Comic Number: {count}</text>
      <button onPress={() =&gt; setCount((prev) =&gt; prev + 1)}&gt;Increment</button>
    </vstack>
  );
};</p>

<p>//add your custom post
Devvit.addCustomPostType({
  name: 'AppName',
  description: 'Using useAsync with XKCD API',
  render: App,
});
```</p>

<h2>When to use useAsync and useState</h2>

<p>In most cases, you'll want to use <code>useAsync</code> over <code>useState</code> to keep your app snappy. One downside is that you need to handle <code>loading</code> and <code>error</code> when using <code>useAsync</code> or <code>useState</code>.</p>

<p>One situation where <code>useState</code> could be preferable is if your app only has one request and it must be resolved in order to show any part of the app.</p>

<p>Another time to consider <code>useState</code> is if you need to update the value you fetched and display the new result to the user. <code>useState</code> provides a better API for that, but keep in mind you still need to persist the updates to Redis. We will be working on making synced updates easier in the future.</p>

<p>:::note
There isn't an easy way to update <code>useAsync</code> data based off of an action in the app at the moment. We are working on a better way to allow this in the future.
:::</p>
<h1>Working with useInterval</h1>

<p>Update live interactive posts in real time.</p>

<p>:::note
This feature is experimental. There are known issues with interval timing especially when using server side calls, like calling Redis, within the useInterval function. This would result in intervals longer than what a developer specifies.
:::</p>

<p>The <code>useInterval</code> method lets you build live apps that automatically update in real time. You can use this method to trigger a render of your interactive post to do things like add a countdown timer, update a scoreboard with new play information, or set up a clock.</p>

<p><img src="./assets/custom-posts/custom-posts-useinterval.png" alt="Countdown timer" /></p>

<h2>How it works</h2>

<p>The <code>useInterval</code> method lets you request that your app be re-rendered at a specified interval. Intervals are set in milliseconds, with a 1000ms minimum.</p>

<p>```tsx
import { Devvit, useState, useInterval } from '@devvit/public-api';</p>

<p>const [counter, setCounter] = useState(1000);</p>

<p>const updateInterval = useInterval(() =&gt; {
  setCounter((counter) =&gt; counter - 1);
}, 1000);</p>

<p>updateInterval.start();
```</p>

<h2>Key limitations</h2>

<ul>
<li>You can only use one active, running <code>useInterval</code> per app.</li>
<li>The minimum allowed interval time is 1 second.</li>
<li>The timing is specific to the app. Timing begins when a user engages with the app, and the time interval triggers a refresh. For example:
<ul>
<li>If you build a stopwatch and add 1000 ms each time the interval runs, the actual elapsed time would include the time between interval triggers and would be something like 1020 ms.</li>
<li>If you build a countdown timer, the time interval trigger subtracts the current time at render, so it will match the elapsed time.</li>
</ul></li>
<li>An interval runs while the post is visible on screen. If a user navigates away, it is suspended.</li>
</ul>

<h2>useInterval vs scheduler</h2>

<p>The <code>useInterval</code> method is different from the scheduler, in a few important ways:</p>

<ul>
<li><code>useInterval</code>executes on the client and triggers updates to your app locally (it’s similar to setInterval on the web). It can re-render on the user's device to do things like create animations or refresh the screen.</li>
<li>Scheduler executes on the server and can be used to run background processes.</li>
</ul>

<h2>Example clock app</h2>

<h3><a href="https://developers.reddit.com/play#pen/N4IgdghgtgpiBcIQBoQGcBOBjBICWUADgPYYAuABMACIwBudeZAvhQGYbFQUDkAAgBN6jMgHpCAVwBGAGzxYAtBEJ4eAHTAa2EsFjJ5iYCgHMYZAMISMGGGDIAVAjAAUASioaKFLIbSUwxADuFAC8FGAwwdQQZC6unt6+lAAWxFZooRQAymQYeGDGzgGBAHSmZAASaRhobq4lhBACORDkzgBMyLwADDzxRolgfhRQ+RKxGWE5eQVFQWVmALJjE3UNTS1tnT19CT5DlGgw+wKT2bn5hcULZFnHhqdrjc1krWQdXTy9-V42ZFZGAAGABJgKl0sx4KDRmBxjA0JDQUcTgjARpmBoNLQGEwSk0BJY-FwAArEPz2ACehBcwASkFg8F45hkxCwAGseMgEjYwEIMIz9rEAB6UEIAPg8Ay8+2GAG19LAukcHE4ALqZQUwEUlCRHFqxZxuUIS8qWay2FWwOoJaVJCj6dmZI3iijKxxW50msxmnmWuI-LyDYVkHVHACSdhgGDoEBkzgdbK6AEZuqn6n43m5MVKKH8ARRnDbAwAeOgZx2xvDGMCwOwhHhYC1RkZ4AQCGQwHgUZIwKvJMghNQgFPdACkQ7FRcDFGLwddeAAXjB60KhTJWqYeGLgAqYMxi6Jg5Oc14D2XXuzj9OAxiwMx+hotSRyBQhGwIBIZJRsSINCgQHQUZoAYYAIEmzBAA">Playground link</a></h3>

<h3>Code sample</h3>

<p>```tsx
import { Devvit, useState, useInterval } from '@devvit/public-api';</p>

<p>function getCurrentTime() {
  const now = new Date();
  const hours = String(now.getHours()).padStart(2, '0');
  const minutes = String(now.getMinutes()).padStart(2, '0');
  const seconds = String(now.getSeconds()).padStart(2, '0');
  return <code>${hours}:${minutes}:${seconds}</code>;
}</p>

<p>Devvit.addCustomPostType({
  name: 'Clock',
  render: (context) =&gt; {
    const [time, setTime] = useState(() =&gt; getCurrentTime());
    const tick = () =&gt; setTime(() =&gt; getCurrentTime());
    useInterval(tick, 1000).start();</p>

<pre><code>return (
  &lt;vstack alignment="center middle" height="100%"&gt;
    &lt;text size="xxlarge"&gt;{time}&lt;/text&gt;
  &lt;/vstack&gt;
);
</code></pre>

<p>},
});</p>

<p>export default Devvit;
```</p>
<h1>Working with useState</h1>

<p><code>useState</code> is a hook that gives your component reactive memory. It allows you to preserve information across renders and trigger updates to your app when state is updated.</p>

<h2>Arguments</h2>

<p><code>useState</code> takes an initial state as an argument, and returns an array of two items:</p>

<ul>
<li>a state variable</li>
<li>a setter function to update the state variable</li>
</ul>

<p>The initializer for <code>useState</code> (the first argument of the function) can be a static value or a function. <strong>Regardless of how it is initialized, it must return a valid JSON value.</strong> This differs from React due to how Devvit components work across server and client boundaries.</p>

<p>```ts
// A static value
const [variable, setVariable] = useState('initialState');</p>

<p>// An synchronous function
const [variable, setVariable] = useState(() =&gt; 'initialState');</p>

<p>// An async function
const [count, setCount] = useState(async () =&gt; await redis.get('count'));
```</p>

<p>:::info
If the initializer function is async it will block render under the value is resolved. This is a common performance pitfall so please use it sparingly or group async calls together into one state variable using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all"><code>Promise.all</code></a>.</p>

<p>A non-blocking equivalent for fetching data is <a href="/docs/working_with_useasync.md">useAsync</a>.
:::</p>

<h2>Updating state</h2>

<p>You’ll want to retrieve and update state at various points in your app. There are a few common patterns you’ll see for doing this.</p>

<p>```tsx
import { Devvit, useState } from '@devvit/public-api';</p>

<p>const MyComponent = (_, context) =&gt; {
  // Setting up state
  const [count, setCount] = useState(async () =&gt; {
    return await context.redis.get('count');
  });</p>

<p>return (
    <hstack>
      <text>Count: {count}</text>
      {/* Update set count by using a setter function <em>/}
      <button onPress={() =&gt; setCount((x) =&gt; x + 1)}&gt;Increment</button>
      <button onPress={() =&gt; setCount((x) =&gt; x - 1)}&gt;Decrement</button>
      {/</em> Update set count by setting the value directly */}
      <button onPress={() =&gt; setCount(0)}&gt;Set to 0</button>
    </hstack>
  );
};
```</p>

<h2>Using state hooks</h2>

<p>Leverage <code>useState</code> across components to preserve values and trigger reactive updates across your app.</p>

<p>In this example, state hooks are used to:</p>

<ul>
<li>Navigate between two app "pages"</li>
<li>Add a simple counter that increments a value</li>
</ul>

<p>```tsx
//define types of props to pass to components
interface Props {
  navigate: (page: PageType) =&gt; void;
  setCount: (count: number) =&gt; void;
  count: number;
}</p>

<p>enum PageType {
  HOMEPAGE,
  COUNTPAGE,
}</p>

<p>//useState is available as a global import from public API.
const App: Devvit.CustomPostComponent = ({ useState }: Devvit.Context) =&gt; {
  // set state components
  const [page, navigate] = useState(PageType.HOMEPAGE);
  const [count, setCount] = useState(0);</p>

<p>// pass state into a Props object. This can be passed to components for passing state across components in your app
  const props: Props = {
    navigate,
    setCount,
    count,
  };</p>

<p>// pass props into components
  if (page === PageType.COUNTPAGE) {
    return <CountPage {...props} />;
  } else {
    return <HomePage {...props} />;
  }
};</p>

<p>//'HomePage' is a component that returns this app's default UI
const HomePage: Devvit.BlockComponent<Props> = ({ navigate }) =&gt; {
  //defines how to handle 'onPress' button event on page
  const countPage: Devvit.Blocks.OnPressEventHandler = () =&gt; {
    navigate(PageType.COUNTPAGE);
  };</p>

<p>//UI blocks comprising a page
  return (
    <vstack padding="medium" gap="medium" alignment="top center" cornerRadius="medium">
      <text size="xxlarge" weight="bold" grow>
        {'This app will teach you how to count!'}
      </text>
      <vstack alignment="center bottom">
        <button onPress={countPage} appearance="secondary">
          Start counting!
        </button>
      </vstack>
    </vstack>
  );
};</p>

<p>//'CountPage'component
const CountPage: Devvit.BlockComponent<Props> = ({ navigate, setCount, count }, { redis }) =&gt; {
  const incrementCount: Devvit.Blocks.OnPressEventHandler = () =&gt; {
    setCount((count) =&gt; count + 1);
    // note: to preserve the value of 'count' longerterm
    // you would need to add a separate method here. For example:
    // await redis.set("count", count)
  };</p>

<p>return (
    <vstack padding="medium" gap="medium" alignment="top center" cornerRadius="medium">
      <text size="xxlarge" weight="bold" grow>
        {'Press the button to add +1'}
      </text>
      <text>{count}</text>
      <vstack alignment="center bottom">
        <button onPress={incrementCount} appearance="secondary">
          Count!
        </button>
      </vstack>
    </vstack>
  );
};</p>

<p>//add your custom post
Devvit.addCustomPostType({
  name: 'AppName',
  description: 'Navigate between pages and count!',
  render: App,
});
```</p>

<p>In this example, when a user session ends, state will no longer be available to the app. To save and persist data between sessions you will need to <a href="https://developers.reddit.com/docs/redis">store data server-side via the Redis</a>.</p>

<h2>Redis vs useState</h2>

<p>The <code>redis</code> <a href="https://developers.reddit.com/docs/redis">plugin</a> serves as your app’s long-term, server-side memory, while <code>useState</code> serves as its short-term, client-side memory.</p>

<p><code>useState</code> will keep your custom posts performant and responsive. UI that relies on too many server-side calls will slow down your app.</p>

<p>The <code>redis</code> plugin should be used for storing data that needs to persist across sessions. Make these updates to your app in the background i.e. separate from the UI updates you are making. This way, your app does not need to wait on expensive calls to render new components. You should retrieve <code>redis</code> data once on render.</p>

<p>Use state hooks for single session memory, like changing tabs, selecting a checkbox within the UI, or changing values in the user’s view during their app session.</p>

<h2>User sessions</h2>

<p><code>useState</code> persists through a single user session. If a user scrolls away from the page, navigates away from the page, or disconnects, the session will end and the state is invalidated.</p>

<h2>Differences compared to React</h2>

<p>The Devvit <code>useState</code> hook is inspired by <a href="https://react.dev/reference/react/useState">React</a> with a few key differences.</p>

<ul>
<li><code>useState</code> can only return something that can be serialized to JSON. That is booleans, numbers, strings, arrays, and objects. This is due to how the hook persists across server/client boundaries under the hood.</li>
<li><code>useState</code> can be initialized with an async function. This allows you to get remote information from Redis, Reddit, or by using fetch to place on to state. Please use this sparingly, as using an async initializer blocks render until the promise resolves. This can make your app feel slow.</li>
</ul>
</body></html>
